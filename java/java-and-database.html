<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Java 与数据库 | 小灰灰灰灰的博客</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/theme/favicon.png">
    <link rel="alternate" type="application/rss+xml" href="https://blog.lyh543.cn/rss.xml" title="小灰灰灰灰的博客 RSS Feed">
    <link rel="alternate" type="application/atom+xml" href="https://blog.lyh543.cn/feed.atom" title="小灰灰灰灰的博客 Atom Feed">
    <link rel="alternate" type="application/json" href="https://blog.lyh543.cn/feed.json" title="小灰灰灰灰的博客 JSON Feed">
    <meta name="description" content="

说到 Java 访问数据库的方法，就会涉及到非常多的新词，比如：

JDBC
HikariCP
HSQLDB
DAO
Hibernate
JPA
MyBatis

作为一个刚学 Java 不到一周的萌新，我看到这堆词的时候直接懵掉了，不知道从哪里开始学起，甚至自闭了几个小时。

所以，我准备先简单讲一下这几个词的概念。

JDBC(Java DataBase C ...">
    
    <link rel="preload" href="/assets/css/0.styles.ba65f1a6.css" as="style"><link rel="preload" href="/assets/js/app.1862e26d.js" as="script"><link rel="preload" href="/assets/js/138.82827202.js" as="script"><link rel="preload" href="/assets/js/4.c36cbde9.js" as="script"><link rel="prefetch" href="/assets/js/10.5b76df80.js"><link rel="prefetch" href="/assets/js/100.f253d3ab.js"><link rel="prefetch" href="/assets/js/101.34b0a969.js"><link rel="prefetch" href="/assets/js/102.b2710695.js"><link rel="prefetch" href="/assets/js/103.c93a6f9f.js"><link rel="prefetch" href="/assets/js/104.b87e924f.js"><link rel="prefetch" href="/assets/js/105.bc00ec5a.js"><link rel="prefetch" href="/assets/js/106.b5ff4964.js"><link rel="prefetch" href="/assets/js/107.49c6cbd2.js"><link rel="prefetch" href="/assets/js/108.54168938.js"><link rel="prefetch" href="/assets/js/109.4d3197d1.js"><link rel="prefetch" href="/assets/js/11.d0645d4b.js"><link rel="prefetch" href="/assets/js/110.ee7d3d2e.js"><link rel="prefetch" href="/assets/js/111.4a27bdba.js"><link rel="prefetch" href="/assets/js/112.1b359da8.js"><link rel="prefetch" href="/assets/js/113.9f2ff65f.js"><link rel="prefetch" href="/assets/js/114.ab50f1be.js"><link rel="prefetch" href="/assets/js/115.1393f63d.js"><link rel="prefetch" href="/assets/js/116.da021730.js"><link rel="prefetch" href="/assets/js/117.98911950.js"><link rel="prefetch" href="/assets/js/118.dcb3799b.js"><link rel="prefetch" href="/assets/js/119.4436b13d.js"><link rel="prefetch" href="/assets/js/12.e112a51d.js"><link rel="prefetch" href="/assets/js/120.07470ad0.js"><link rel="prefetch" href="/assets/js/121.2c378806.js"><link rel="prefetch" href="/assets/js/122.eec391e1.js"><link rel="prefetch" href="/assets/js/123.db077df7.js"><link rel="prefetch" href="/assets/js/124.39cf2b66.js"><link rel="prefetch" href="/assets/js/125.e6cc5a9b.js"><link rel="prefetch" href="/assets/js/126.2fd5c372.js"><link rel="prefetch" href="/assets/js/127.b10bc96b.js"><link rel="prefetch" href="/assets/js/128.d1a4b4a6.js"><link rel="prefetch" href="/assets/js/129.9669580d.js"><link rel="prefetch" href="/assets/js/13.a4aa4b07.js"><link rel="prefetch" href="/assets/js/130.371e06a0.js"><link rel="prefetch" href="/assets/js/131.5f7d6fae.js"><link rel="prefetch" href="/assets/js/132.cf0b51b4.js"><link rel="prefetch" href="/assets/js/133.5dbef548.js"><link rel="prefetch" href="/assets/js/134.7b6dc116.js"><link rel="prefetch" href="/assets/js/135.2b850087.js"><link rel="prefetch" href="/assets/js/136.d872d075.js"><link rel="prefetch" href="/assets/js/137.8f57365f.js"><link rel="prefetch" href="/assets/js/139.df5a3661.js"><link rel="prefetch" href="/assets/js/14.d4d5df77.js"><link rel="prefetch" href="/assets/js/140.c6d806fe.js"><link rel="prefetch" href="/assets/js/141.ab8ddc87.js"><link rel="prefetch" href="/assets/js/142.68a9fc90.js"><link rel="prefetch" href="/assets/js/143.673e21f7.js"><link rel="prefetch" href="/assets/js/144.a3bd5c27.js"><link rel="prefetch" href="/assets/js/145.0a456c93.js"><link rel="prefetch" href="/assets/js/146.e211d7aa.js"><link rel="prefetch" href="/assets/js/147.a9a06618.js"><link rel="prefetch" href="/assets/js/148.f846043c.js"><link rel="prefetch" href="/assets/js/149.f7f62a89.js"><link rel="prefetch" href="/assets/js/15.cc89af4d.js"><link rel="prefetch" href="/assets/js/150.59a66d8f.js"><link rel="prefetch" href="/assets/js/151.79b0636c.js"><link rel="prefetch" href="/assets/js/152.a3d9462e.js"><link rel="prefetch" href="/assets/js/153.97cb75ef.js"><link rel="prefetch" href="/assets/js/154.52d744c9.js"><link rel="prefetch" href="/assets/js/155.83f58f31.js"><link rel="prefetch" href="/assets/js/156.62763e91.js"><link rel="prefetch" href="/assets/js/157.25496601.js"><link rel="prefetch" href="/assets/js/158.dea91c06.js"><link rel="prefetch" href="/assets/js/159.89fd27c3.js"><link rel="prefetch" href="/assets/js/16.4b276a96.js"><link rel="prefetch" href="/assets/js/160.547a72cb.js"><link rel="prefetch" href="/assets/js/161.939e30a1.js"><link rel="prefetch" href="/assets/js/162.9c12d883.js"><link rel="prefetch" href="/assets/js/163.bcddf902.js"><link rel="prefetch" href="/assets/js/164.308d59f8.js"><link rel="prefetch" href="/assets/js/165.95a50459.js"><link rel="prefetch" href="/assets/js/166.f6e5c2ed.js"><link rel="prefetch" href="/assets/js/167.4b50a5b9.js"><link rel="prefetch" href="/assets/js/168.2db464d6.js"><link rel="prefetch" href="/assets/js/169.c310ea46.js"><link rel="prefetch" href="/assets/js/17.e0f50539.js"><link rel="prefetch" href="/assets/js/170.55158219.js"><link rel="prefetch" href="/assets/js/171.bcd7d67d.js"><link rel="prefetch" href="/assets/js/172.4331c357.js"><link rel="prefetch" href="/assets/js/173.1c8f5ecc.js"><link rel="prefetch" href="/assets/js/174.907a9ca5.js"><link rel="prefetch" href="/assets/js/175.69a039f0.js"><link rel="prefetch" href="/assets/js/176.4bca9ea2.js"><link rel="prefetch" href="/assets/js/177.6fba39bd.js"><link rel="prefetch" href="/assets/js/178.8b1a54c8.js"><link rel="prefetch" href="/assets/js/179.b8a59690.js"><link rel="prefetch" href="/assets/js/18.a5811a03.js"><link rel="prefetch" href="/assets/js/180.48d42ff0.js"><link rel="prefetch" href="/assets/js/181.5ec4955e.js"><link rel="prefetch" href="/assets/js/182.3b23ba01.js"><link rel="prefetch" href="/assets/js/183.740ee762.js"><link rel="prefetch" href="/assets/js/184.7f7fdd2b.js"><link rel="prefetch" href="/assets/js/185.b23de2bd.js"><link rel="prefetch" href="/assets/js/186.bbf0e947.js"><link rel="prefetch" href="/assets/js/187.613418a5.js"><link rel="prefetch" href="/assets/js/188.42eca6e2.js"><link rel="prefetch" href="/assets/js/189.a120a83c.js"><link rel="prefetch" href="/assets/js/19.df4f6aca.js"><link rel="prefetch" href="/assets/js/190.f3acc555.js"><link rel="prefetch" href="/assets/js/191.09a9cc44.js"><link rel="prefetch" href="/assets/js/192.d5c26fa7.js"><link rel="prefetch" href="/assets/js/193.2879539c.js"><link rel="prefetch" href="/assets/js/194.d793dfc0.js"><link rel="prefetch" href="/assets/js/195.3581a1d4.js"><link rel="prefetch" href="/assets/js/196.d1c2a5f6.js"><link rel="prefetch" href="/assets/js/197.e6aa3702.js"><link rel="prefetch" href="/assets/js/198.a6b4d3e2.js"><link rel="prefetch" href="/assets/js/199.a8234fb7.js"><link rel="prefetch" href="/assets/js/20.13b73a09.js"><link rel="prefetch" href="/assets/js/200.4f30557f.js"><link rel="prefetch" href="/assets/js/201.27224186.js"><link rel="prefetch" href="/assets/js/202.094b4056.js"><link rel="prefetch" href="/assets/js/203.83bc4547.js"><link rel="prefetch" href="/assets/js/204.077ab429.js"><link rel="prefetch" href="/assets/js/205.30111002.js"><link rel="prefetch" href="/assets/js/206.c050f20d.js"><link rel="prefetch" href="/assets/js/207.c3ce98c4.js"><link rel="prefetch" href="/assets/js/208.10abe996.js"><link rel="prefetch" href="/assets/js/209.a40473da.js"><link rel="prefetch" href="/assets/js/21.c0dcf3ee.js"><link rel="prefetch" href="/assets/js/210.26b12b52.js"><link rel="prefetch" href="/assets/js/211.a11622d6.js"><link rel="prefetch" href="/assets/js/212.bb45d775.js"><link rel="prefetch" href="/assets/js/213.7df0ba5c.js"><link rel="prefetch" href="/assets/js/214.0caf36cb.js"><link rel="prefetch" href="/assets/js/215.0099216a.js"><link rel="prefetch" href="/assets/js/216.eb7ee7e8.js"><link rel="prefetch" href="/assets/js/217.c0ff723b.js"><link rel="prefetch" href="/assets/js/218.49da68db.js"><link rel="prefetch" href="/assets/js/219.dae2d44a.js"><link rel="prefetch" href="/assets/js/22.73ba2b1e.js"><link rel="prefetch" href="/assets/js/220.a1a6d1a1.js"><link rel="prefetch" href="/assets/js/221.d1863836.js"><link rel="prefetch" href="/assets/js/222.addd6764.js"><link rel="prefetch" href="/assets/js/223.8af1193a.js"><link rel="prefetch" href="/assets/js/224.34df69f4.js"><link rel="prefetch" href="/assets/js/225.ab331e15.js"><link rel="prefetch" href="/assets/js/226.dae8c878.js"><link rel="prefetch" href="/assets/js/227.b851085c.js"><link rel="prefetch" href="/assets/js/228.0324ad6a.js"><link rel="prefetch" href="/assets/js/229.63d0b11c.js"><link rel="prefetch" href="/assets/js/23.62be8cdb.js"><link rel="prefetch" href="/assets/js/230.6df013aa.js"><link rel="prefetch" href="/assets/js/231.4de9105b.js"><link rel="prefetch" href="/assets/js/232.d795b579.js"><link rel="prefetch" href="/assets/js/233.7b186777.js"><link rel="prefetch" href="/assets/js/234.05a9ed7a.js"><link rel="prefetch" href="/assets/js/235.5540fefa.js"><link rel="prefetch" href="/assets/js/236.f5786cb7.js"><link rel="prefetch" href="/assets/js/237.86fc0464.js"><link rel="prefetch" href="/assets/js/238.8ffa768c.js"><link rel="prefetch" href="/assets/js/239.d83407c1.js"><link rel="prefetch" href="/assets/js/24.c703d2ff.js"><link rel="prefetch" href="/assets/js/240.a318a76c.js"><link rel="prefetch" href="/assets/js/241.3405b519.js"><link rel="prefetch" href="/assets/js/242.affacfc5.js"><link rel="prefetch" href="/assets/js/243.c315d13d.js"><link rel="prefetch" href="/assets/js/244.fbd2b374.js"><link rel="prefetch" href="/assets/js/25.e4b5d9cd.js"><link rel="prefetch" href="/assets/js/26.09f6f933.js"><link rel="prefetch" href="/assets/js/27.3760bee1.js"><link rel="prefetch" href="/assets/js/28.df94124d.js"><link rel="prefetch" href="/assets/js/29.ff459390.js"><link rel="prefetch" href="/assets/js/3.b0f49fb4.js"><link rel="prefetch" href="/assets/js/30.4ab05e0e.js"><link rel="prefetch" href="/assets/js/31.a3c1c2d9.js"><link rel="prefetch" href="/assets/js/32.539d90dc.js"><link rel="prefetch" href="/assets/js/33.ad77dc14.js"><link rel="prefetch" href="/assets/js/34.8c22bea6.js"><link rel="prefetch" href="/assets/js/35.100ca257.js"><link rel="prefetch" href="/assets/js/36.d9f27094.js"><link rel="prefetch" href="/assets/js/37.3f37cd4c.js"><link rel="prefetch" href="/assets/js/38.eb4282ed.js"><link rel="prefetch" href="/assets/js/39.523656b2.js"><link rel="prefetch" href="/assets/js/40.50993bef.js"><link rel="prefetch" href="/assets/js/41.762cf1ff.js"><link rel="prefetch" href="/assets/js/42.43bd336c.js"><link rel="prefetch" href="/assets/js/43.fd543ff1.js"><link rel="prefetch" href="/assets/js/44.80337699.js"><link rel="prefetch" href="/assets/js/45.bff8d08f.js"><link rel="prefetch" href="/assets/js/46.576a5a29.js"><link rel="prefetch" href="/assets/js/47.c21081db.js"><link rel="prefetch" href="/assets/js/48.0caefca2.js"><link rel="prefetch" href="/assets/js/49.bf865d97.js"><link rel="prefetch" href="/assets/js/5.e6e166e1.js"><link rel="prefetch" href="/assets/js/50.e10eb3ba.js"><link rel="prefetch" href="/assets/js/51.39d80954.js"><link rel="prefetch" href="/assets/js/52.b9019938.js"><link rel="prefetch" href="/assets/js/53.4e06c9c8.js"><link rel="prefetch" href="/assets/js/54.c235e49a.js"><link rel="prefetch" href="/assets/js/55.991000be.js"><link rel="prefetch" href="/assets/js/56.50cadecf.js"><link rel="prefetch" href="/assets/js/57.5bed2a47.js"><link rel="prefetch" href="/assets/js/58.da30e00a.js"><link rel="prefetch" href="/assets/js/59.c5e08f26.js"><link rel="prefetch" href="/assets/js/6.ad6534dc.js"><link rel="prefetch" href="/assets/js/60.433f1820.js"><link rel="prefetch" href="/assets/js/61.6d075d0e.js"><link rel="prefetch" href="/assets/js/62.03b0219a.js"><link rel="prefetch" href="/assets/js/63.2633a3c1.js"><link rel="prefetch" href="/assets/js/64.e99468ca.js"><link rel="prefetch" href="/assets/js/65.092aeb48.js"><link rel="prefetch" href="/assets/js/66.72f625cb.js"><link rel="prefetch" href="/assets/js/67.1e99003d.js"><link rel="prefetch" href="/assets/js/68.aa32a97f.js"><link rel="prefetch" href="/assets/js/69.d61a684f.js"><link rel="prefetch" href="/assets/js/7.4cd823a4.js"><link rel="prefetch" href="/assets/js/70.84a4a860.js"><link rel="prefetch" href="/assets/js/71.1cf60181.js"><link rel="prefetch" href="/assets/js/72.f50524b9.js"><link rel="prefetch" href="/assets/js/73.2bce7cb6.js"><link rel="prefetch" href="/assets/js/74.e460a0bb.js"><link rel="prefetch" href="/assets/js/75.0dd3fda6.js"><link rel="prefetch" href="/assets/js/76.2cbfb6ab.js"><link rel="prefetch" href="/assets/js/77.c5759bc7.js"><link rel="prefetch" href="/assets/js/78.22ed93ee.js"><link rel="prefetch" href="/assets/js/79.7dd8116a.js"><link rel="prefetch" href="/assets/js/8.06e5b0e3.js"><link rel="prefetch" href="/assets/js/80.9f1d3631.js"><link rel="prefetch" href="/assets/js/81.e43dcdc5.js"><link rel="prefetch" href="/assets/js/82.d61e7077.js"><link rel="prefetch" href="/assets/js/83.6ea15e57.js"><link rel="prefetch" href="/assets/js/84.ac1a1613.js"><link rel="prefetch" href="/assets/js/85.db0b5853.js"><link rel="prefetch" href="/assets/js/86.19fe0d35.js"><link rel="prefetch" href="/assets/js/87.0de56400.js"><link rel="prefetch" href="/assets/js/88.57b2e4ba.js"><link rel="prefetch" href="/assets/js/89.339850f9.js"><link rel="prefetch" href="/assets/js/9.4fd6de62.js"><link rel="prefetch" href="/assets/js/90.a4a402a4.js"><link rel="prefetch" href="/assets/js/91.da9e7e18.js"><link rel="prefetch" href="/assets/js/92.0b30be51.js"><link rel="prefetch" href="/assets/js/93.7fdcff6e.js"><link rel="prefetch" href="/assets/js/94.1afeae11.js"><link rel="prefetch" href="/assets/js/95.9de51638.js"><link rel="prefetch" href="/assets/js/96.dd2ea4f6.js"><link rel="prefetch" href="/assets/js/97.9e2d8992.js"><link rel="prefetch" href="/assets/js/98.3471026e.js"><link rel="prefetch" href="/assets/js/99.11633d17.js"><link rel="prefetch" href="/assets/js/vuejs-paginate.2e9b600e.js">
    <link rel="stylesheet" href="/assets/css/0.styles.ba65f1a6.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div data-app="true" id="app" class="v-application v-application--is-ltr theme--light"><div class="v-application--wrap"><!----> <main id="main-content" class="v-main" style="padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;"><div class="v-main__wrap"><div><div class="container"><div class="row justify-center"><div class="col-sm-9 col-12"><article itemscope="itemscope" itemtype="https://schema.org/BlogPosting" class="vuepress-blog-theme-content"><div class="v-card v-sheet theme--light"><div class="container"><div itemprop="articleBody" class="markdown-body content__default"><h2 id="专业名词"><a href="#专业名词" class="header-anchor">#</a> 专业名词</h2> <p>说到 Java 访问数据库的方法，就会涉及到非常多的新词，比如：</p> <ul><li>JDBC</li> <li>HikariCP</li> <li>HSQLDB</li> <li>DAO</li> <li>Hibernate</li> <li>JPA</li> <li>MyBatis</li></ul> <p>作为一个刚学 Java 不到一周的萌新，我看到这堆词的时候直接懵掉了，不知道从哪里开始学起，甚至自闭了几个小时。</p> <p>所以，我准备先简单讲一下这几个词的概念。</p> <ul><li>JDBC(Java DataBase Connection)：Java 访问数据库的 API，只提供接口，底层驱动由 MySQL 等提供。绝大部分 Java 访问数据库的包都是基于 JDBC 进行二次开发</li> <li>HikariCP：一个数据库连接池(Connection Pool)，用于和数据库建立高效、可复用的连接</li> <li>HSQLDB：一个 Java 编写的嵌入式数据库，类似于 C/C++ 的 SQLite，可用于测试或小型应用</li> <li>DAO(Data Access Object)：一种编程模式/思想，对于每一个存储在数据库的类（如 <code>User</code>）建立一个类，专门负责访问数据库、对数据库进行 CURD</li> <li>ORM(Object-Relational Mapping)：将对象和关系进行映射的过程。下面三个 <code>Hibernate</code> <code>JPA</code> <code>MyBatis</code> 其实都是在做 ORM</li> <li>JPA(Java Persistence API)：一个 ORM 标准 API，只提供接口，类似于 JDBC。</li> <li>Hibernate：一个 ORM 框架，能够自动将查询语句映射到 SQL，并将查询结果映射为 Java 对象（Python 的 Django 也提供了类似的 ORM 功能）</li> <li>MyBatis：一个 ORM 框架，可以将查询结果映射为 Java 对象，但还是需要手写 SQL</li></ul> <h2 id="jdbc"><a href="#jdbc" class="header-anchor">#</a> JDBC</h2> <p>JDBC：万物之源。</p> <p>JDBC 的全称是 Java 数据库连接 (Java DataBase Connectivity)，它是 Java 为关系数据库定义了一套标准的访问接口。</p> <p>JDBC 是接口，这个接口意味着，虽然不同数据库的访问方法不一样，但是不同应用程序（包括不同框架）访问 JDBC 接口、数据库厂商为 JDBC 实现自己的接口，就可以连接应用程序和数据库了。</p> <p><img src="/images/3d83d577094fb42bc5d24bb9b0b747d893b94a8f390ed0bbb4875f0afa9cb289.png" alt="JDBC"></p> <p>目前几乎所有 Java 程序都是使用 JDBC 访问数据库，包括 JetBrains 的所有 IDE 在链接数据库前，也需要下载对应数据库的 JDBC 驱动。</p> <p>更详细的使用的教程可见<a href="https://www.liaoxuefeng.com/wiki/1252599548343744/1255943820274272" target="_blank" rel="noopener noreferrer">JDBC编程 - 廖雪峰的官方网站<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <h2 id="hikaricp"><a href="#hikaricp" class="header-anchor">#</a> HikariCP</h2> <p>HikariCP 是一个数据库连接池，负责自动管理数据库连接，提高性能。这个没什么好讲的，在高并发下，连接池是标配，Spring Boot 也优先选择 HikariCP 作为连接池。</p> <h2 id="hsqldb"><a href="#hsqldb" class="header-anchor">#</a> HSQLDB</h2> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> users <span class="token operator">=</span> userOrm<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>gender<span class="token operator">=</span><span class="token string">&quot;M&quot;</span><span class="token punctuation">,</span> grade<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token keyword">int</span> userId <span class="token operator">=</span> userOrm<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token keyword">int</span> updateCount <span class="token operator">=</span> userOrm<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token keyword">int</span> deleteCount <span class="token operator">=</span> userOrm<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>HSQLDB 其实和 SQLite 是类似的，都是一个小型的、嵌入式的、可以运行于内存或文件的数据库，不需要单独安装，只需要编译的时候将包导入即可。</p> <p>HSQLDB 和 SQLite 的区别是，HSQLDB 是 Java 写的，而 SQLite 是 C 写的，所以 Java 项目导入 HSQLDB 很方便，而 C++ 项目导入 SQLite 会很方便。</p> <p>HSQLDB 和  SQLite 都常用于开发、测试环境、中小型系统中。</p> <p>需要注意的是，MySQL 默认使用可重复读，而 HSQLDB 2 不支持可重复读，默认是读提交 (<a href="http://www.hsqldb.org/doc/2.0/guide/sessions-chapt.html" target="_blank" rel="noopener noreferrer">reference<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>)。所以 HSQLDB 会出现 A 更新但未提交后、B 事务申请读但是卡死的情况。</p> <h2 id="dao"><a href="#dao" class="header-anchor">#</a> DAO</h2> <p>数据访问对象 (Data Access Object, DAO) 只是一种设计模式，不需要引入新的工具包。</p> <p>如果不使用 DAO 的话，我们会把访问数据库的逻辑写到业务层里，如果业务逻辑变复杂，就很难管理。</p> <p>因此，我们可以把<strong>数据访问层</strong>和<strong>控制层</strong>进行分离。</p> <p>如果我们使用面向对象编写数据访问层，就有了数据访问对象 (Data Access Object, DAO) 了。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserDao</span> <span class="token punctuation">{</span>
    <span class="token class-name">User</span> <span class="token function">getById</span><span class="token punctuation">(</span><span class="token keyword">long</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// access database ...</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> <span class="token function">getUsers</span><span class="token punctuation">(</span><span class="token keyword">int</span> page<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// access database ...</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token class-name">User</span> <span class="token function">createUser</span><span class="token punctuation">(</span><span class="token class-name">User</span> user<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// access database ...</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token class-name">User</span> <span class="token function">updateUser</span><span class="token punctuation">(</span><span class="token class-name">User</span> user<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// access database ...</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">void</span> <span class="token function">deleteUser</span><span class="token punctuation">(</span><span class="token class-name">User</span> user<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// access database ...</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="orm"><a href="#orm" class="header-anchor">#</a> ORM</h2> <p>ORM(Object-Relational Mapping)，对象关系映射，就是将 Java 原生对象和关系数据库的数据建立关系的一种思想。</p> <p><img src="/images/a9f81f9fcc134c176ae369368984f4a9f6a0e85bae400544104b4b0c331616e3.png" alt="ORM"></p> <p>纯 JDBC 是没有 ORM 的，所以需要手动取出 <code>resultSet</code> 中的每个字段，然后处理，非常麻烦。</p> <p>下面是使用 JDBC 查询数据库，JDBC 没有 ORM，需要手动将对象字段<strong>映射</strong>为 SQL 查询条件、将 SQL 查询结果<strong>映射</strong>为对象。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">try</span> <span class="token punctuation">(</span><span class="token class-name">Connection</span> conn <span class="token operator">=</span> <span class="token class-name">DriverManager</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span>JDBC_URL<span class="token punctuation">,</span> JDBC_USER<span class="token punctuation">,</span> JDBC_PASSWORD<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">(</span><span class="token class-name">PreparedStatement</span> ps <span class="token operator">=</span> conn<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span><span class="token string">&quot;SELECT id, grade, name, gender FROM students WHERE gender=? AND grade=?&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        ps<span class="token punctuation">.</span><span class="token function">setObject</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&quot;M&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        ps<span class="token punctuation">.</span><span class="token function">setObject</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">(</span><span class="token class-name">ResultSet</span> rs <span class="token operator">=</span> ps<span class="token punctuation">.</span><span class="token function">executeQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">while</span> <span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">long</span> id <span class="token operator">=</span> rs<span class="token punctuation">.</span><span class="token function">getLong</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">long</span> grade <span class="token operator">=</span> rs<span class="token punctuation">.</span><span class="token function">getLong</span><span class="token punctuation">(</span><span class="token string">&quot;grade&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">String</span> name <span class="token operator">=</span> rs<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">String</span> gender <span class="token operator">=</span> rs<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">&quot;gender&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>如果有 ORM（运用现有的 ORM 框架，或者手写 ORM）自动把 <code>resultSet</code> 映射到 Java 原生类，在开发上都会变得简单很多。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// 理想的 ORM</span>
<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> users <span class="token operator">=</span> userOrm<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>gender<span class="token operator">=</span><span class="token string">&quot;M&quot;</span><span class="token punctuation">,</span> grade<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Java 的常见 ORM 框架有：</p> <ul><li>JPA(Java Persistence API)：一个 ORM 标准 API，只提供接口，类似于 JDBC。</li> <li>Hibernate：一个 ORM 框架，能够自动将查询语句映射到 SQL，并将查询结果映射为 Java 对象</li> <li>MyBatis：一个 ORM 框架，可以将查询结果映射为 Java 对象，但还是需要手写 SQL</li></ul> <p>下面会分别介绍。</p> <h2 id="jpa"><a href="#jpa" class="header-anchor">#</a> JPA</h2> <p>JPA(Java Persistence API Java 持久层 API) 是 JavaEE 的 ORM 标准，大家可以用这个标准提供的接口以 ORM 的形式访问数据库。</p> <p>值得注意的是，JPA 只是提供了接口，底层的实现不是 JPA 做的，可以使用 EclipseLink 或 Hibernate（没错，你不仅可以使用 Hibernate API 调用 Hibernate，也可以使用 JPA 调用）作为实现。</p> <p>简单的操作用 JPA 写会非常简单，比如按 id 查询用户：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token class-name">User</span> <span class="token function">getUserById</span><span class="token punctuation">(</span><span class="token keyword">long</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">User</span> user <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>entityManager<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token class-name">User</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// ...</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>但是复杂的操作看起来就很麻烦了，<code>SELECT * FROM user WHERE email = ?</code> 用 JPA 写：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">User</span> <span class="token function">fetchUserByEmail</span><span class="token punctuation">(</span><span class="token class-name">String</span> email<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> cb <span class="token operator">=</span> em<span class="token punctuation">.</span><span class="token function">getCriteriaBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">CriteriaQuery</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> q <span class="token operator">=</span> cb<span class="token punctuation">.</span><span class="token function">createQuery</span><span class="token punctuation">(</span><span class="token class-name">User</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Root</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> r <span class="token operator">=</span> q<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token class-name">User</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    q<span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span>cb<span class="token punctuation">.</span><span class="token function">equal</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;email&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> cb<span class="token punctuation">.</span><span class="token function">parameter</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token string">&quot;e&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">TypedQuery</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> query <span class="token operator">=</span> em<span class="token punctuation">.</span><span class="token function">createQuery</span><span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token punctuation">;</span>
    query<span class="token punctuation">.</span><span class="token function">setParameter</span><span class="token punctuation">(</span><span class="token string">&quot;e&quot;</span><span class="token punctuation">,</span> email<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> query<span class="token punctuation">.</span><span class="token function">getResultList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> list<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token keyword">null</span> <span class="token operator">:</span> list<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>还不如写 SQL 呢。所以，一般来说不会选择这个 API 作为 ORM 的工具。</p> <h2 id="hibernate"><a href="#hibernate" class="header-anchor">#</a> Hibernate</h2> <p>相较于 JPA，Hibernate API 就友好很多了。</p> <p>上面的 <code>SELECT * FROM user WHERE email = ?</code> 用 Hibernate 可以这么写：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">User</span> <span class="token function">fetchUserByEmail</span><span class="token punctuation">(</span><span class="token class-name">String</span> email<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">User</span> example <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    example<span class="token punctuation">.</span><span class="token function">setEmail</span><span class="token punctuation">(</span>email<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> hibernateTemplate<span class="token punctuation">.</span><span class="token function">findByExample</span><span class="token punctuation">(</span>example<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> list<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token keyword">null</span> <span class="token operator">:</span> list<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>相较 JPA 就简单很多了。</p> <p>顺便一提，如果使用的是 Django 的 ORM，<code>SELECT * FROM user WHERE email = ?</code> 可以这么写：</p> <div class="language-py extra-class"><pre class="language-py"><code><span class="token keyword">def</span> <span class="token function">fetchUserByEmail</span><span class="token punctuation">(</span>email <span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> User<span class="token punctuation">:</span>
    q <span class="token operator">=</span> User<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>email<span class="token operator">=</span>email<span class="token punctuation">)</span>
    <span class="token keyword">return</span> q<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>q<span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token boolean">None</span>
</code></pre></div><p>可以看到，Hibernate 和 JPA 可以将查询条件自动转换为 SQL，同时自动将查询结果返回为 Java 对象，而 Hibernate 的语法较 JPA 简单了很多。</p> <p>但是，Hibernate 为了兼容多种数据库，它使用 HQL 或 JPQL 查询，经过一道转换，变成特定数据库的 SQL，理论上这样可以做到无缝切换数据库，但这一层自动转换除了少许的性能开销外，给 SQL 级别的优化带来了麻烦。</p> <p>此外，如果有大量表连接操作，不直接用 SQL 写的话，语法上也会非常麻烦。</p> <p>所以，产生了另一种框架，需要手写 SQL，但是能够将结果自动转换为 Java 对象，MyBatis 就是这么一个 ORM 框架。</p> <h2 id="mybatis"><a href="#mybatis" class="header-anchor">#</a> MyBatis</h2> <p>MyBatis 虽然需要手写 SQL，但是他的语法也相当简洁：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">UserMapper</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Select</span><span class="token punctuation">(</span><span class="token string">&quot;SELECT * FROM user WHERE email = #{email}&quot;</span><span class="token punctuation">)</span>
	<span class="token class-name">User</span> <span class="token function">getByEmail</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Param</span><span class="token punctuation">(</span><span class="token string">&quot;email&quot;</span><span class="token punctuation">)</span> <span class="token class-name">String</span> email<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>写好这个接口以后，MyBatis 甚至可以帮我们创建实现类，我们直接调用就行了：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">User</span> user <span class="token operator">=</span> userMapper<span class="token punctuation">.</span><span class="token function">getByEmail</span><span class="token punctuation">(</span>email<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>可见，MyBatis 的优势有：</p> <ol><li>（相较于 JDBC）自动将 ResultSet 转化为 Java 对象</li> <li>（相较于 Hibernate 和 JPA）执行原生 SQL，不会有效率影响</li> <li>（相较于 JDBC）自动生成查询函数，语法简洁</li></ol> <h3 id="mybatis-的三种风格"><a href="#mybatis-的三种风格" class="header-anchor">#</a> Mybatis 的三种风格</h3> <p>Mybatis 也有三种风格：</p> <ol><li>注解风格，将 SQL 写在接口方法的注解里；</li> <li>XML 风格，将 SQL 语句单独放到一个 XML 文件里；</li> <li>MyBatis-Plus 插件，类似 Hibernate API，提供通用的 API，能方便地对单表增删查改。</li></ol> <p>这三种方案使用哪一种，就见仁见智了。如果使用注解风格，在看方法名的时候顺便就能看到实际的 SQL；使用 XML 风格实现了 SQL 层和 Java 代码的分离；MyBatis Plus 则是类似 Hibernate，可能会有效率问题。</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token comment">&lt;!--  使用 XML 配置的 MyBatis Mapper  --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mapper</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>getByEmail<span class="token punctuation">&quot;</span></span> <span class="token attr-name">resultType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>User<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    SELECT * FROM user WHERE email = #{email}
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mapper</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// 使用注解配置的 MyBatis Mapper</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">UserMapper</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Select</span><span class="token punctuation">(</span><span class="token string">&quot;SELECT * FROM user WHERE email = #{email}&quot;</span><span class="token punctuation">)</span>
    <span class="token class-name">User</span> <span class="token function">getByEmail</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Param</span><span class="token punctuation">(</span><span class="token string">&quot;email&quot;</span><span class="token punctuation">)</span> <span class="token class-name">String</span> email<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token class-name">User</span> user <span class="token operator">=</span> userMapper<span class="token punctuation">.</span><span class="token function">getByEmail</span><span class="token punctuation">(</span>email<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// 使用 MyBatis Plus 配置的 MyBatis Mapper</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">UserMapper</span> <span class="token keyword">extends</span> <span class="token class-name">BaseMapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token class-name">QueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> queryWrapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">QueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
queryWrapper<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token string">&quot;email&quot;</span><span class="token punctuation">,</span> email<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">User</span> user <span class="token operator">=</span> userMapper<span class="token punctuation">.</span><span class="token function">selectOne</span><span class="token punctuation">(</span>queryWrapper<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="mybatis-generator-自动生成-xml"><a href="#mybatis-generator-自动生成-xml" class="header-anchor">#</a> MyBatis Generator 自动生成 XML</h3> <p>没错，MyBatis 官方也提供了生成器，能根据数据库表，自动生成实体类 (User) 和映射类 (UserMapper)！</p> <blockquote><p>英文官网：http://mybatis.org/generator/index.html<br>
参考：https://juejin.cn/post/6844903982582743048</p></blockquote> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token comment">&lt;!-- pom.xml --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugins</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.mybatis.generator<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>mybatis-generator-maven-plugin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.4.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">&gt;</span></span>
            <span class="token comment">&lt;!--mybatis的代码生成器的配置文件--&gt;</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configurationFile</span><span class="token punctuation">&gt;</span></span>src/main/resources/mybatis-generator-config.xml<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configurationFile</span><span class="token punctuation">&gt;</span></span>
            <span class="token comment">&lt;!--允许覆盖生成的文件--&gt;</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>overwrite</span><span class="token punctuation">&gt;</span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>overwrite</span><span class="token punctuation">&gt;</span></span>
            <span class="token comment">&lt;!--将当前pom的依赖项添加到生成器的类路径中--&gt;</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>includeCompileDependencies</span><span class="token punctuation">&gt;</span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>includeCompileDependencies</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>mysql<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>mysql-connector-java<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>8.0.25<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugins</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="language-xml extra-class"><pre class="language-xml"><code><span class="token comment">&lt;!-- src/main/resources/mybatis-generator-config.xml --&gt;</span>
<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">generatorConfiguration</span> <span class="token name">PUBLIC</span>
        <span class="token string">&quot;-//mybatis.org//DTD MyBatis Generator Configuration 1.0//EN&quot;</span>
        <span class="token string">&quot;http://mybatis.org/dtd/mybatis-generator-config_1_0.dtd&quot;</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>generatorConfiguration</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span> <span class="token attr-name">resource</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>application.properties<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>context</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>dsql<span class="token punctuation">&quot;</span></span> <span class="token attr-name">targetRuntime</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>MyBatis3DynamicSql<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>commentGenerator</span><span class="token punctuation">&gt;</span></span>
            <span class="token comment">&lt;!-- 忽略注释 --&gt;</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>suppressAllComments<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>commentGenerator</span><span class="token punctuation">&gt;</span></span>

        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>jdbcConnection</span>
                <span class="token attr-name">driverClass</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>${spring.datasource.driver-class-name}<span class="token punctuation">&quot;</span></span>
                        <span class="token attr-name">connectionURL</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>${spring.datasource.url}<span class="token punctuation">&quot;</span></span>
                        <span class="token attr-name">userId</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>${spring.datasource.username}<span class="token punctuation">&quot;</span></span>
                        <span class="token attr-name">password</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>${spring.datasource.password}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token comment">&lt;!--高版本的 mysql-connector-java 需要设置 nullCatalogMeansCurrent=true--&gt;</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>nullCatalogMeansCurrent<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>jdbcConnection</span><span class="token punctuation">&gt;</span></span>

        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>javaModelGenerator</span> <span class="token attr-name">targetPackage</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com.lyh543.springbootdemo.entity<span class="token punctuation">&quot;</span></span>
                            <span class="token attr-name">targetProject</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>src/main/java<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>

        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>javaClientGenerator</span> <span class="token attr-name">targetPackage</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com.lyh543.springbootdemo.mapper<span class="token punctuation">&quot;</span></span>
                             <span class="token attr-name">targetProject</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>src/main/java<span class="token punctuation">&quot;</span></span>
                             <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ANNOTATEDMAPPER<span class="token punctuation">&quot;</span></span>
        <span class="token punctuation">/&gt;</span></span>

        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span> <span class="token attr-name">tableName</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>users<span class="token punctuation">&quot;</span></span> <span class="token attr-name">domainObjectName</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>User<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>context</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>generatorConfiguration</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>目前 <code>mybatis-generator-config.xml</code> 只支持从 <code>properties</code> 读取数据，因此还要把 <code>application.yaml</code> 改回 <code>application.properties</code>（很多在线工具）：</p> <div class="language-ini extra-class"><pre class="language-ini"><code><span class="token key attr-name">server.port</span><span class="token punctuation">=</span><span class="token value attr-value">8080</span>
<span class="token key attr-name">spring.datasource.url</span><span class="token punctuation">=</span><span class="token value attr-value">jdbc:mysql://127.0.0.1:3306/springtest?useUnicode=true&amp;characterEncoding=utf8&amp;autoReconnect=true&amp;useSSL=false&amp;serverTimezone=Asia/Shanghai</span>
<span class="token key attr-name">spring.datasource.username</span><span class="token punctuation">=</span><span class="token value attr-value">root</span>
<span class="token key attr-name">spring.datasource.password</span><span class="token punctuation">=</span><span class="token value attr-value">123456</span>
<span class="token key attr-name">spring.datasource.driver-class-name</span><span class="token punctuation">=</span><span class="token value attr-value">com.mysql.cj.jdbc.Driver</span>
</code></pre></div><p>然后在 Idea 侧边栏运行 <code>Maven</code> - <code>Plugins</code> - <code>mybatis-generator:generate</code> 即可。</p></div> <hr role="separator" aria-orientation="horizontal" class="ma-4 v-divider theme--light"> <!----></div></div></article></div> <!----></div></div> <div role="dialog" class="v-dialog__container"><button type="button" role="button" aria-haspopup="true" aria-expanded="false" class="v-btn v-btn--bottom v-btn--is-elevated v-btn--fab v-btn--fixed v-btn--has-bg v-btn--right v-btn--round theme--dark v-size--default primary"><span class="v-btn__content"><i aria-hidden="true" class="v-icon notranslate mdi mdi-information-variant theme--dark"></i></span></button><!----></div></div></div></main> <footer id="footer" class="v-footer v-sheet theme--light v-footer--absolute v-footer--padless v-footer--inset" style="left:0px;right:0px;bottom:0px;"><div class="lighten-1 text-center v-card v-sheet theme--light rounded-0" style="width:100%;"><div class="v-card__text"><a href="https://github.com/lyh543/vuepress-theme-blog-material/" target="_blank" class="mx-4 v-btn v-btn--icon v-btn--round theme--light v-size--default"><span class="v-btn__content"><i aria-hidden="true" class="v-icon notranslate mdi mdi-github theme--light" style="font-size:24px;"></i></span></a><a href="https://blog.lyh543.cn/" target="_blank" class="mx-4 v-btn v-btn--icon v-btn--round theme--light v-size--default"><span class="v-btn__content"><i aria-hidden="true" class="v-icon notranslate mdi mdi-web theme--light" style="font-size:24px;"></i></span></a><a href="mailto:lyh543@outlook.com" target="_blank" class="mx-4 v-btn v-btn--icon v-btn--round theme--light v-size--default"><span class="v-btn__content"><i aria-hidden="true" class="v-icon notranslate mdi mdi-email theme--light" style="font-size:24px;"></i></span></a><a href="https://weibo.com/" target="_blank" class="mx-4 v-btn v-btn--icon v-btn--round theme--light v-size--default"><span class="v-btn__content"><i aria-hidden="true" class="v-icon notranslate mdi mdi-sina-weibo theme--light" style="font-size:24px;"></i></span></a><a href="https://weixin.qq.com/" target="_blank" class="mx-4 v-btn v-btn--icon v-btn--round theme--light v-size--default"><span class="v-btn__content"><i aria-hidden="true" class="v-icon notranslate mdi mdi-wechat theme--light" style="font-size:24px;"></i></span></a><a href="https://qq.com/" target="_blank" class="mx-4 v-btn v-btn--icon v-btn--round theme--light v-size--default"><span class="v-btn__content"><i aria-hidden="true" class="v-icon notranslate mdi mdi-qqchat theme--light" style="font-size:24px;"></i></span></a><a href="https://bilibili.com/" target="_blank" class="mx-4 v-btn v-btn--icon v-btn--round theme--light v-size--default"><span class="v-btn__content"><div class="v-image v-responsive theme--light" style="max-width:24px;"><div class="v-image__image v-image__image--preload v-image__image--cover" style="background-image:;background-position:center center;"></div><div class="v-responsive__content"></div></div></span></a></div> <hr role="separator" aria-orientation="horizontal" class="v-divider theme--light"> <div class="v-card__text"><span class="footer-text">lyh543 © 2019 - 2021</span>
        |
      <a href="https://beian.miit.gov.cn/" target="_blank" class="footer-link">蜀ICP备19034464号</a>
        |
      <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" class="footer-link">署名 - 非商业性 - 相同方式共享 4.0 国际协议</a>
        |
       <span class="footer-text">
        Theme
        <a href="https://github.com/lyh543/vuepress-theme-blog-material/" target="_blank" class="footer-link">
          vuepress-theme-blog-material
        </a></span></div></div></footer></div></div><div class="global-ui"><div id="pwa-snackbar" class="v-snack v-snack--bottom v-snack--has-background v-snack--right v-snack--vertical" style="padding-bottom:0px;padding-top:0px;" data-v-fec8b358><div class="v-snack__wrapper v-sheet theme--dark" style="display:none;"><div role="status" aria-live="polite" class="v-snack__content">
    博客已更新！
    </div><div class="v-snack__action "><button type="button" id="pwa-button" class="v-btn v-btn--has-bg theme--dark v-size--default v-snack__btn"><span class="v-btn__content">
        刷新
      </span></button></div></div></div></div></div>
    <script src="/assets/js/app.1862e26d.js" defer></script><script src="/assets/js/138.82827202.js" defer></script><script src="/assets/js/4.c36cbde9.js" defer></script>
  </body>
</html>
