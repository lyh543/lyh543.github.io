(window.webpackJsonp=window.webpackJsonp||[]).push([[178],{580:function(n,s,e){"use strict";e.r(s);var t=e(3),a=Object(t.a)({},(function(){var n=this,s=n.$createElement,e=n._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[e("h2",{attrs:{id:"出问题了"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#出问题了"}},[n._v("#")]),n._v(" 出问题了")]),n._v(" "),e("p",[n._v("日常在 Manjaro 和 Windows 双系统穿梭的我，某天进 Windows 前，突然发现 D 盘“未格式化”。这次 Windows 开机的时候还显示 "),e("code",[n._v("□□□□□□□□ (D: ): 100%")]),n._v("。大概率是 Windows 磁盘检查的锅。")]),n._v(" "),e("p",[n._v("在 Windows 下使用傲梅分区助手看了一下，发现我的 D 盘变成 ext4 了。嗯？他重启前不还是 NTFS 的吗？因此，我猜测是 Windows（或者 Linux）把这个分区的类型搞错了，实际数据还是按 NTFS 数据存的。")]),n._v(" "),e("p",[n._v("考虑到 Windows 下一碰 ext4 就提示你“是否格式化”，我还是进 Manjaro 搞吧。")]),n._v(" "),e("h2",{attrs:{id:"进-linux-看看"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#进-linux-看看"}},[n._v("#")]),n._v(" 进 Linux 看看")]),n._v(" "),e("p",[n._v("Manjaro 开机后，显示 "),e("code",[n._v("/dev/nvme0n1p6")]),n._v("（也就是上面所说的 D 盘）无法挂载，原因是：")]),n._v(" "),e("p",[e("strong",[n._v("Structure needs cleaning")])]),n._v(" "),e("p",[n._v("稍微搜了一下（"),e("a",{attrs:{href:"https://blog.51cto.com/u_13210651/2352686",target:"_blank",rel:"noopener noreferrer"}},[n._v("挂载磁盘报错“Structure needs cleaning”_Wdddddddddd_51CTO博客"),e("OutboundLink")],1),n._v("，"),e("a",{attrs:{href:"https://unix.stackexchange.com/questions/330742/cannot-remove-file-structure-needs-cleaning",target:"_blank",rel:"noopener noreferrer"}},[n._v('ubuntu - Cannot remove file: "Structure needs cleaning" - Unix & Linux Stack Exchange'),e("OutboundLink")],1),n._v("），看看自己的是什么情况。")]),n._v(" "),e("p",[n._v("先看看现在的分区是什么样的吧。")]),n._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[n._v("$ "),e("span",{pre:!0,attrs:{class:"token function"}},[n._v("sudo")]),n._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[n._v("fdisk")]),n._v(" -l\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("[")]),n._v("sudo"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("]")]),n._v(" liu 的密码：\nDisk /dev/nvme1n1：476.94 GiB，512110190592 字节，1000215216 个扇区\n磁盘型号：INTEL SSDPEKKW512G8                     \n单元：扇区 / "),e("span",{pre:!0,attrs:{class:"token number"}},[n._v("1")]),n._v(" * "),e("span",{pre:!0,attrs:{class:"token number"}},[n._v("512")]),n._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[n._v("=")]),n._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[n._v("512")]),n._v(" 字节\n扇区大小"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),n._v("逻辑/物理"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),n._v("：512 字节 / "),e("span",{pre:!0,attrs:{class:"token number"}},[n._v("512")]),n._v(" 字节\nI/O 大小"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),n._v("最小/最佳"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),n._v("：512 字节 / "),e("span",{pre:!0,attrs:{class:"token number"}},[n._v("512")]),n._v(" 字节\n磁盘标签类型：gpt\n磁盘标识符：7573E7D7-A331-4409-A786-43099F7F0453\n\n设备                起点       末尾      扇区   大小 类型\n/dev/nvme1n1p1      "),e("span",{pre:!0,attrs:{class:"token number"}},[n._v("2048")]),n._v("    "),e("span",{pre:!0,attrs:{class:"token number"}},[n._v("1126398")]),n._v("   "),e("span",{pre:!0,attrs:{class:"token number"}},[n._v("1124351")]),n._v("   549M EFI 系统\n/dev/nvme1n1p2   "),e("span",{pre:!0,attrs:{class:"token number"}},[n._v("1126400")]),n._v("  "),e("span",{pre:!0,attrs:{class:"token number"}},[n._v("998855191")]),n._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[n._v("997728792")]),n._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[n._v("475")]),n._v(".8G Microsoft 基本数据\n/dev/nvme1n1p3 "),e("span",{pre:!0,attrs:{class:"token number"}},[n._v("998857440")]),n._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[n._v("1000211119")]),n._v("   "),e("span",{pre:!0,attrs:{class:"token number"}},[n._v("1353680")]),n._v("   661M Windows 恢复环境\n\n\nDisk /dev/nvme0n1：931.51 GiB，1000204886016 字节，1953525168 个扇区\n磁盘型号：Samsung SSD "),e("span",{pre:!0,attrs:{class:"token number"}},[n._v("980")]),n._v(" PRO 1TB                 \n单元：扇区 / "),e("span",{pre:!0,attrs:{class:"token number"}},[n._v("1")]),n._v(" * "),e("span",{pre:!0,attrs:{class:"token number"}},[n._v("512")]),n._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[n._v("=")]),n._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[n._v("512")]),n._v(" 字节\n扇区大小"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),n._v("逻辑/物理"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),n._v("：512 字节 / "),e("span",{pre:!0,attrs:{class:"token number"}},[n._v("512")]),n._v(" 字节\nI/O 大小"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),n._v("最小/最佳"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),n._v("：512 字节 / "),e("span",{pre:!0,attrs:{class:"token number"}},[n._v("512")]),n._v(" 字节\n磁盘标签类型：gpt\n磁盘标识符：EF342227-7AEA-4279-9C6D-89D1023BA48A\n\n设备                 起点       末尾       扇区  大小 类型\n/dev/nvme0n1p1         "),e("span",{pre:!0,attrs:{class:"token number"}},[n._v("34")]),n._v("      "),e("span",{pre:!0,attrs:{class:"token number"}},[n._v("32767")]),n._v("      "),e("span",{pre:!0,attrs:{class:"token number"}},[n._v("32734")]),n._v("   16M BIOS 启动\n/dev/nvme0n1p2      "),e("span",{pre:!0,attrs:{class:"token number"}},[n._v("32768")]),n._v("    "),e("span",{pre:!0,attrs:{class:"token number"}},[n._v("1081343")]),n._v("    "),e("span",{pre:!0,attrs:{class:"token number"}},[n._v("1048576")]),n._v("  512M Linux 文件系统\n/dev/nvme0n1p3    "),e("span",{pre:!0,attrs:{class:"token number"}},[n._v("1081344")]),n._v("  "),e("span",{pre:!0,attrs:{class:"token number"}},[n._v("420511743")]),n._v("  "),e("span",{pre:!0,attrs:{class:"token number"}},[n._v("419430400")]),n._v("  200G Linux 文件系统\n/dev/nvme0n1p4  "),e("span",{pre:!0,attrs:{class:"token number"}},[n._v("420511744")]),n._v("  "),e("span",{pre:!0,attrs:{class:"token number"}},[n._v("839942143")]),n._v("  "),e("span",{pre:!0,attrs:{class:"token number"}},[n._v("419430400")]),n._v("  200G Linux 文件系统\n/dev/nvme0n1p5  "),e("span",{pre:!0,attrs:{class:"token number"}},[n._v("839942144")]),n._v("  "),e("span",{pre:!0,attrs:{class:"token number"}},[n._v("881885183")]),n._v("   "),e("span",{pre:!0,attrs:{class:"token number"}},[n._v("41943040")]),n._v("   20G Linux swap\n/dev/nvme0n1p6  "),e("span",{pre:!0,attrs:{class:"token number"}},[n._v("881885184")]),n._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[n._v("1953517567")]),n._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[n._v("1071632384")]),n._v("  511G Microsoft 基本数据\n/dev/nvme0n1p7 "),e("span",{pre:!0,attrs:{class:"token number"}},[n._v("1953520064")]),n._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[n._v("1953525134")]),n._v("       "),e("span",{pre:!0,attrs:{class:"token number"}},[n._v("5071")]),n._v("  "),e("span",{pre:!0,attrs:{class:"token number"}},[n._v("2")]),n._v(".5M Microsoft 保留\n")])])]),e("p",[e("code",[n._v("fdisk -l")]),n._v(" 看不出来具体类型，换 "),e("code",[n._v("parted -l")]),n._v("。")]),n._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("sudo parted -l\n型号：Samsung SSD 980 PRO 1TB (nvme)\n磁盘 /dev/nvme0n1：1000GB\n扇区大小 (逻辑/物理)：512B/512B\n分区表：gpt\n磁盘标志：\n\n编号  起始点  结束点  大小    文件系统        名称                          标志\n 1    17.4kB  16.8MB  16.8MB                                                bios_grub\n 2    16.8MB  554MB   537MB   ext4\n 3    554MB   215GB   215GB   ext4\n 4    215GB   430GB   215GB   ext4\n 5    430GB   452GB   21.5GB  linux-swap(v1)                                交换\n 6    452GB   1000GB  549GB   ext4            Basic data partition          msftdata\n 7    1000GB  1000GB  2596kB                  Microsoft reserved partition  msftres\n\n\n型号：INTEL SSDPEKKW512G8 (nvme)\n磁盘 /dev/nvme1n1：512GB\n扇区大小 (逻辑/物理)：512B/512B\n分区表：gpt\n磁盘标志：\n\n编号  起始点  结束点  大小   文件系统  名称  标志\n 1    1049kB  577MB   576MB  fat32           启动, EFI 启动\n 2    577MB   511GB   511GB  ntfs            msftdata\n 3    511GB   512GB   693MB  ntfs            诊断\n")])])]),e("p",[n._v("可以看到，"),e("code",[n._v("/dev/nvme0n1p6")]),n._v(" 虽然是 "),e("code",[n._v("msftdata")]),n._v("，但文件系统居然是 "),e("code",[n._v("ext4")]),n._v("。")]),n._v(" "),e("h2",{attrs:{id:"尝试-fsck-修复"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#尝试-fsck-修复"}},[n._v("#")]),n._v(" 尝试 fsck 修复")]),n._v(" "),e("p",[n._v("上面两个链接都提到使用 "),e("code",[n._v("fsck")]),n._v(" 修复，于是我们跑一下。")]),n._v(" "),e("p",[n._v("到这里我还不确定原本的分区确定肯定以及一定是 NTFS，于是我跑了一下修复 "),e("code",[n._v("ext4")]),n._v(" 的命令行：")]),n._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[n._v("$ "),e("span",{pre:!0,attrs:{class:"token function"}},[n._v("sudo")]),n._v(" fsck.ext4 /dev/nvme0n1p6\ne2fsck "),e("span",{pre:!0,attrs:{class:"token number"}},[n._v("1.46")]),n._v(".4 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[n._v("18")]),n._v("-Aug-2021"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),n._v("\next2fs_check_desc: 组描述符损坏：块位图中有坏块\nfsck.ext4：组描述符似乎是错误的"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("..")]),n._v(". 尝试备份块\nfsck.ext4：尝试备份块时 超级块中的幻数有错fsck.ext4：回到原先的超级块\n超级块含有一个无效的日志（inode "),e("span",{pre:!0,attrs:{class:"token number"}},[n._v("8")]),n._v("）。\n清除"),e("span",{pre:!0,attrs:{class:"token operator"}},[n._v("<")]),n._v("y"),e("span",{pre:!0,attrs:{class:"token operator"}},[n._v(">")]),n._v("? 是\n*** journal has been deleted ***\n\n注意：如果有数个inode、块位图或inode表\n需要重定位，你可以用“-b "),e("span",{pre:!0,attrs:{class:"token number"}},[n._v("32768")]),n._v("”选项运行\ne2fsck。如果问题出在组描述符的主块，\n那么可以尝试它们的备份块。\n\n组 "),e("span",{pre:!0,attrs:{class:"token number"}},[n._v("0")]),n._v(" 的块位图并不在 组 中。（块 "),e("span",{pre:!0,attrs:{class:"token number"}},[n._v("7449066062970102630")]),n._v("）\n重定位"),e("span",{pre:!0,attrs:{class:"token operator"}},[n._v("<")]),n._v("y"),e("span",{pre:!0,attrs:{class:"token operator"}},[n._v(">")]),n._v("? 是\n组 "),e("span",{pre:!0,attrs:{class:"token number"}},[n._v("0")]),n._v(" 的inode位图 并不在 组 中。（块 "),e("span",{pre:!0,attrs:{class:"token number"}},[n._v("2387591211039621")]),n._v("）\n重定位"),e("span",{pre:!0,attrs:{class:"token operator"}},[n._v("<")]),n._v("y"),e("span",{pre:!0,attrs:{class:"token operator"}},[n._v(">")]),n._v("? 是\n组 "),e("span",{pre:!0,attrs:{class:"token number"}},[n._v("0")]),n._v(" 的inode表并不在 组 中。（块 "),e("span",{pre:!0,attrs:{class:"token number"}},[n._v("3524000321174401")]),n._v("）\n警告：这可能导致严重的数据丢失。\n重定位"),e("span",{pre:!0,attrs:{class:"token operator"}},[n._v("<")]),n._v("y"),e("span",{pre:!0,attrs:{class:"token operator"}},[n._v(">")]),n._v("? 是\n一个或多个块组描述符的校验值无效。  处理"),e("span",{pre:!0,attrs:{class:"token operator"}},[n._v("<")]),n._v("y"),e("span",{pre:!0,attrs:{class:"token operator"}},[n._v(">")]),n._v("? 是\n组描述符 "),e("span",{pre:!0,attrs:{class:"token number"}},[n._v("0")]),n._v(" 的校验值为0x0607，应当为 0x6e89。  已处理.\n组 "),e("span",{pre:!0,attrs:{class:"token number"}},[n._v("1")]),n._v(" 的块位图并不在 组 中。（块 "),e("span",{pre:!0,attrs:{class:"token number"}},[n._v("14493541264792102986")]),n._v("）\n重定位"),e("span",{pre:!0,attrs:{class:"token operator"}},[n._v("<")]),n._v("y"),e("span",{pre:!0,attrs:{class:"token operator"}},[n._v(">")]),n._v("? 是\n组 "),e("span",{pre:!0,attrs:{class:"token number"}},[n._v("1")]),n._v(" 的inode位图 并不在 组 中。（块 "),e("span",{pre:!0,attrs:{class:"token number"}},[n._v("14218948929126649")]),n._v("）\n重定位"),e("span",{pre:!0,attrs:{class:"token operator"}},[n._v("<")]),n._v("y"),e("span",{pre:!0,attrs:{class:"token operator"}},[n._v(">")]),n._v("? 是\n组 "),e("span",{pre:!0,attrs:{class:"token number"}},[n._v("1")]),n._v(" 的inode表并不在 组 中。（块 "),e("span",{pre:!0,attrs:{class:"token number"}},[n._v("9223576984314121984")]),n._v("）\n警告：这可能导致严重的数据丢失。\n重定位"),e("span",{pre:!0,attrs:{class:"token operator"}},[n._v("<")]),n._v("y"),e("span",{pre:!0,attrs:{class:"token operator"}},[n._v(">")]),n._v("? 是\n组描述符 "),e("span",{pre:!0,attrs:{class:"token number"}},[n._v("1")]),n._v(" 的校验值为0xf5e8，应当为 0xc820。  已处理.\n组 "),e("span",{pre:!0,attrs:{class:"token number"}},[n._v("2")]),n._v(" 的块位图并不在 组 中。（块 "),e("span",{pre:!0,attrs:{class:"token number"}},[n._v("5783559511694953099")]),n._v("）\n重定位"),e("span",{pre:!0,attrs:{class:"token operator"}},[n._v("<")]),n._v("y"),e("span",{pre:!0,attrs:{class:"token operator"}},[n._v(">")]),n._v("? 是\n组 "),e("span",{pre:!0,attrs:{class:"token number"}},[n._v("2")]),n._v(" 的inode位图 并不在 组 中。（块 "),e("span",{pre:!0,attrs:{class:"token number"}},[n._v("53874154171787517")]),n._v("）\n重定位（“a” 表示全部回答“yes”） "),e("span",{pre:!0,attrs:{class:"token operator"}},[n._v("<")]),n._v("y"),e("span",{pre:!0,attrs:{class:"token operator"}},[n._v(">")]),n._v("? 是\n组 "),e("span",{pre:!0,attrs:{class:"token number"}},[n._v("2")]),n._v(" 的inode表并不在 组 中。（块 "),e("span",{pre:!0,attrs:{class:"token number"}},[n._v("7349874730908146278")]),n._v("）\n警告：这可能导致严重的数据丢失。\n重定位（“a” 表示全部回答“yes”） "),e("span",{pre:!0,attrs:{class:"token operator"}},[n._v("<")]),n._v("y"),e("span",{pre:!0,attrs:{class:"token operator"}},[n._v(">")]),n._v("? 是\n组描述符 "),e("span",{pre:!0,attrs:{class:"token number"}},[n._v("2")]),n._v(" 的校验值为0x6607，应当为 0xbddf。  已处理.\n\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("..")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("..")]),n._v(".\n\n\n组描述符 "),e("span",{pre:!0,attrs:{class:"token number"}},[n._v("141")]),n._v(" 的校验值为0x01af，应当为 0x927a。  已处理.\n组 "),e("span",{pre:!0,attrs:{class:"token number"}},[n._v("142")]),n._v(" 的块位图并不在 组 中。（块 "),e("span",{pre:!0,attrs:{class:"token number"}},[n._v("130887852769739200")]),n._v("）\n重定位"),e("span",{pre:!0,attrs:{class:"token operator"}},[n._v("<")]),n._v("y"),e("span",{pre:!0,attrs:{class:"token operator"}},[n._v(">")]),n._v("? 否\n组 "),e("span",{pre:!0,attrs:{class:"token number"}},[n._v("142")]),n._v(" 的inode位图 并不在 组 中。（块 "),e("span",{pre:!0,attrs:{class:"token number"}},[n._v("131450811313226178")]),n._v("）\n重定位"),e("span",{pre:!0,attrs:{class:"token operator"}},[n._v("<")]),n._v("y"),e("span",{pre:!0,attrs:{class:"token operator"}},[n._v(">")]),n._v("? 已取消！\n组 "),e("span",{pre:!0,attrs:{class:"token number"}},[n._v("142")]),n._v(" 的inode表并不在 组 中。（块 "),e("span",{pre:!0,attrs:{class:"token number"}},[n._v("132013769856713156")]),n._v("）\n警告：这可能导致严重的数据丢失。\n重定位"),e("span",{pre:!0,attrs:{class:"token operator"}},[n._v("<")]),n._v("y"),e("span",{pre:!0,attrs:{class:"token operator"}},[n._v(">")]),n._v("? 已取消！\n组描述符 "),e("span",{pre:!0,attrs:{class:"token number"}},[n._v("142")]),n._v(" 的校验值为0x01cf，应当为 0x288c。  已处理.\n\n/dev/nvme0n1p6：***** 文件系统已修改 *****\n\n/dev/nvme0n1p6：********** 警告：文件系统上仍有错误 **********\n")])])]),e("p",[n._v("改到一半，发现不对劲，赶紧 "),e("code",[n._v("Ctrl + C")]),n._v("。")]),n._v(" "),e("p",[n._v("所以，它真的是 NTFS。那怎么修呢？并不存在 "),e("code",[n._v("fsck.ntfs")]),n._v(" 这种东西，但是稍微一 Google 就能搜到 "),e("code",[n._v("ntfsfix")]),n._v(" 这个好东西。")]),n._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("$ ntfsfix\nERROR: You must specify a device.\nntfsfix v2021.8.22 (libntfs-3g)\n\nUsage: ntfsfix [options] device\n    Attempt to fix an NTFS partition.\n\n    -b, --clear-bad-sectors Clear the bad sector list\n    -d, --clear-dirty       Clear the volume dirty flag\n    -h, --help              Display this help\n    -n, --no-action         Do not write anything\n    -V, --version           Display version information\n\nFor example: ntfsfix /dev/hda6\n\nDevelopers' email address: ntfs-3g-devel@lists.sf.net\nNews, support and information:  http://tuxera.com\n\n$ sudo ntfsfix /dev/nvme0n1p6\nMounting volume... NTFS signature is missing.\nFAILED\nAttempting to correct errors... NTFS signature is missing.\nFAILED\nFailed to startup volume: Invalid argument\nNTFS signature is missing.\nTrying the alternate boot sector\nThe alternate bootsector is usable\nRewriting the bootsector\nThe boot sector has been rewritten\n\nProcessing $MFT and $MFTMirr...\nReading $MFT... OK\nReading $MFTMirr... OK\nComparing $MFTMirr to $MFT... OK\nProcessing of $MFT and $MFTMirr completed successfully.\nSetting required flags on partition... OK\nGoing to empty the journal ($LogFile)... OK\nChecking the alternate boot sector... OK\nNTFS volume version is 3.1.\nNTFS partition /dev/nvme0n1p6 was processed successfully.\n")])])]),e("p",[n._v("看起来挺顺利的。"),e("code",[n._v("parted -l")]),n._v(" 检查一下：")]),n._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("$ sudo parted -l\n型号：Samsung SSD 980 PRO 1TB (nvme)\n磁盘 /dev/nvme0n1：1000GB\n扇区大小 (逻辑/物理)：512B/512B\n分区表：gpt\n磁盘标志：\n\n编号  起始点  结束点  大小    文件系统        名称                          标志\n 1    17.4kB  16.8MB  16.8MB                                                bios_grub\n 2    16.8MB  554MB   537MB   ext4\n 3    554MB   215GB   215GB   ext4\n 4    215GB   430GB   215GB   ext4\n 5    430GB   452GB   21.5GB  linux-swap(v1)                                交换\n 6    452GB   1000GB  549GB   ntfs            Basic data partition          msftdata\n 7    1000GB  1000GB  2596kB                  Microsoft reserved partition  msftres\n")])])]),e("p",[n._v("对的。")]),n._v(" "),e("p",[n._v("挂载一下试试：")]),n._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("$ sudo mount /dev/nvme0n1p6 /run/media/liu/Documents\nmount: /run/media/liu/Documents: /dev/nvme0n1p6 上探测到了更多文件系统；请使用 -t <类型> 或 wipefs(8).\n")])])]),e("p",[n._v("唔。搜了一下 "),e("code",[n._v("探测到了更多文件系统")]),n._v("，原文是 "),e("code",[n._v("more filesystems detected")]),n._v("。没有搜到太多有用的东西。")]),n._v(" "),e("h2",{attrs:{id:"探测到了更多文件系统"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#探测到了更多文件系统"}},[n._v("#")]),n._v(" “探测到了更多文件系统”")]),n._v(" "),e("p",[n._v("既然这样，先试试 "),e("code",[n._v("mount -t")]),n._v(" 吧。")]),n._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("$ sudo mount /dev/nvme0n1p6 /run/media/liu/Documents -t ntfs\n$ sudo ls /run/media/liu/Documents\n")])])]),e("p",[n._v("成功看到它~~生前（bushi）~~之前的文件。")]),n._v(" "),e("p",[n._v("试一下 "),e("code",[n._v("wipefs")]),n._v(" 呢？")]),n._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v('$ wipefs\nwipefs: 未指定设备\n请尝试执行“wipefs --help”了解更多信息。\n\n$ wipefs --help\n\n用法：\n wipefs [选项] <设备>\n\n从设备擦除签名。\n\n选项：\n -a, --all           wipe all magic strings (BE CAREFUL!)\n -b, --backup        create a signature backup in $HOME\n -f, --force         force erasure\n -i, --noheadings    don\'t print headings\n -J, --json          使用 JSON 输出格式\n -n, --no-act        do everything except the actual write() call\n -o, --offset <num>  offset to erase, in bytes\n -O, --output <list> COLUMNS to display (see below)\n -p, --parsable      print out in parsable instead of printable format\n -q, --quiet         禁止输出信息\n -t, --types <list>  limit the set of filesystem, RAIDs or partition tables\n     --lock[=<mode>] use exclusive device lock (yes, no or nonblock)\n -h, --help          显示此帮助\n -V, --version       显示版本\n\nArguments:\n <num> arguments may be followed by the suffixes for\n   GiB, TiB, PiB, EiB, ZiB, and YiB (the "iB" is optional)\n\n可用的输出列：\n     UUID  分区/文件系统 UUID\n    LABEL  文件系统标签\n   LENGTH  magic string length\n     TYPE  超级块类型\n   OFFSET  magic string offset\n    USAGE  类型描述\n   DEVICE  块设备名称\n\n更多信息请参阅 wipefs(8)。\n')])])]),e("p",[n._v("嗯，看起来直接调用 "),e("code",[n._v("wipefs")]),n._v(" 不会字如其名地 "),e("code",[n._v("wipe")]),n._v("，而是展示信息。那就跑一下吧。")]),n._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("$ sudo wipefs /dev/nvme0n1p6\nDEVICE    OFFSET TYPE UUID                                 LABEL\nnvme0n1p6 0x438  ext4 f6be4202-5847-4722-b5bd-654166abdacd \nnvme0n1p6 0x3    ntfs 4ABAA764BAA74AF1                     Documents\n")])])]),e("p",[n._v("好！一切都能解释通了。这个分区同时拥有 ext4 和 NTFS 两种签名。所以，可以删掉一种吗？")]),n._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("$ sudo umount /dev/nvme0n1p6\n$ sudo wipefs /dev/nvme0n1p6 -b -t ntfs -a\n/dev/nvme0n1p6：8 个字节已擦除，位置偏移为 0x00000003 (ntfs)：4e 54 46 53 20 20 20 20\n")])])]),e("p",[n._v("不对！上面的命令是删掉 NTFS 签名，并非只保留 NTFS 签名！但我发现的时候已经晚了。")]),n._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("$ sudo wipefs /dev/nvme0n1p6\nDEVICE    OFFSET TYPE UUID                                 LABEL\nnvme0n1p6 0x438  ext4 f6be4202-5847-4722-b5bd-654166abdacd \n")])])]),e("p",[n._v("在想怎么救之前，先把 ext4 签名也删了吧。")]),n._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[n._v("$ "),e("span",{pre:!0,attrs:{class:"token function"}},[n._v("sudo")]),n._v(" wipefs /dev/nvme0n1p6 -b -t ext4 -a\n/dev/nvme0n1p6：2 个字节已擦除，位置偏移为 0x00000438 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),n._v("ext4"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),n._v("：53 ef\n\n$ "),e("span",{pre:!0,attrs:{class:"token function"}},[n._v("sudo")]),n._v(" wipefs /dev/nvme0n1p6\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[n._v("# 这下真的啥都没了")]),n._v("\n")])])]),e("p",[n._v("突然想到 "),e("code",[n._v("ntfsfix")]),n._v("，跑一下试试：")]),n._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("$ sudo ntfsfix /dev/nvme0n1p6\nMounting volume... NTFS signature is missing.\nFAILED\nAttempting to correct errors... NTFS signature is missing.\nFAILED\nFailed to startup volume: Invalid argument\nNTFS signature is missing.\nTrying the alternate boot sector\nThe alternate bootsector is usable\nRewriting the bootsector\nThe boot sector has been rewritten\n\nProcessing $MFT and $MFTMirr...\nReading $MFT... OK\nReading $MFTMirr... OK\nComparing $MFTMirr to $MFT... OK\nProcessing of $MFT and $MFTMirr completed successfully.\nSetting required flags on partition... OK\nGoing to empty the journal ($LogFile)... OK\nChecking the alternate boot sector... OK\nNTFS volume version is 3.1.\nNTFS partition /dev/nvme0n1p6 was processed successfully.\n\n$ sudo wipefs /dev/nvme0n1p6\nDEVICE    OFFSET TYPE UUID             LABEL\nnvme0n1p6 0x3    ntfs 4ABAA764BAA74AF1 Documents\n")])])]),e("p",[n._v("好耶！此贴完结。")])])}),[],!1,null,null,null);s.default=a.exports}}]);