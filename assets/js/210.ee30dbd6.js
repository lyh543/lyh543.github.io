(window.webpackJsonp=window.webpackJsonp||[]).push([[210],{598:function(p,a,e){"use strict";e.r(a);var n=e(3),s=Object(n.a)({},(function(){var p=this,a=p._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":p.$parent.slotKey}},[a("p",[a("s",[p._v("正如 IE 的唯一作用是安装 Chrome，npm 的作用也是用来安装 yarn/pnpm")])]),p._v(" "),a("p",[p._v("最近 pnpm 8 发布，把公司 monorepo 的 pnpm 版本升级到 8 了，借机测试了一下安装 pnpm 的各种方法，最后发现 Node.js 推出的Corepack 是最好用的。")]),p._v(" "),a("p",[p._v("Corepack 是 Node.js 推出的包管理器的管理器。类似于 nvm 可以一行命令安装、切换 Node.js 的版本，Corepack 可以一行命令安装、切换 npm / yarn / pnpm 的版本。")]),p._v(" "),a("p",[a("strong",[p._v("除此之外，Corepack 还有一个特性，能够读取项目的 "),a("code",[p._v("packge.json")]),p._v(" 中的 "),a("code",[p._v("pacakgeManager")]),p._v(" 字段，从而自动切换到对应版本的包管理器")]),p._v("。这在多人、多项目协作开发中非常有用，比如 "),a("code",[p._v("pnpm@7.0.0")]),p._v(" 和 "),a("code",[p._v("pnpm@8")]),p._v(" 不兼容彼此的 "),a("code",[p._v("pnpm-lock.yaml")]),p._v("，如果 pnpm 版本不统一，很容易出问题。")]),p._v(" "),a("p",[p._v("使用 corepack 安装 pnpm 的方法：")]),p._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[p._v("corepack "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[p._v("enable")]),p._v("\ncorepack prepare pnpm@latest --activate "),a("span",{pre:!0,attrs:{class:"token comment"}},[p._v("# 旧版 Node.js 不支持 pnpm@latest，需要具体到 pnpm@x.y.z")]),p._v("\n")])])]),a("p",[p._v("安装完成后，使用 "),a("code",[p._v("cat")]),p._v(" 可以确认，"),a("code",[p._v("pnpm <args>")]),p._v(" 现在运行的是 "),a("code",[p._v("corepack pnpm <args>")]),p._v("。")]),p._v(" "),a("p",[a("img",{attrs:{src:"/images/632230d281d7cc81a66aed8e61474f2ce255ca62c0bcf4a970b46946e5d101f0.png",alt:"cat $(which pnpm)"}})]),p._v(" "),a("hr"),p._v(" "),a("p",[p._v("下面演示 Corepack 在不同项目间自动切换包管理器的特性。")]),p._v(" "),a("p",[p._v("我在全局使用 Corepack 安装 "),a("code",[p._v("pnpm@8.3.1")]),p._v("，随后在 "),a("code",[p._v("playground")]),p._v(" 目录下创建了一个 "),a("code",[p._v("playground/npm/package.json")]),p._v("，规定使用 "),a("code",[p._v("pnpm@7.0.0")]),p._v(" 作为包管理器。")]),p._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[p._v("{")]),p._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[p._v('"packageManager"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[p._v(":")]),p._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[p._v('"pnpm@7.0.0"')]),p._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[p._v("}")]),p._v("\n")])])]),a("p",[p._v("可以看到在 "),a("code",[p._v("playground")]),p._v(" 目录下 pnpm 版本为 "),a("code",[p._v("8.3.1")]),p._v("，在 "),a("code",[p._v("npm")]),p._v(" 目录下就自动切换到了 "),a("code",[p._v("7.0.0")]),p._v("。")]),p._v(" "),a("p",[a("img",{attrs:{src:"/images/6cdf8596bd5922fbca95f1f4e7cfe1706338b9a7781ebbfb95523e31105c9e8e.png",alt:"pnpm 自动切换版本"}})]),p._v(" "),a("p",[p._v("多人协作开发，只要配置好 "),a("code",[p._v("packageManager")]),p._v("，然后让别人用 Corepack 安装包管理器，能节省很多时间。")])])}),[],!1,null,null,null);a.default=s.exports}}]);