(window.webpackJsonp=window.webpackJsonp||[]).push([[50],{405:function(t,e,a){"use strict";a.r(e);var s=a(3),v=Object(s.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"前言"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#前言"}},[t._v("#")]),t._v(" 前言")]),t._v(" "),a("p",[t._v("ACM 时，曾经测试过 "),a("a",{attrs:{href:"http://acm.uestc.edu.cn",target:"_blank",rel:"noopener noreferrer"}},[t._v("Lutece"),a("OutboundLink")],1),t._v(" 的速度并记录在"),a("a",{attrs:{href:"../../ACM/Lutece%E9%80%9F%E5%BA%A6"}},[t._v("这篇博客")]),t._v("，毕竟 OJ 运算速度直接关系到了每一次写的代码的复杂度。")]),t._v(" "),a("p",[t._v("脱坑 ACM 以后，在编程珠玑里面看到了自己的电脑的运算速度应该作为常识记住，于是就花一天的时间测了一下，并进行了简要分析。附测试的"),a("a",{attrs:{href:"../computer_calculating_efficiency.cpp"}},[t._v("代码")]),t._v("和"),a("a",{attrs:{href:"./cpp-calculating-efficiency/computer_calculating_efficiency.xlsx"}},[t._v("完整数据")]),t._v("。")]),t._v(" "),a("p",[t._v("本文涉及到的次数并不准确，因为没有计算 for 循环递增量以及执行 for 循环的时间。本文只是粗略统计一下电脑计算速度的数量级，以及比较各状态下的速度。")]),t._v(" "),a("h2",{attrs:{id:"测试环境"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#测试环境"}},[t._v("#")]),t._v(" 测试环境")]),t._v(" "),a("blockquote",[a("p",[t._v("测试电脑：Surface Book\nCPU：Intel(R) Core(TM) i7-6600U CPU @ 2.60GHz\n测试线程数：1\n操作系统：Windows 10 10.0.18912.1001 (64 bit)\n编译器：MSVC 2017\n编译选项（除测试架构和编译选项时）：X64, Release, O2 优化\n每次测试组数：20（程序启动的前两组速度有明显的差异，因此统计运算速度时之计后 18 组）")])]),t._v(" "),a("h2",{attrs:{id:"结论"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#结论"}},[t._v("#")]),t._v(" 结论")]),t._v(" "),a("ol",[a("li",[t._v("对于架构和编译选项来说，O2 优化能带给程序 3-9 倍的速度提升；同样的代码编译出的 64 位程序较 32 位快 13% - 218%；")]),t._v(" "),a("li",[t._v("整型的运算的加、乘都是 1e9 次/秒数量级的，浮点类型的加、乘都是 1e8 次/秒数量级。对于 log 和 sqrt 类型，整型可能会慢于浮点类型，但都在 1e7次/秒 数量级；")]),t._v(" "),a("li",[t._v("极端数据范围的数据运算不影响整型运算的速度，略微影响浮点型运算的速度（10%）；")]),t._v(" "),a("li",[t._v("高精度运算在 "),a("code",[t._v("long long")]),t._v(" 范围内加，比 C 自带整型类型慢三个数量级；100 位的加法也只比前面慢不到一个数量级（后经测试，乘法慢于加法，但差别不大，虽然是乘法 "),a("eq",[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[a("semantics",[a("mrow",[a("mi",[t._v("O")]),a("mo",{attrs:{stretchy:"false"}},[t._v("(")]),a("msup",[a("mi",[t._v("n")]),a("mn",[t._v("2")])],1),a("mo",{attrs:{stretchy:"false"}},[t._v(")")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("O(n^2)")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"1.064108em","vertical-align":"-0.25em"}}),a("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.02778em"}},[t._v("O")]),a("span",{staticClass:"mopen"},[t._v("(")]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathdefault"},[t._v("n")]),a("span",{staticClass:"msupsub"},[a("span",{staticClass:"vlist-t"},[a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"0.8141079999999999em"}},[a("span",{staticStyle:{top:"-3.063em","margin-right":"0.05em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),a("span",{staticClass:"sizing reset-size6 size3 mtight"},[a("span",{staticClass:"mord mtight"},[t._v("2")])])])])])])])]),a("span",{staticClass:"mclose"},[t._v(")")])])])])]),t._v("，但 n=100 也较小）。")],1)]),t._v(" "),a("h2",{attrs:{id:"测试一-架构和编译选项"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#测试一-架构和编译选项"}},[t._v("#")]),t._v(" 测试一：架构和编译选项")]),t._v(" "),a("p",[t._v("测试的是 "),a("code",[t._v("long long")]),t._v(" 类型从 1 加到 1e9。以下是测试结果：")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"center"}},[t._v("1s 运算次数")]),t._v(" "),a("th",{staticStyle:{"text-align":"center"}},[t._v("debug(Od)")]),t._v(" "),a("th",{staticStyle:{"text-align":"center"}},[t._v("release(Od)")]),t._v(" "),a("th",{staticStyle:{"text-align":"center"}},[t._v("release(O1)")]),t._v(" "),a("th",{staticStyle:{"text-align":"center"}},[t._v("release(O2)")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("x86")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("3.05E+08")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}}),t._v(" "),a("td",{staticStyle:{"text-align":"center"}}),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("9.55E+08")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("x64")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("3.47E+08")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("3.61E+08")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("1.9E+09")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("3.04E+09")])])])]),t._v(" "),a("p",[t._v("注："),a("code",[t._v("Od")]),t._v(" 为禁用优化，"),a("code",[t._v("O1")]),t._v(" 为最大优化（优选大小），"),a("code",[t._v("O2")]),t._v(" 为最大优化（优选速度）。")]),t._v(" "),a("p",[t._v("可以观察到，在没有优化的情况下，debug 和 release 的区别其实不大。但是开了 O2 优化以后，程序获得了 3-9 倍的加速。")]),t._v(" "),a("p",[t._v("而对于 x86 和 x64 来说，无优化下，x64 略快于 x86 （约 13%）；而在 O2 优化下，x64 较 x86 快了 218%。")]),t._v(" "),a("h2",{attrs:{id:"测试二-数据类型和运算"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#测试二-数据类型和运算"}},[t._v("#")]),t._v(" 测试二：数据类型和运算")]),t._v(" "),a("p",[t._v("测试的类型有 "),a("code",[t._v("int")]),t._v("，"),a("code",[t._v("long long")]),t._v("，"),a("code",[t._v("float")]),t._v("，"),a("code",[t._v("double")]),t._v(" 和一个自定义的高精度运算 "),a("code",[t._v("BigInteger")]),t._v("（源码包含在"),a("a",{attrs:{href:"./computer_calculating_efficiency.cpp"}},[t._v("测试代码")]),t._v("中）。测试的运算有 "),a("code",[t._v("+")]),t._v("，"),a("code",[t._v("*")]),t._v("，"),a("code",[t._v("cmath")]),t._v(" 中的 "),a("code",[t._v("sqrt()")]),t._v(" 和 "),a("code",[t._v("log()")]),t._v("。")]),t._v(" "),a("p",[a("code",[t._v("int")]),t._v("，"),a("code",[t._v("long long")]),t._v("，"),a("code",[t._v("double")]),t._v(" 都是从 1 测到 1e9。"),a("br"),t._v("\n在进行 "),a("code",[t._v("float")]),t._v(" 的测试时发现使用 "),a("code",[t._v("i++")]),t._v("，当数据达到 "),a("eq",[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[a("semantics",[a("mrow",[a("msup",[a("mn",[t._v("2")]),a("mn",[t._v("24")])],1),a("mo",[t._v("≈")]),a("mn",[t._v("1.6")]),a("mo",[t._v("×")]),a("mn",[t._v("1")]),a("msup",[a("mn",[t._v("0")]),a("mn",[t._v("7")])],1)],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("2^{24} \\approx 1.6 \\times 10^7")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"0.8141079999999999em","vertical-align":"0em"}}),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord"},[t._v("2")]),a("span",{staticClass:"msupsub"},[a("span",{staticClass:"vlist-t"},[a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"0.8141079999999999em"}},[a("span",{staticStyle:{top:"-3.063em","margin-right":"0.05em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),a("span",{staticClass:"sizing reset-size6 size3 mtight"},[a("span",{staticClass:"mord mtight"},[a("span",{staticClass:"mord mtight"},[t._v("2")]),a("span",{staticClass:"mord mtight"},[t._v("4")])])])])])])])])]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),a("span",{staticClass:"mrel"},[t._v("≈")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"0.72777em","vertical-align":"-0.08333em"}}),a("span",{staticClass:"mord"},[t._v("1")]),a("span",{staticClass:"mord"},[t._v(".")]),a("span",{staticClass:"mord"},[t._v("6")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),a("span",{staticClass:"mbin"},[t._v("×")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}})]),a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"0.8141079999999999em","vertical-align":"0em"}}),a("span",{staticClass:"mord"},[t._v("1")]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord"},[t._v("0")]),a("span",{staticClass:"msupsub"},[a("span",{staticClass:"vlist-t"},[a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"0.8141079999999999em"}},[a("span",{staticStyle:{top:"-3.063em","margin-right":"0.05em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),a("span",{staticClass:"sizing reset-size6 size3 mtight"},[a("span",{staticClass:"mord mtight"},[t._v("7")])])])])])])])])])])])]),t._v(" 时，"),a("code",[t._v("i")]),t._v(" 的值不会发生变化（1 溢出了，这和和浮点数的记法有关）。于是对于 "),a("code",[t._v("float")]),t._v(" 的测试都是从 1 测到 1e7，重复 100 次。"),a("br"),t._v(" "),a("code",[t._v("BigInteger")]),t._v(" 由于太慢，只从 1 测到 1e7。")],1),t._v(" "),a("p",[t._v("以下是测试结果：")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"center"}},[t._v("1s 运算次数")]),t._v(" "),a("th",{staticStyle:{"text-align":"center"}},[t._v("int")]),t._v(" "),a("th",{staticStyle:{"text-align":"center"}},[t._v("long long")]),t._v(" "),a("th",{staticStyle:{"text-align":"center"}},[t._v("float")]),t._v(" "),a("th",{staticStyle:{"text-align":"center"}},[t._v("double")]),t._v(" "),a("th",{staticStyle:{"text-align":"center"}},[t._v("BigInteger")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("+")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("3.26E+09")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("3.04E+09")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("5.92E+08")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("5.20E+08")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("1.51E+06")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("*")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("1.99E+09")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("2.00E+09")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("6.36E+08")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("6.43E+08")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("1.11E+06")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("log()")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("3.70E+07")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("4.94E+07")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("5.69E+07")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("5.35E+07")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("\\")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("sqrt()")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("6.79E+07")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("6.83E+07")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("7.63E+07")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("5.59E+07")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("\\")])])])]),t._v(" "),a("p",[t._v("从数量级上来看，整数的加和乘能达到 1e9 次/秒 的数量级，而浮点数也能达到 1e8 次/秒 的数量级。"),a("br"),t._v("\n相比下，高精度就慢得多了，只能达到 1e6 次/秒 的数量级，比整数运算低了 3 个数量级。（所以 ACM 中，能用 "),a("code",[t._v("__int128")]),t._v(" 就别用高精度）。")]),t._v(" "),a("p",[t._v("对于不同精度的整型和浮点型数据，加法上，"),a("code",[t._v("int")]),t._v(" 比 "),a("code",[t._v("long long")]),t._v(" 快约 7%，"),a("code",[t._v("float")]),t._v(" 比 "),a("code",[t._v("double")]),t._v(" 快约 14%。但是乘法上，"),a("code",[t._v("long long")]),t._v(" 甚至比 "),a("code",[t._v("int")]),t._v(" 快不到 1%，"),a("code",[t._v("double")]),t._v(" 比 "),a("code",[t._v("float")]),t._v(" 快 1%。都不是很明显。")]),t._v(" "),a("p",[t._v("对于 "),a("code",[t._v("log")]),t._v(" 和 "),a("code",[t._v("sqrt")]),t._v(" 函数来说，"),a("code",[t._v("int")]),t._v(" 和 "),a("code",[t._v("long long")]),t._v(" 反而可能比 "),a("code",[t._v("float")]),t._v(" 和 "),a("code",[t._v("double")]),t._v(" 慢。这可能是因为 C 语言并没有实现整型的 "),a("code",[t._v("log")]),t._v(" 和 "),a("code",[t._v("sqrt")]),t._v(" 函数，而是把整型强转为浮点数来进行计算。但是这几种数据类型的运算仍然在一个数量级。")]),t._v(" "),a("h2",{attrs:{id:"测试三-数据范围对运算速度的影响"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#测试三-数据范围对运算速度的影响"}},[t._v("#")]),t._v(" 测试三：数据范围对运算速度的影响")]),t._v(" "),a("p",[t._v("由于浮点数有移位的过程，所以可能数据范围对运算速度也有一定影响。")]),t._v(" "),a("p",[t._v("本次测试选用了 "),a("code",[t._v("long long")]),t._v("（做对照），"),a("code",[t._v("float")]),t._v("，"),a("code",[t._v("double")]),t._v("，"),a("code",[t._v("BigInteger")]),t._v("，分别从 1e7, 1e10, 1e14 开始累加量为 1，累加 1e9 次（或 1e7次，循环 100 遍）（"),a("code",[t._v("BigInteger")]),t._v(" 由于过慢，只累加 1e7 次；"),a("code",[t._v("float")]),t._v(" 由于上面提到的 1 溢出问题，只计算从 1e7 累加至 1.5e7）。")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"center"}},[t._v("1s 运算次数")]),t._v(" "),a("th",{staticStyle:{"text-align":"center"}},[t._v("long long")]),t._v(" "),a("th",{staticStyle:{"text-align":"center"}},[t._v("float")]),t._v(" "),a("th",{staticStyle:{"text-align":"center"}},[t._v("double")]),t._v(" "),a("th",{staticStyle:{"text-align":"center"}},[t._v("BigInteger")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("1e7")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("2.03E+09")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("5.87E+08")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("5.97E+08")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("1.70E+06")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("1e10")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("2.02E+09")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}}),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("5.36E+08")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("1.08E+06")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("1e14")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("2.11E+09")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}}),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("5.31E+08")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("9.78E+05")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("1e100")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}}),t._v(" "),a("td",{staticStyle:{"text-align":"center"}}),t._v(" "),a("td",{staticStyle:{"text-align":"center"}}),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("3.32E+05")])])])]),t._v(" "),a("p",[t._v("可以注意到，"),a("code",[t._v("long long")]),t._v(" 的数据范围和运算速度关系确实不大；而"),a("code",[t._v("double")]),t._v(" 会有影响：数据范围从 1e7 扩大到 1e14，运算速度下降了 11%，但是仍然在一个数量级内。")]),t._v(" "),a("p",[t._v("而 "),a("code",[t._v("BigInteger")]),t._v(" 的影响同样也不大，即使是从 1e7 加到 1e100，运算速度也只下降了一个数量级。"),a("s",[t._v("可能是其他操作比较慢")])])])}),[],!1,null,null,null);e.default=v.exports}}]);