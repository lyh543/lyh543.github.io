(window.webpackJsonp=window.webpackJsonp||[]).push([[44],{446:function(t,s,a){"use strict";a.r(s);var e=a(3),i=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"_1-introduction"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-introduction"}},[t._v("#")]),t._v(" 1 Introduction")]),t._v(" "),a("h3",{attrs:{id:"什么是并行计算"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#什么是并行计算"}},[t._v("#")]),t._v(" 什么是并行计算")]),t._v(" "),a("ul",[a("li",[t._v("并行计算 (parallel computing)：在"),a("strong",[t._v("同一个")]),t._v("计算机体系的多个处理器/电脑一起工作解决一个问题")]),t._v(" "),a("li",[t._v("分布式计算 (distributed computing)：分布在"),a("strong",[t._v("多个")]),t._v("计算机体系（异地）的处理器/电脑一起工作解决一个问题")]),t._v(" "),a("li",[t._v("并行计算机 (parallel computer)：一个多核的计算机系统\n"),a("ul",[a("li",[t._v("并行计算机分为多计算机系统和中心化多处理器")]),t._v(" "),a("li",[t._v("多计算机系统 (multicomputer)：多个计算机通过"),a("strong",[t._v("内部网络")]),t._v("连接")]),t._v(" "),a("li",[t._v("中心化多处理器 (centralized/symmetrical multiprocessor, SMP)：一个计算机系统，其中所有 CPU 共享一个全局"),a("strong",[t._v("内存")])])])])]),t._v(" "),a("p",[t._v("并行计算多用于科学计算，分布式计算多用于可靠性、可用性、性价比高的计算。")]),t._v(" "),a("h3",{attrs:{id:"为什么需要并行计算"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#为什么需要并行计算"}},[t._v("#")]),t._v(" 为什么需要并行计算")]),t._v(" "),a("ul",[a("li",[t._v("微处理器性能增长越来越慢")]),t._v(" "),a("li",[t._v("同样的性能下，并行系统功耗更低")])]),t._v(" "),a("h3",{attrs:{id:"并行计算关心的问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#并行计算关心的问题"}},[t._v("#")]),t._v(" 并行计算关心的问题")]),t._v(" "),a("p",[t._v("不懂的地方都给出英文原文……")]),t._v(" "),a("ul",[a("li",[t._v("架构上的问题：\n"),a("ul",[a("li",[t._v("Pipline, ILP...")]),t._v(" "),a("li",[t._v("缓存一致性")]),t._v(" "),a("li",[t._v("单共享总线 or 网络")]),t._v(" "),a("li",[t._v("UMA, NUMA, CC-NUMA, Cluster...")])])]),t._v(" "),a("li",[t._v("编程模型上的问题：\n"),a("ul",[a("li",[t._v("单寻址空间 or 多寻址空间")]),t._v(" "),a("li",[t._v("进程使用锁、消息传递 or 其他方法进行同步")]),t._v(" "),a("li",[t._v("分布式 or 中心化内存")]),t._v(" "),a("li",[t._v("故障可靠性")])])]),t._v(" "),a("li",[t._v("性能表现上的问题：\n"),a("ul",[a("li",[t._v("指标：规模、加速比、可扩展性")]),t._v(" "),a("li",[t._v("Models: PRAM，BSP，PPRAM...")]),t._v(" "),a("li",[t._v("并行计算的评价方法")])])]),t._v(" "),a("li",[t._v("其他问题：\n"),a("ul",[a("li",[t._v("编程语言")]),t._v(" "),a("li",[t._v("编程工具")]),t._v(" "),a("li",[t._v("可移植性")]),t._v(" "),a("li",[t._v("Automatic programming of parallel computers")]),t._v(" "),a("li",[t._v("Education of parallel computing philosophy")])])])]),t._v(" "),a("h3",{attrs:{id:"如何编写并行程序"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#如何编写并行程序"}},[t._v("#")]),t._v(" 如何编写并行程序")]),t._v(" "),a("ul",[a("li",[t._v("需要明确告诉不同处理器如何分工")]),t._v(" "),a("li",[t._v("需要把串行程序改写为并行")]),t._v(" "),a("li",[t._v("有时候直接改写的效率非常低，需要设计全新的算法")])]),t._v(" "),a("h4",{attrs:{id:"举个栗子"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#举个栗子"}},[t._v("#")]),t._v(" 举个栗子")]),t._v(" "),a("p",[t._v("例子：求 n 个函数值的和，其串行算法如下：")]),t._v(" "),a("div",{staticClass:"language-cpp extra-class"},[a("pre",{pre:!0,attrs:{class:"language-cpp"}},[a("code",[t._v("sum "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    x "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("compute_next_value")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    sum "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),t._v(" x"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("假设我们有 p 个核 (p < n)，每个核计算一部分：")]),t._v(" "),a("div",{staticClass:"language-cpp extra-class"},[a("pre",{pre:!0,attrs:{class:"language-cpp"}},[a("code",[t._v("my_sum "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nmy_first_i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nmy_last_i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("my_i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" my_first_i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" my_i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" my_last_i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" my_i"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    my_x "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("compute_next_value")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    my_sum "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),t._v(" my_x"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("计算后的结果存在私有变量 "),a("code",[t._v("my_sum")]),t._v(" 中。")]),t._v(" "),a("p",[t._v("所有核计算完成后，他们将结果发送至班长（一般就设 0 号核为班长），班长负责计算最终的总和。")]),t._v(" "),a("div",{staticClass:"language-cpp extra-class"},[a("pre",{pre:!0,attrs:{class:"language-cpp"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("I am the master core"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    sum "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" my_x"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" each core other than myself "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        receive value from core"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        sum "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),t._v(" value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    send my_x to the master"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("hr"),t._v(" "),a("p",[t._v("更好的并行策略是，不要让班长核做所有的合并工作，而是均摊高每个核上。")]),t._v(" "),a("p",[t._v("对于这个问题，可以两两组合：")]),t._v(" "),a("blockquote",[a("p",[t._v("Work with odd and even numbered pairs of cores. Pair the cores so that core 0 adds its result with core 1's result，Core 2 adds its result with core 3's result, etc.\nRepeat the process now with only the evenly ranked cores. Core 0 adds result from core 2. Core 4 adds the result from core 6, etc.\nNow cores divisible by 4 repeat the process, and so forth, until core 0 has the final result.")])]),t._v(" "),a("p",[a("img",{attrs:{src:"/images/41c0ee131a061af3d800556179d029af72591aaedc55c8ea27e9de65d708f35e.png",alt:"两两组合的求和算法"}})]),t._v(" "),a("p",[t._v("这种算法中，班长只进行了 3 次通信 + 3 次求和，相较刚开始的 7 次通信 + 3 次求和。如果核数更多，这样优化的效果会更加显著。")]),t._v(" "),a("p",[t._v("但是，越复杂的问题，并行的难度会更大（比如翻译程序）。所以我们需要编写并行程序来提高多核的利用率。")]),t._v(" "),a("h4",{attrs:{id:"并行程序的编写方向"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#并行程序的编写方向"}},[t._v("#")]),t._v(" 并行程序的编写方向")]),t._v(" "),a("ol",[a("li",[t._v("任务并行：将整个任务分成很多不同的小任务")]),t._v(" "),a("li",[t._v("数据并行：将数据进行分块，每个核在自己分到的数据上做相似的任务")])]),t._v(" "),a("hr"),t._v(" "),a("p",[t._v("例子：3 个老师（A、B、C）批改 300 张试卷，每张试卷 15 题。")]),t._v(" "),a("ul",[a("li",[t._v("任务并行（将试卷按题目进行划分）：A 老师批改 1-5 题，B 老师批改 6-10 题，C 老师批改 11-15 题")]),t._v(" "),a("li",[t._v("数据并行（将试卷按张数进行划分）：每位老师各批改 100 张试卷")])]),t._v(" "),a("h3",{attrs:{id:"习题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#习题"}},[t._v("#")]),t._v(" 习题")]),t._v(" "),a("p",[t._v("在求和的栗子中，设计一个分配任务的函数（该函数负责计算每个核的 "),a("code",[t._v("my_first_i")]),t._v(" 和 "),a("code",[t._v("my_last_i")]),t._v("），使得 "),a("eq",[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[a("semantics",[a("mrow",[a("mi",[t._v("n")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("n")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"0.43056em","vertical-align":"0em"}}),a("span",{staticClass:"mord mathdefault"},[t._v("n")])])])])]),t._v(" 个任务尽量均匀地分布在 "),a("eq",[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[a("semantics",[a("mrow",[a("mi",[t._v("p")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("p")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"0.625em","vertical-align":"-0.19444em"}}),a("span",{staticClass:"mord mathdefault"},[t._v("p")])])])])]),t._v(" 个核上。")],1),t._v(" "),a("p",[t._v("（这个题目后面应该会讲）")]),t._v(" "),a("p",[t._v("一个优秀的算法是：")]),t._v(" "),a("section",[a("eqn",[a("span",{staticClass:"katex-display"},[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[a("semantics",[a("mtable",{attrs:{rowspacing:"0.24999999999999992em",columnalign:"right left",columnspacing:"0em"}},[a("mtr",[a("mtd",[a("mstyle",{attrs:{scriptlevel:"0",displaystyle:"true"}},[a("mrow",[a("mi",[t._v("m")]),a("msub",[a("mi",[t._v("y")]),a("mi",[t._v("f")])],1),a("mi",[t._v("i")]),a("mi",[t._v("r")]),a("mi",[t._v("s")]),a("msub",[a("mi",[t._v("t")]),a("mi",[t._v("i")])],1)],1)],1)],1),a("mtd",[a("mstyle",{attrs:{scriptlevel:"0",displaystyle:"true"}},[a("mrow",[a("mrow"),a("mo",[t._v("=")]),a("mo",{attrs:{stretchy:"false"}},[t._v("⌊")]),a("mfrac",[a("mrow",[a("mi",[t._v("i")]),a("mo",[t._v("∗")]),a("mi",[t._v("n")])],1),a("mi",[t._v("p")])],1),a("mo",{attrs:{stretchy:"false"}},[t._v("⌋")])],1)],1)],1)],1),a("mtr",[a("mtd",[a("mstyle",{attrs:{scriptlevel:"0",displaystyle:"true"}},[a("mrow",[a("mi",[t._v("m")]),a("msub",[a("mi",[t._v("y")]),a("mi",[t._v("l")])],1),a("mi",[t._v("a")]),a("mi",[t._v("s")]),a("msub",[a("mi",[t._v("t")]),a("mi",[t._v("i")])],1)],1)],1)],1),a("mtd",[a("mstyle",{attrs:{scriptlevel:"0",displaystyle:"true"}},[a("mrow",[a("mrow"),a("mo",[t._v("=")]),a("mo",{attrs:{stretchy:"false"}},[t._v("⌊")]),a("mfrac",[a("mrow",[a("mo",{attrs:{stretchy:"false"}},[t._v("(")]),a("mi",[t._v("i")]),a("mo",[t._v("+")]),a("mn",[t._v("1")]),a("mo",{attrs:{stretchy:"false"}},[t._v(")")]),a("mo",[t._v("∗")]),a("mi",[t._v("n")])],1),a("mi",[t._v("p")])],1),a("mo",{attrs:{stretchy:"false"}},[t._v("⌋")]),a("mo",[t._v("−")]),a("mn",[t._v("1")])],1)],1)],1)],1)],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\begin{aligned}\nmy_first_i &= \\lfloor\\frac{i*n}{p}\\rfloor \\\\\nmy_last_i &= \\lfloor\\frac{(i+1)*n}{p}\\rfloor - 1\n\\end{aligned}")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"5.1244em","vertical-align":"-2.3122em"}}),a("span",{staticClass:"mord"},[a("span",{staticClass:"mtable"},[a("span",{staticClass:"col-align-r"},[a("span",{staticClass:"vlist-t vlist-t2"},[a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"2.8122em"}},[a("span",{staticStyle:{top:"-4.90268em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"3.427em"}}),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathdefault"},[t._v("m")]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.03588em"}},[t._v("y")]),a("span",{staticClass:"msupsub"},[a("span",{staticClass:"vlist-t vlist-t2"},[a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"0.3361079999999999em"}},[a("span",{staticStyle:{top:"-2.5500000000000003em","margin-left":"-0.03588em","margin-right":"0.05em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),a("span",{staticClass:"sizing reset-size6 size3 mtight"},[a("span",{staticClass:"mord mathdefault mtight",staticStyle:{"margin-right":"0.10764em"}},[t._v("f")])])])]),a("span",{staticClass:"vlist-s"},[t._v("​")])]),a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"0.286108em"}},[a("span")])])])])]),a("span",{staticClass:"mord mathdefault"},[t._v("i")]),a("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.02778em"}},[t._v("r")]),a("span",{staticClass:"mord mathdefault"},[t._v("s")]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathdefault"},[t._v("t")]),a("span",{staticClass:"msupsub"},[a("span",{staticClass:"vlist-t vlist-t2"},[a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"0.31166399999999994em"}},[a("span",{staticStyle:{top:"-2.5500000000000003em","margin-left":"0em","margin-right":"0.05em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),a("span",{staticClass:"sizing reset-size6 size3 mtight"},[a("span",{staticClass:"mord mathdefault mtight"},[t._v("i")])])])]),a("span",{staticClass:"vlist-s"},[t._v("​")])]),a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[a("span")])])])])])])]),a("span",{staticStyle:{top:"-2.2952400000000006em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"3.427em"}}),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathdefault"},[t._v("m")]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.03588em"}},[t._v("y")]),a("span",{staticClass:"msupsub"},[a("span",{staticClass:"vlist-t vlist-t2"},[a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"0.33610799999999996em"}},[a("span",{staticStyle:{top:"-2.5500000000000003em","margin-left":"-0.03588em","margin-right":"0.05em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),a("span",{staticClass:"sizing reset-size6 size3 mtight"},[a("span",{staticClass:"mord mathdefault mtight",staticStyle:{"margin-right":"0.01968em"}},[t._v("l")])])])]),a("span",{staticClass:"vlist-s"},[t._v("​")])]),a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[a("span")])])])])]),a("span",{staticClass:"mord mathdefault"},[t._v("a")]),a("span",{staticClass:"mord mathdefault"},[t._v("s")]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathdefault"},[t._v("t")]),a("span",{staticClass:"msupsub"},[a("span",{staticClass:"vlist-t vlist-t2"},[a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"0.31166399999999994em"}},[a("span",{staticStyle:{top:"-2.5500000000000003em","margin-left":"0em","margin-right":"0.05em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),a("span",{staticClass:"sizing reset-size6 size3 mtight"},[a("span",{staticClass:"mord mathdefault mtight"},[t._v("i")])])])]),a("span",{staticClass:"vlist-s"},[t._v("​")])]),a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[a("span")])])])])])])])]),a("span",{staticClass:"vlist-s"},[t._v("​")])]),a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"2.3122em"}},[a("span")])])])]),a("span",{staticClass:"col-align-l"},[a("span",{staticClass:"vlist-t vlist-t2"},[a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"2.8122em"}},[a("span",{staticStyle:{top:"-4.90268em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"3.427em"}}),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord"}),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),a("span",{staticClass:"mrel"},[t._v("=")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),a("span",{staticClass:"mopen"},[t._v("⌊")]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mopen nulldelimiter"}),a("span",{staticClass:"mfrac"},[a("span",{staticClass:"vlist-t vlist-t2"},[a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"1.3365200000000002em"}},[a("span",{staticStyle:{top:"-2.314em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathdefault"},[t._v("p")])])]),a("span",{staticStyle:{top:"-3.23em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),a("span",{staticClass:"frac-line",staticStyle:{"border-bottom-width":"0.04em"}})]),a("span",{staticStyle:{top:"-3.677em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathdefault"},[t._v("i")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),a("span",{staticClass:"mbin"},[t._v("∗")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),a("span",{staticClass:"mord mathdefault"},[t._v("n")])])])]),a("span",{staticClass:"vlist-s"},[t._v("​")])]),a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"0.8804400000000001em"}},[a("span")])])])]),a("span",{staticClass:"mclose nulldelimiter"})]),a("span",{staticClass:"mclose"},[t._v("⌋")])])]),a("span",{staticStyle:{top:"-2.2952400000000006em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"3.427em"}}),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord"}),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),a("span",{staticClass:"mrel"},[t._v("=")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),a("span",{staticClass:"mopen"},[t._v("⌊")]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mopen nulldelimiter"}),a("span",{staticClass:"mfrac"},[a("span",{staticClass:"vlist-t vlist-t2"},[a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"1.427em"}},[a("span",{staticStyle:{top:"-2.314em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathdefault"},[t._v("p")])])]),a("span",{staticStyle:{top:"-3.23em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),a("span",{staticClass:"frac-line",staticStyle:{"border-bottom-width":"0.04em"}})]),a("span",{staticStyle:{top:"-3.677em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),a("span",{staticClass:"mord"},[a("span",{staticClass:"mopen"},[t._v("(")]),a("span",{staticClass:"mord mathdefault"},[t._v("i")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),a("span",{staticClass:"mbin"},[t._v("+")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),a("span",{staticClass:"mord"},[t._v("1")]),a("span",{staticClass:"mclose"},[t._v(")")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),a("span",{staticClass:"mbin"},[t._v("∗")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),a("span",{staticClass:"mord mathdefault"},[t._v("n")])])])]),a("span",{staticClass:"vlist-s"},[t._v("​")])]),a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"0.8804400000000001em"}},[a("span")])])])]),a("span",{staticClass:"mclose nulldelimiter"})]),a("span",{staticClass:"mclose"},[t._v("⌋")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),a("span",{staticClass:"mbin"},[t._v("−")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),a("span",{staticClass:"mord"},[t._v("1")])])])]),a("span",{staticClass:"vlist-s"},[t._v("​")])]),a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"2.3122em"}},[a("span")])])])])])])])])])])])],1),a("p",[t._v("其中 "),a("eq",[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[a("semantics",[a("mrow",[a("mi",[t._v("i")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("i")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"0.65952em","vertical-align":"0em"}}),a("span",{staticClass:"mord mathdefault"},[t._v("i")])])])])]),t._v(" 为当前核的下标，从 0 开始。")],1),t._v(" "),a("p",[a("code",[t._v("my_last_i")]),t._v(" 比较好理解，因为任务分配是连续的，"),a("code",[t._v("my_last_i")]),t._v(" 就是 下一个核的 "),a("code",[t._v("my_first_i")]),t._v(" 减 1。")]),t._v(" "),a("p",[t._v("至于 "),a("code",[t._v("my_first_i")]),t._v(" 的由来我也没想清楚，但是它可以保证"),a("strong",[t._v("所有任务的数量差不超过 1")]),t._v("，很均匀。")]),t._v(" "),a("p",[t._v("各位不妨写一个程序模拟一下分配情况，看看每个在不同的 "),a("code",[t._v("n")]),t._v("、"),a("code",[t._v("p")]),t._v(" 下，每个核被分了多少个任务、规律是怎么样的。如，在 "),a("code",[t._v("n=30")]),t._v("，"),a("code",[t._v("p=9")]),t._v(" 时，该算法会这样分配：")]),t._v(" "),a("div",{staticClass:"language-txt extra-class"},[a("pre",{pre:!0,attrs:{class:"language-txt"}},[a("code",[t._v("3 3 4 3 3 4 3 3 4\n")])])]),a("h2",{attrs:{id:"_2-parallel-programming-platform"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-parallel-programming-platform"}},[t._v("#")]),t._v(" 2 Parallel Programming Platform")]),t._v(" "),a("h3",{attrs:{id:"对冯诺依曼体系的改进"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#对冯诺依曼体系的改进"}},[t._v("#")]),t._v(" 对冯诺依曼体系的改进")]),t._v(" "),a("p",[a("img",{attrs:{src:"/images/a7978bdb70dab368cd8bb46bcc422c604eee9caaa01740bbc643e67898c4c566.png",alt:"冯诺依曼体系"}})]),t._v(" "),a("p",[t._v("冯诺依曼的核心是：存储程序，顺序执行。")]),t._v(" "),a("p",[t._v("该体系的瓶颈一般是 CPU 和内存分离。")]),t._v(" "),a("p",[t._v("改进分为三个方向：")]),t._v(" "),a("ol",[a("li",[t._v("缓存")]),t._v(" "),a("li",[t._v("虚拟存储")]),t._v(" "),a("li",[t._v("底层的并行（指令集并行、线程级并行）")])]),t._v(" "),a("h4",{attrs:{id:"缓存"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#缓存"}},[t._v("#")]),t._v(" 缓存")]),t._v(" "),a("p",[t._v("缓存：比主存更快的存储。一版用户存放物理上接近、且经常使用的数据和指令。")]),t._v(" "),a("p",[t._v("局部性原理略。")]),t._v(" "),a("p",[t._v("缓存分为 3 级。")]),t._v(" "),a("p",[a("img",{attrs:{src:"/images/65b9ee8cb161a9922d4ea87c47372cd33c7e3e8e174e1406b20ffa7d24a20786.png",alt:"3 级缓存"}})]),t._v(" "),a("p",[t._v("Cache 命中（Cache hit）和不命中（Cache miss）")]),t._v(" "),a("h5",{attrs:{id:"缓存的写策略"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#缓存的写策略"}},[t._v("#")]),t._v(" 缓存的写策略")]),t._v(" "),a("p",[t._v("当 CPU 更新缓存的数据时，缓存数据可能会和主存不同。此时有两种策略：")]),t._v(" "),a("ol",[a("li",[t._v("Write-through（写直达）：更新缓存的同时更新主存；缓存和主存始终一致，但每次写缓存的速度会变慢。")]),t._v(" "),a("li",[t._v("Write-back（写回）：更新缓存时标记缓存为"),a("strong",[t._v("脏数据（dirty）")]),t._v("，当该行缓存被替换时，脏数据会被写回至主存；写缓存的速度不受影响，但缓存替换时的速度会变慢。")])]),t._v(" "),a("h5",{attrs:{id:"缓存的映射方法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#缓存的映射方法"}},[t._v("#")]),t._v(" 缓存的映射方法")]),t._v(" "),a("ol",[a("li",[t._v("全映射：每行内存可以映射在缓存的任意位置")]),t._v(" "),a("li",[t._v("直接映射：每行内存只能映射在缓存的固定位置（一般是内存行数下标 % 缓存总行数）")]),t._v(" "),a("li",[t._v("n 路组相联映射：将缓存每 n 行分为一组，每行内存可以映射在缓存的固定的组的 n 行中任意一行（一般组号 = 内存行数下标 % 缓存总行数 % n）")])]),t._v(" "),a("p",[t._v("使用全映射或 n 路组相联映射，还需要考虑替换策略，常见的可以使用 LRU。")]),t._v(" "),a("h5",{attrs:{id:"缓存优化的技巧"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#缓存优化的技巧"}},[t._v("#")]),t._v(" 缓存优化的技巧")]),t._v(" "),a("p",[t._v("缓存对于应用程序和程序员是透明的（不能直接控制缓存），但如果知道局部性原理，可以通过改变程序顺序、间接控制缓存，进而优化速度。")]),t._v(" "),a("ol",[a("li",[t._v("合并数组（data merge）：通过将两个独立数组合并为一个复合元素的数组来改进空间局部性")]),t._v(" "),a("li",[t._v("循环交换（loop interchange）：通过改变循环嵌套来按序访问存储器中存储的数据")]),t._v(" "),a("li",[t._v("循环合并（loop fusion）：将两个具有相同循环类型且有一些变量重叠的独立循环合并")]),t._v(" "),a("li",[t._v("块化（blocking）：通过不断使用一些数据块（而不是完整地遍历一行和一列）来改进时间局部性")])]),t._v(" "),a("hr"),t._v(" "),a("p",[a("img",{attrs:{src:"/images/1bd8fa4ca6b97a525fc7df525d418279fb70e3bba08fd46a2c0bcf10b0c120c6.png",alt:"循环优化前后的代码"}})]),t._v(" "),a("p",[t._v("假设缓存大小为 4。第一种循环会发生 4 次缓存未命中、第二种循环会发生 16 次缓存未命中。（注：缓存的机制是，每次缓存不命中会将所在行的 4 个元素全部装进缓存）")]),t._v(" "),a("h4",{attrs:{id:"虚拟内存"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#虚拟内存"}},[t._v("#")]),t._v(" 虚拟内存")]),t._v(" "),a("p",[t._v("虚拟内存的大小大于主存，会将不活跃的程序换到磁盘，活跃的程序放到主存，加快速度。")]),t._v(" "),a("h5",{attrs:{id:"指令级并行"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#指令级并行"}},[t._v("#")]),t._v(" 指令级并行")]),t._v(" "),a("ol",[a("li",[t._v("流水线技术，参考计算机系统结构")]),t._v(" "),a("li",[t._v("某些情况下，多条指令也可以被同时发射")]),t._v(" "),a("li",[t._v("分支预测")])]),t._v(" "),a("h5",{attrs:{id:"线程级并行"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#线程级并行"}},[t._v("#")]),t._v(" 线程级并行")]),t._v(" "),a("p",[t._v("略。")]),t._v(" "),a("h3",{attrs:{id:"并行计算的硬件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#并行计算的硬件"}},[t._v("#")]),t._v(" 并行计算的硬件")]),t._v(" "),a("ol",[a("li",[t._v("SISD（传统冯诺依曼模型）")]),t._v(" "),a("li",[t._v("SIMD：对多个数据进行相同操作，1 个控制单元 + 多个 ALU")]),t._v(" "),a("li",[t._v("MISD（尚未开发）")]),t._v(" "),a("li",[t._v("MIMD：使用多个指令流同时操作多个数据流，多个独立操作单元 + 各自的 ALU")])]),t._v(" "),a("h4",{attrs:{id:"mimd-物理组织"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mimd-物理组织"}},[t._v("#")]),t._v(" MIMD 物理组织")]),t._v(" "),a("p",[t._v("从上到下越来越离散：")]),t._v(" "),a("ol",[a("li",[t._v("共享缓存架构（Shared Cache Architecture），多为单芯片多处理器")])]),t._v(" "),a("p",[a("img",{attrs:{src:"/images/b31c842db22a88cc5310ad83dfc800482945582e71cf6fff064d3ebb85e8b8bb.png",alt:"共享缓存架构"}})]),t._v(" "),a("ol",{attrs:{start:"2"}},[a("li",[t._v("统一内存寻址（Uniform Memory Access，UMA）")])]),t._v(" "),a("p",[a("img",{attrs:{src:"/images/b302fae7a7e7cede86e5fcac13f2f1a1fc688e04e5f29dbcb0e33c9b3bccec73.png",alt:"统一内存寻址（UMA）"}})]),t._v(" "),a("ol",{attrs:{start:"3"}},[a("li",[t._v("独立内存寻址（Non-Uniform Memory Access，NUMA）")])]),t._v(" "),a("p",[t._v("NUMA 并不是处理器完全不能访问其他块的内存，而是处理器可以直接访问一部分内存+通过处理器内置的特殊硬件访问其他内存。")]),t._v(" "),a("p",[a("img",{attrs:{src:"/images/ab410d9b708998ffb51f3aefd91effb7ca4b354f3d760f195c1777f0a985e5bf.png",alt:"独立内存寻址（NUMA）"}})]),t._v(" "),a("ol",{attrs:{start:"4"}},[a("li",[t._v("分布式系统/内存、集群（Distributed System/Memory）")])]),t._v(" "),a("p",[a("img",{attrs:{src:"/images/5474103543a1e0d0d127a9ed24803072a3fdf677114fb71fa7ad7bec245ee6da.png",alt:"分布式系统/内存"}})]),t._v(" "),a("h4",{attrs:{id:"共享内存系统"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#共享内存系统"}},[t._v("#")]),t._v(" 共享内存系统")]),t._v(" "),a("p",[t._v("略。")]),t._v(" "),a("h4",{attrs:{id:"互连网络"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#互连网络"}},[t._v("#")]),t._v(" 互连网络")]),t._v(" "),a("p",[t._v("网络的类型、网络的性能指标的一堆概念略。")]),t._v(" "),a("h4",{attrs:{id:"多维-mesh-网络"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#多维-mesh-网络"}},[t._v("#")]),t._v(" 多维 Mesh 网络")]),t._v(" "),a("p",[t._v("Mesh：将一维线性的网络拓展到二维、三维或更高维度，结点之间只能和邻居进行交流。")]),t._v(" "),a("h4",{attrs:{id:"超立方体结构"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#超立方体结构"}},[t._v("#")]),t._v(" 超立方体结构")]),t._v(" "),a("p",[t._v("超立方体结构："),a("eq",[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[a("semantics",[a("mrow",[a("mi",[t._v("d")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("d")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"0.69444em","vertical-align":"0em"}}),a("span",{staticClass:"mord mathdefault"},[t._v("d")])])])])]),t._v(" 维的超立方体有 "),a("eq",[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[a("semantics",[a("mrow",[a("mi",[t._v("p")]),a("mo",[t._v("=")]),a("msup",[a("mn",[t._v("2")]),a("mi",[t._v("d")])],1)],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("p=2^d")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"0.625em","vertical-align":"-0.19444em"}}),a("span",{staticClass:"mord mathdefault"},[t._v("p")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),a("span",{staticClass:"mrel"},[t._v("=")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"0.849108em","vertical-align":"0em"}}),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord"},[t._v("2")]),a("span",{staticClass:"msupsub"},[a("span",{staticClass:"vlist-t"},[a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"0.849108em"}},[a("span",{staticStyle:{top:"-3.063em","margin-right":"0.05em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),a("span",{staticClass:"sizing reset-size6 size3 mtight"},[a("span",{staticClass:"mord mathdefault mtight"},[t._v("d")])])])])])])])])])])])]),t._v(" 个结点。")],1),t._v(" "),a("p",[t._v("对超立方体进行编号，可以按照如图的规律：")]),t._v(" "),a("p",[a("img",{attrs:{src:"/images/b65f17eaafed3888ffdcde84eb1ad84aeaa2ae1687221694405d9c3e95f57d35.png",alt:"三维及以下的超立方体"}})]),t._v(" "),a("p",[t._v("每个 "),a("eq",[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[a("semantics",[a("mrow",[a("mi",[t._v("d")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("d")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"0.69444em","vertical-align":"0em"}}),a("span",{staticClass:"mord mathdefault"},[t._v("d")])])])])]),t._v(" 维的超立方体可以分成两个相同的 "),a("eq",[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[a("semantics",[a("mrow",[a("mi",[t._v("d")]),a("mo",[t._v("−")]),a("mn",[t._v("1")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("d-1")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"0.77777em","vertical-align":"-0.08333em"}}),a("span",{staticClass:"mord mathdefault"},[t._v("d")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),a("span",{staticClass:"mbin"},[t._v("−")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}})]),a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"0.64444em","vertical-align":"0em"}}),a("span",{staticClass:"mord"},[t._v("1")])])])])]),t._v(" 维超立方体，编号分别以 0 和 1 开头，且两个子超立方体对应结点的编号除第一位外相同。")],1),t._v(" "),a("p",[t._v("按此法可以构造出四维超立方体。")]),t._v(" "),a("p",[a("img",{attrs:{src:"/images/c1bb7fbb09828fa72ab8beb097f6e15ec05193210b10f5bc86a6e5e5b08ed1d1.png",alt:"四维超立方体"}})]),t._v(" "),a("p",[t._v("该编号方案还有一个性质：两个结点的距离等于这两个结点的汉明距离（不同的位的数量）。如在图中，0110 和 0101 的距离为 2。该性质在使用超立方体构造并行算法时会很有用。")]),t._v(" "),a("h4",{attrs:{id:"缓存一致性"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#缓存一致性"}},[t._v("#")]),t._v(" 缓存一致性")]),t._v(" "),a("p",[t._v("缓存的写策略有 Write-back 和 Write-through。在 UMA 架构下，多个处理器有各自的缓存，共用内存。")]),t._v(" "),a("p",[a("img",{attrs:{src:"/images/721e9e82756be134c4d86d06a1c54c0586d1c6b0dd82209f63b5674f24e07ec6.png",alt:"UMA 架构下的缓存一致性协议"}})]),t._v(" "),a("p",[t._v("于是，出现了两个新的概念：")]),t._v(" "),a("ul",[a("li",[t._v("Write Invalidate：处理器写自己的缓存时，使其他缓存失效；Write-through 下还需要更新内存，Write-back 下需要使内存失效。")]),t._v(" "),a("li",[t._v("Write Update：处理器写自己的缓存时，立即更新其他缓存；Write-through 下还需要更新内存，Write-back 下需要标记缓存为脏，在缓存失效的时候写回内存。")])]),t._v(" "),a("p",[t._v("两种策略在什么情况下性能更好？（猜测是在不同核频繁更新不同数据时，写失效更好；多个核都在频繁写同一个数据时，写更新更好。）")]),t._v(" "),a("p",[t._v("现代计算机都默认使用写失效策略。（猜测是因为局部性原理，多核读不同数据的情况更多）")]),t._v(" "),a("h5",{attrs:{id:"写失效协议"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#写失效协议"}},[t._v("#")]),t._v(" 写失效协议")]),t._v(" "),a("p",[t._v("三种状态："),a("strong",[t._v("Shared")]),t._v("、"),a("strong",[t._v("Invalid")]),t._v("、"),a("strong",[t._v("Modified")]),t._v("（MSI）")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("Shared")]),t._v("：存在多份有效的数据（写会导致其他失效）")]),t._v(" "),a("li",[a("code",[t._v("Modified")]),t._v("：只有当前数据有效（写不会导致其他失效）")]),t._v(" "),a("li",[a("code",[t._v("Invalidate")]),t._v("：数据无效（读会请求数据）")])]),t._v(" "),a("p",[a("img",{attrs:{src:"/images/3c4ac3aecb36f6b3c4d21e5dd1d9250b30fd54850fea0183b01b9de03169024e.png",alt:"三状态转换图"}})]),t._v(" "),a("hr"),t._v(" "),a("p",[t._v("硬件条件：所有核共享一个总线，可以用于广播。当 0 号处理器更新了 "),a("code",[t._v("x")]),t._v("，会广波这个消息，其他核听到（snoop）以后就会把自己的 "),a("code",[t._v("x")]),t._v(" 标记为 "),a("code",[t._v("Invalid")]),t._v("。")]),t._v(" "),a("hr"),t._v(" "),a("ol",[a("li",[t._v("当一个数据是 "),a("code",[t._v("Modified")]),t._v(" 后，所有操作都直接在本地进行，无需向外部广播。")]),t._v(" "),a("li",[t._v("多个核读入一个数据时，所有缓存的内容都会变为 "),a("code",[t._v("Shared")]),t._v("，随后所有的读操作都直接在本地进行，无需向外部广播。")]),t._v(" "),a("li",[t._v("多个核同时读和写时，会出现（在带宽上的）瓶颈")])]),t._v(" "),a("h5",{attrs:{id:"基于目录的缓存一致性协议"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#基于目录的缓存一致性协议"}},[t._v("#")]),t._v(" 基于目录的缓存一致性协议")]),t._v(" "),a("ul",[a("li",[t._v("基于目录：共享的状态都存储在（位于内存的）“目录”")]),t._v(" "),a("li",[t._v("目录里用一位表示 shared/dirty 状态（State）")]),t._v(" "),a("li",[t._v("目录里用一个 bitmap 表示数据被缓存在哪些处理器（Presence Bits）")])]),t._v(" "),a("p",[a("img",{attrs:{src:"/images/d2e14b80fbeca0d08d21fe3fdf5587d834a10f3ea523529ee3cf1765014c2e45.png",alt:"目录"}})]),t._v(" "),a("ol",[a("li",[t._v("处理器 0 和处理器 1 读 x，此时状态为 shared，0 和 1 的 presence bits 均为 1")]),t._v(" "),a("li",[t._v("处理器 0 写变量，状态变为 dirty，1 的 presence bits 为 0")]),t._v(" "),a("li",[t._v("处理器 2 读变量，将会请求处理器 0 写回，随后 0 和 2 的 presence bits 均为 1")])]),t._v(" "),a("hr"),t._v(" "),a("p",[t._v("该方案的开销主要是通信开销、以及可能出现频繁的争端。")]),t._v(" "),a("p",[t._v("如果一个并行程序需要大量的一致性操作（大量的读/写共享数据块），目录最终会限制它的并行性能。")]),t._v(" "),a("hr"),t._v(" "),a("p",[t._v("还可以分布式的目录系统，但是这里就学了。")]),t._v(" "),a("h5",{attrs:{id:"false-sharing"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#false-sharing"}},[t._v("#")]),t._v(" False Sharing")]),t._v(" "),a("p",[t._v("不懂")]),t._v(" "),a("h3",{attrs:{id:"并行计算的软件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#并行计算的软件"}},[t._v("#")]),t._v(" 并行计算的软件")]),t._v(" "),a("p",[t._v("并行软件也有区别：")]),t._v(" "),a("ul",[a("li",[t._v("内存共享系统上，一个进程 fork 出多个线程")]),t._v(" "),a("li",[t._v("分布式系统上，需要多个进程")])]),t._v(" "),a("p",[t._v("SPMD: single program multiple data，MPI 和 CUDA 都是用的都是这种。")]),t._v(" "),a("p",[t._v("解决并行软件的不一致性：给数据加锁")]),t._v(" "),a("p",[t._v("SPMD 的写法：")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('char message [ 1 0 0 ] ;\n. . .\nmy_rank = Get_rank ( ) ;\nif ( my_rank == 1) {\n     sprintf ( message , "Greetings from process 1" ) ;\n     Send ( message , MSG_CHAR , 100 , 0 ) ;\n} else if ( my_rank == 0) {\n     Receive ( message , MSG_CHAR , 100 , 1 ) ;\n     printf ( "Process 0 > Received: %s\\n" , message ) ;\n}\n')])])]),a("h3",{attrs:{id:"输入输出"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#输入输出"}},[t._v("#")]),t._v(" 输入输出")]),t._v(" "),a("p",[t._v("Google 翻译 yyds")]),t._v(" "),a("p",[t._v("当我们的并行程序需要进行 I/O 时，做出这些假设并遵循这些规则：\n在分布式内存程序中，仅进程0将访问stdin。 在共享内存程序中，只有主线程或线程 0 会访问 stdin。\n在分布式内存和共享内存程序中，所有进程/线程都可以访问 stdout 和 stderr。\n然而，由于输出到 stdout 的顺序不确定，在大多数情况下，除了调试输出之外，只有一个进程/线程将用于所有输出到 stdout。\n调试输出应始终包括生成输出的进程/线程的等级或 ID。\n只有单个进程/线程会尝试访问除 stdin、stdout 或 stderr 之外的任何单个文件。 因此，例如，每个进程/线程都可以打开自己的私有文件进行读取或写入，但没有两个进程/线程会打开同一个文件。")]),t._v(" "),a("h2",{attrs:{id:"_3-parallel-program-design"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-parallel-program-design"}},[t._v("#")]),t._v(" 3 Parallel Program Design")]),t._v(" "),a("h3",{attrs:{id:"foster-四步走"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#foster-四步走"}},[t._v("#")]),t._v(" Foster 四步走")]),t._v(" "),a("p",[t._v("注意这四步，是设计算法的过程的四步，而不是并行算法的先后步骤。")]),t._v(" "),a("ul",[a("li",[t._v("Partitioning：分块")]),t._v(" "),a("li",[t._v("Communication：通信")]),t._v(" "),a("li",[t._v("Agglomeration：组合")]),t._v(" "),a("li",[t._v("Mapping：映射")])]),t._v(" "),a("p",[a("img",{attrs:{src:"/images/0fb7fe40d8f55adf8f33169950b557a2106404164470c41751be8f754651da33.png",alt:"Foster's Design Methodology"}})]),t._v(" "),a("h3",{attrs:{id:"分块"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#分块"}},[t._v("#")]),t._v(" 分块")]),t._v(" "),a("p",[t._v("Domain vs. Functional Decomposition")]),t._v(" "),a("p",[t._v("其实就是数据并行 vs. 任务并行")]),t._v(" "),a("h3",{attrs:{id:"通信"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#通信"}},[t._v("#")]),t._v(" 通信")]),t._v(" "),a("p",[t._v("通信方法可以分为局部通信和邻居通信")]),t._v(" "),a("p",[a("img",{attrs:{src:"/images/d454a01f5f3d9d2e3792416ef7d268d42b8d85f0ad663a09d591cc9c584babc7.png",alt:"Local communication"}})]),t._v(" "),a("p",[a("img",{attrs:{src:"/images/bf0a0208fc6f11abc4703791e2338bb9a6dd02818f75764d4050b19e0d882b58.png",alt:"Global communication"}})]),t._v(" "),a("hr"),t._v(" "),a("p",[t._v("例子：对求和问题进行分治，只需要 logN 步")]),t._v(" "),a("p",[a("img",{attrs:{src:"/images/252f55fa41156f6b15c36df9b59b46c0584bfa1af1e50f32a9507402d2f869de.png",alt:"分治求和问题"}})]),t._v(" "),a("hr"),t._v(" "),a("p",[t._v("通信方法也可以分为结构化通信（通信网络有一定结构）和非结构化通信（通信网络可能是任意图）。")]),t._v(" "),a("p",[t._v("如果通信网络还在变化，负载均衡算法就必须频繁地更新。")]),t._v(" "),a("p",[a("img",{attrs:{src:"/images/83e66b2afd4e1eddf9ef8e602988951cacccb828c479fef3facb01da8d8e2293.png",alt:"Unstructured communication"}})]),t._v(" "),a("h3",{attrs:{id:"聚合"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#聚合"}},[t._v("#")]),t._v(" 聚合")]),t._v(" "),a("p",[t._v("聚合可以减少通信成本：任务的通信需求与其操作的子域的表面成正比，而计算需求与子域的体积成正比。有时我们可以权衡复制计算以减少通信需求和/或执行时间。")]),t._v(" "),a("h3",{attrs:{id:"映射"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#映射"}},[t._v("#")]),t._v(" 映射")]),t._v(" "),a("p",[t._v("映射：将任务映射到处理器上。")]),t._v(" "),a("p",[t._v("目标：最大化处理器利用（即负载均衡） & 最小化处理器间通信（即需要通信的进程可以映射到同一处理器）")]),t._v(" "),a("p",[a("img",{attrs:{src:"/images/a4680869e38463b763dd6a09111297235619f61afeda946b208a47cdd74005e9.png",alt:"奇奇怪怪的图的一种映射方法"}})]),t._v(" "),a("p",[t._v("不同情况下映射策略：略。")]),t._v(" "),a("hr"),t._v(" "),a("p",[a("img",{attrs:{src:"/images/fcb65523957abd252aa1b01ab2c7c87d797a121a106ba9e64a1ff91ac8aaebbc.png",alt:"Agglomeration 例题"}})]),t._v(" "),a("p",[t._v("公式：")]),t._v(" "),a("ul",[a("li",[a("eq",[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[a("semantics",[a("mrow",[a("mi",[t._v("χ")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\chi")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"0.625em","vertical-align":"-0.19444em"}}),a("span",{staticClass:"mord mathdefault"},[t._v("χ")])])])])]),t._v("：更新一个元素的时间")],1),t._v(" "),a("li",[a("eq",[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[a("semantics",[a("mrow",[a("mi",[t._v("λ")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\lambda")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"0.69444em","vertical-align":"0em"}}),a("span",{staticClass:"mord mathdefault"},[t._v("λ")])])])])]),t._v("：一个元素通信的时间")],1),t._v(" "),a("li",[a("eq",[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[a("semantics",[a("mrow",[a("mi",[t._v("n")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("n")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"0.43056em","vertical-align":"0em"}}),a("span",{staticClass:"mord mathdefault"},[t._v("n")])])])])]),t._v("：结点数")],1),t._v(" "),a("li",[a("eq",[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[a("semantics",[a("mrow",[a("mi",[t._v("m")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("m")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"0.43056em","vertical-align":"0em"}}),a("span",{staticClass:"mord mathdefault"},[t._v("m")])])])])]),t._v("：需要的迭代次数")],1),t._v(" "),a("li",[a("eq",[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[a("semantics",[a("mrow",[a("mi",[t._v("p")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("p")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"0.625em","vertical-align":"-0.19444em"}}),a("span",{staticClass:"mord mathdefault"},[t._v("p")])])])])]),t._v("：处理器数")],1)]),t._v(" "),a("p",[t._v("有一下结论：")]),t._v(" "),a("ul",[a("li",[t._v("串行执行时间："),a("eq",[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[a("semantics",[a("mrow",[a("mi",[t._v("m")]),a("mo",{attrs:{stretchy:"false"}},[t._v("(")]),a("mi",[t._v("n")]),a("mo",[t._v("−")]),a("mn",[t._v("1")]),a("mo",{attrs:{stretchy:"false"}},[t._v(")")]),a("mi",[t._v("χ")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("m(n-1)\\chi")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"1em","vertical-align":"-0.25em"}}),a("span",{staticClass:"mord mathdefault"},[t._v("m")]),a("span",{staticClass:"mopen"},[t._v("(")]),a("span",{staticClass:"mord mathdefault"},[t._v("n")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),a("span",{staticClass:"mbin"},[t._v("−")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}})]),a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"1em","vertical-align":"-0.25em"}}),a("span",{staticClass:"mord"},[t._v("1")]),a("span",{staticClass:"mclose"},[t._v(")")]),a("span",{staticClass:"mord mathdefault"},[t._v("χ")])])])])])],1),t._v(" "),a("li",[t._v("并行执行时间："),a("eq",[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[a("semantics",[a("mrow",[a("mi",[t._v("m")]),a("mo",{attrs:{stretchy:"false"}},[t._v("⌈")]),a("mo",{attrs:{stretchy:"false"}},[t._v("(")]),a("mi",[t._v("n")]),a("mo",[t._v("−")]),a("mn",[t._v("1")]),a("mo",{attrs:{stretchy:"false"}},[t._v(")")]),a("mi",{attrs:{mathvariant:"normal"}},[t._v("/")]),a("mi",[t._v("p")]),a("mo",{attrs:{stretchy:"false"}},[t._v("⌉")]),a("mo",[t._v("+")]),a("mn",[t._v("2")]),a("mi",[t._v("λ")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("m\\lceil(n-1)/p\\rceil+2\\lambda")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"1em","vertical-align":"-0.25em"}}),a("span",{staticClass:"mord mathdefault"},[t._v("m")]),a("span",{staticClass:"mopen"},[t._v("⌈")]),a("span",{staticClass:"mopen"},[t._v("(")]),a("span",{staticClass:"mord mathdefault"},[t._v("n")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),a("span",{staticClass:"mbin"},[t._v("−")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}})]),a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"1em","vertical-align":"-0.25em"}}),a("span",{staticClass:"mord"},[t._v("1")]),a("span",{staticClass:"mclose"},[t._v(")")]),a("span",{staticClass:"mord"},[t._v("/")]),a("span",{staticClass:"mord mathdefault"},[t._v("p")]),a("span",{staticClass:"mclose"},[t._v("⌉")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),a("span",{staticClass:"mbin"},[t._v("+")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}})]),a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"0.69444em","vertical-align":"0em"}}),a("span",{staticClass:"mord"},[t._v("2")]),a("span",{staticClass:"mord mathdefault"},[t._v("λ")])])])])])],1)]),t._v(" "),a("p",[t._v("有点不懂。是在这个问题下的时间公式吗？")]),t._v(" "),a("h2",{attrs:{id:"_4-performance"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-performance"}},[t._v("#")]),t._v(" 4 Performance")]),t._v(" "),a("p",[t._v("性能指标：运行时间、加速比、效率、可扩展性等")]),t._v(" "),a("h3",{attrs:{id:"加速比和效率指标"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#加速比和效率指标"}},[t._v("#")]),t._v(" 加速比和效率指标")]),t._v(" "),a("section",[a("eqn",[a("span",{staticClass:"katex-display"},[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[a("semantics",[a("mrow",[a("msub",[a("mi",[t._v("S")]),a("mi",[t._v("p")])],1),a("mo",[t._v("=")]),a("mfrac",[a("msub",[a("mi",[t._v("T")]),a("mi",[t._v("s")])],1),a("msub",[a("mi",[t._v("T")]),a("mi",[t._v("p")])],1)],1)],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("S_p = \\frac{T_s}{T_p}")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"0.969438em","vertical-align":"-0.286108em"}}),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.05764em"}},[t._v("S")]),a("span",{staticClass:"msupsub"},[a("span",{staticClass:"vlist-t vlist-t2"},[a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"0.15139200000000003em"}},[a("span",{staticStyle:{top:"-2.5500000000000003em","margin-left":"-0.05764em","margin-right":"0.05em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),a("span",{staticClass:"sizing reset-size6 size3 mtight"},[a("span",{staticClass:"mord mathdefault mtight"},[t._v("p")])])])]),a("span",{staticClass:"vlist-s"},[t._v("​")])]),a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"0.286108em"}},[a("span")])])])])]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),a("span",{staticClass:"mrel"},[t._v("=")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"2.332438em","vertical-align":"-0.972108em"}}),a("span",{staticClass:"mord"},[a("span",{staticClass:"mopen nulldelimiter"}),a("span",{staticClass:"mfrac"},[a("span",{staticClass:"vlist-t vlist-t2"},[a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"1.36033em"}},[a("span",{staticStyle:{top:"-2.314em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.13889em"}},[t._v("T")]),a("span",{staticClass:"msupsub"},[a("span",{staticClass:"vlist-t vlist-t2"},[a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"0.15139200000000003em"}},[a("span",{staticStyle:{top:"-2.5500000000000003em","margin-left":"-0.13889em","margin-right":"0.05em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),a("span",{staticClass:"sizing reset-size6 size3 mtight"},[a("span",{staticClass:"mord mathdefault mtight"},[t._v("p")])])])]),a("span",{staticClass:"vlist-s"},[t._v("​")])]),a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"0.286108em"}},[a("span")])])])])])])]),a("span",{staticStyle:{top:"-3.23em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),a("span",{staticClass:"frac-line",staticStyle:{"border-bottom-width":"0.04em"}})]),a("span",{staticStyle:{top:"-3.677em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.13889em"}},[t._v("T")]),a("span",{staticClass:"msupsub"},[a("span",{staticClass:"vlist-t vlist-t2"},[a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"0.151392em"}},[a("span",{staticStyle:{top:"-2.5500000000000003em","margin-left":"-0.13889em","margin-right":"0.05em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),a("span",{staticClass:"sizing reset-size6 size3 mtight"},[a("span",{staticClass:"mord mathdefault mtight"},[t._v("s")])])])]),a("span",{staticClass:"vlist-s"},[t._v("​")])]),a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[a("span")])])])])])])])]),a("span",{staticClass:"vlist-s"},[t._v("​")])]),a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"0.972108em"}},[a("span")])])])]),a("span",{staticClass:"mclose nulldelimiter"})])])])])])])],1),a("ul",[a("li",[a("eq",[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[a("semantics",[a("mrow",[a("msub",[a("mi",[t._v("T")]),a("mi",[t._v("s")])],1)],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("T_s")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"0.83333em","vertical-align":"-0.15em"}}),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.13889em"}},[t._v("T")]),a("span",{staticClass:"msupsub"},[a("span",{staticClass:"vlist-t vlist-t2"},[a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"0.151392em"}},[a("span",{staticStyle:{top:"-2.5500000000000003em","margin-left":"-0.13889em","margin-right":"0.05em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),a("span",{staticClass:"sizing reset-size6 size3 mtight"},[a("span",{staticClass:"mord mathdefault mtight"},[t._v("s")])])])]),a("span",{staticClass:"vlist-s"},[t._v("​")])]),a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[a("span")])])])])])])])])]),t._v("：串行时间")],1),t._v(" "),a("li",[a("eq",[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[a("semantics",[a("mrow",[a("msub",[a("mi",[t._v("T")]),a("mi",[t._v("p")])],1)],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("T_p")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"0.969438em","vertical-align":"-0.286108em"}}),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.13889em"}},[t._v("T")]),a("span",{staticClass:"msupsub"},[a("span",{staticClass:"vlist-t vlist-t2"},[a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"0.15139200000000003em"}},[a("span",{staticStyle:{top:"-2.5500000000000003em","margin-left":"-0.13889em","margin-right":"0.05em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),a("span",{staticClass:"sizing reset-size6 size3 mtight"},[a("span",{staticClass:"mord mathdefault mtight"},[t._v("p")])])])]),a("span",{staticClass:"vlist-s"},[t._v("​")])]),a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"0.286108em"}},[a("span")])])])])])])])])]),t._v("："),a("eq",[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[a("semantics",[a("mrow",[a("mi",[t._v("p")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("p")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"0.625em","vertical-align":"-0.19444em"}}),a("span",{staticClass:"mord mathdefault"},[t._v("p")])])])])]),t._v(" 个进程时的并行时间（按最长时间的进程计算）")],1),t._v(" "),a("li",[a("eq",[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[a("semantics",[a("mrow",[a("msub",[a("mi",[t._v("S")]),a("mi",[t._v("p")])],1)],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("S_p")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"0.969438em","vertical-align":"-0.286108em"}}),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.05764em"}},[t._v("S")]),a("span",{staticClass:"msupsub"},[a("span",{staticClass:"vlist-t vlist-t2"},[a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"0.15139200000000003em"}},[a("span",{staticStyle:{top:"-2.5500000000000003em","margin-left":"-0.05764em","margin-right":"0.05em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),a("span",{staticClass:"sizing reset-size6 size3 mtight"},[a("span",{staticClass:"mord mathdefault mtight"},[t._v("p")])])])]),a("span",{staticClass:"vlist-s"},[t._v("​")])]),a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"0.286108em"}},[a("span")])])])])])])])])]),t._v(" or "),a("eq",[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[a("semantics",[a("mrow",[a("mi",[t._v("ψ")]),a("mo",{attrs:{stretchy:"false"}},[t._v("(")]),a("mi",[t._v("n")]),a("mo",{attrs:{separator:"true"}},[t._v(",")]),a("mi",[t._v("p")]),a("mo",{attrs:{stretchy:"false"}},[t._v(")")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\psi(n, p)")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"1em","vertical-align":"-0.25em"}}),a("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.03588em"}},[t._v("ψ")]),a("span",{staticClass:"mopen"},[t._v("(")]),a("span",{staticClass:"mord mathdefault"},[t._v("n")]),a("span",{staticClass:"mpunct"},[t._v(",")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.16666666666666666em"}}),a("span",{staticClass:"mord mathdefault"},[t._v("p")]),a("span",{staticClass:"mclose"},[t._v(")")])])])])]),t._v("："),a("eq",[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[a("semantics",[a("mrow",[a("mi",[t._v("p")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("p")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"0.625em","vertical-align":"-0.19444em"}}),a("span",{staticClass:"mord mathdefault"},[t._v("p")])])])])]),t._v(" 个进程时的加速比 (Speedup)")],1)]),t._v(" "),a("p",[a("strong",[t._v("加速比是速度的正比，是时间的反比")])]),t._v(" "),a("section",[a("eqn",[a("span",{staticClass:"katex-display"},[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[a("semantics",[a("mrow",[a("mi",[t._v("ψ")]),a("mo",{attrs:{stretchy:"false"}},[t._v("(")]),a("mi",[t._v("n")]),a("mo",{attrs:{separator:"true"}},[t._v(",")]),a("mi",[t._v("p")]),a("mo",{attrs:{stretchy:"false"}},[t._v(")")]),a("mo",[t._v("≤")]),a("mfrac",[a("mrow",[a("mi",[t._v("σ")]),a("mo",{attrs:{stretchy:"false"}},[t._v("(")]),a("mi",[t._v("n")]),a("mo",{attrs:{stretchy:"false"}},[t._v(")")]),a("mo",[t._v("+")]),a("mi",[t._v("φ")]),a("mo",{attrs:{stretchy:"false"}},[t._v("(")]),a("mi",[t._v("n")]),a("mo",{attrs:{stretchy:"false"}},[t._v(")")])],1),a("mrow",[a("mi",[t._v("σ")]),a("mo",{attrs:{stretchy:"false"}},[t._v("(")]),a("mi",[t._v("n")]),a("mo",{attrs:{stretchy:"false"}},[t._v(")")]),a("mo",[t._v("+")]),a("mi",[t._v("φ")]),a("mo",{attrs:{stretchy:"false"}},[t._v("(")]),a("mi",[t._v("n")]),a("mo",{attrs:{stretchy:"false"}},[t._v(")")]),a("mi",{attrs:{mathvariant:"normal"}},[t._v("/")]),a("mi",[t._v("p")]),a("mo",[t._v("+")]),a("mi",[t._v("κ")]),a("mo",{attrs:{stretchy:"false"}},[t._v("(")]),a("mi",[t._v("n")]),a("mo",{attrs:{separator:"true"}},[t._v(",")]),a("mi",[t._v("p")]),a("mo",{attrs:{stretchy:"false"}},[t._v(")")])],1)],1)],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\psi(n, p) \\leq \\frac{\\sigma(n)+\\varphi(n)}{\\sigma(n)+\\varphi(n) / p+\\kappa(n, p)}")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"1em","vertical-align":"-0.25em"}}),a("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.03588em"}},[t._v("ψ")]),a("span",{staticClass:"mopen"},[t._v("(")]),a("span",{staticClass:"mord mathdefault"},[t._v("n")]),a("span",{staticClass:"mpunct"},[t._v(",")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.16666666666666666em"}}),a("span",{staticClass:"mord mathdefault"},[t._v("p")]),a("span",{staticClass:"mclose"},[t._v(")")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),a("span",{staticClass:"mrel"},[t._v("≤")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"2.363em","vertical-align":"-0.936em"}}),a("span",{staticClass:"mord"},[a("span",{staticClass:"mopen nulldelimiter"}),a("span",{staticClass:"mfrac"},[a("span",{staticClass:"vlist-t vlist-t2"},[a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"1.427em"}},[a("span",{staticStyle:{top:"-2.314em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.03588em"}},[t._v("σ")]),a("span",{staticClass:"mopen"},[t._v("(")]),a("span",{staticClass:"mord mathdefault"},[t._v("n")]),a("span",{staticClass:"mclose"},[t._v(")")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),a("span",{staticClass:"mbin"},[t._v("+")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),a("span",{staticClass:"mord mathdefault"},[t._v("φ")]),a("span",{staticClass:"mopen"},[t._v("(")]),a("span",{staticClass:"mord mathdefault"},[t._v("n")]),a("span",{staticClass:"mclose"},[t._v(")")]),a("span",{staticClass:"mord"},[t._v("/")]),a("span",{staticClass:"mord mathdefault"},[t._v("p")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),a("span",{staticClass:"mbin"},[t._v("+")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),a("span",{staticClass:"mord mathdefault"},[t._v("κ")]),a("span",{staticClass:"mopen"},[t._v("(")]),a("span",{staticClass:"mord mathdefault"},[t._v("n")]),a("span",{staticClass:"mpunct"},[t._v(",")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.16666666666666666em"}}),a("span",{staticClass:"mord mathdefault"},[t._v("p")]),a("span",{staticClass:"mclose"},[t._v(")")])])]),a("span",{staticStyle:{top:"-3.23em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),a("span",{staticClass:"frac-line",staticStyle:{"border-bottom-width":"0.04em"}})]),a("span",{staticStyle:{top:"-3.677em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.03588em"}},[t._v("σ")]),a("span",{staticClass:"mopen"},[t._v("(")]),a("span",{staticClass:"mord mathdefault"},[t._v("n")]),a("span",{staticClass:"mclose"},[t._v(")")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),a("span",{staticClass:"mbin"},[t._v("+")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),a("span",{staticClass:"mord mathdefault"},[t._v("φ")]),a("span",{staticClass:"mopen"},[t._v("(")]),a("span",{staticClass:"mord mathdefault"},[t._v("n")]),a("span",{staticClass:"mclose"},[t._v(")")])])])]),a("span",{staticClass:"vlist-s"},[t._v("​")])]),a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"0.936em"}},[a("span")])])])]),a("span",{staticClass:"mclose nulldelimiter"})])])])])])])],1),a("p",[t._v("好的加速比：（相较进程数）线性加速、亚线性加速、超线性加速")]),t._v(" "),a("p",[a("img",{attrs:{src:"/images/807e384221a9eee87727e5c72b4e2397487d61877a61d664087eccc2f54b72a6.png",alt:"好的加速比"}})]),t._v(" "),a("p",[t._v("超线性加速出现在：多级内存、缓存影响、DFS 遍历树算法等。")]),t._v(" "),a("hr"),t._v(" "),a("section",[a("eqn",[a("span",{staticClass:"katex-display"},[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[a("semantics",[a("mrow",[a("mi",[t._v("ψ")]),a("mo",{attrs:{stretchy:"false"}},[t._v("(")]),a("mi",[t._v("n")]),a("mo",{attrs:{separator:"true"}},[t._v(",")]),a("mi",[t._v("p")]),a("mo",{attrs:{stretchy:"false"}},[t._v(")")]),a("mo",[t._v("≤")]),a("mfrac",[a("mrow",[a("mi",[t._v("σ")]),a("mo",{attrs:{stretchy:"false"}},[t._v("(")]),a("mi",[t._v("n")]),a("mo",{attrs:{stretchy:"false"}},[t._v(")")]),a("mo",[t._v("+")]),a("mi",[t._v("φ")]),a("mo",{attrs:{stretchy:"false"}},[t._v("(")]),a("mi",[t._v("n")]),a("mo",{attrs:{stretchy:"false"}},[t._v(")")])],1),a("mrow",[a("mi",[t._v("σ")]),a("mo",{attrs:{stretchy:"false"}},[t._v("(")]),a("mi",[t._v("n")]),a("mo",{attrs:{stretchy:"false"}},[t._v(")")]),a("mo",[t._v("+")]),a("mi",[t._v("φ")]),a("mo",{attrs:{stretchy:"false"}},[t._v("(")]),a("mi",[t._v("n")]),a("mo",{attrs:{stretchy:"false"}},[t._v(")")]),a("mi",{attrs:{mathvariant:"normal"}},[t._v("/")]),a("mi",[t._v("p")]),a("mo",[t._v("+")]),a("mi",[t._v("κ")]),a("mo",{attrs:{stretchy:"false"}},[t._v("(")]),a("mi",[t._v("n")]),a("mo",{attrs:{separator:"true"}},[t._v(",")]),a("mi",[t._v("p")]),a("mo",{attrs:{stretchy:"false"}},[t._v(")")])],1)],1)],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\psi(n, p) \\leq \\frac{\\sigma(n)+\\varphi(n)}{\\sigma(n)+\\varphi(n) / p+\\kappa(n, p)}")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"1em","vertical-align":"-0.25em"}}),a("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.03588em"}},[t._v("ψ")]),a("span",{staticClass:"mopen"},[t._v("(")]),a("span",{staticClass:"mord mathdefault"},[t._v("n")]),a("span",{staticClass:"mpunct"},[t._v(",")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.16666666666666666em"}}),a("span",{staticClass:"mord mathdefault"},[t._v("p")]),a("span",{staticClass:"mclose"},[t._v(")")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),a("span",{staticClass:"mrel"},[t._v("≤")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"2.363em","vertical-align":"-0.936em"}}),a("span",{staticClass:"mord"},[a("span",{staticClass:"mopen nulldelimiter"}),a("span",{staticClass:"mfrac"},[a("span",{staticClass:"vlist-t vlist-t2"},[a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"1.427em"}},[a("span",{staticStyle:{top:"-2.314em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.03588em"}},[t._v("σ")]),a("span",{staticClass:"mopen"},[t._v("(")]),a("span",{staticClass:"mord mathdefault"},[t._v("n")]),a("span",{staticClass:"mclose"},[t._v(")")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),a("span",{staticClass:"mbin"},[t._v("+")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),a("span",{staticClass:"mord mathdefault"},[t._v("φ")]),a("span",{staticClass:"mopen"},[t._v("(")]),a("span",{staticClass:"mord mathdefault"},[t._v("n")]),a("span",{staticClass:"mclose"},[t._v(")")]),a("span",{staticClass:"mord"},[t._v("/")]),a("span",{staticClass:"mord mathdefault"},[t._v("p")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),a("span",{staticClass:"mbin"},[t._v("+")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),a("span",{staticClass:"mord mathdefault"},[t._v("κ")]),a("span",{staticClass:"mopen"},[t._v("(")]),a("span",{staticClass:"mord mathdefault"},[t._v("n")]),a("span",{staticClass:"mpunct"},[t._v(",")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.16666666666666666em"}}),a("span",{staticClass:"mord mathdefault"},[t._v("p")]),a("span",{staticClass:"mclose"},[t._v(")")])])]),a("span",{staticStyle:{top:"-3.23em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),a("span",{staticClass:"frac-line",staticStyle:{"border-bottom-width":"0.04em"}})]),a("span",{staticStyle:{top:"-3.677em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.03588em"}},[t._v("σ")]),a("span",{staticClass:"mopen"},[t._v("(")]),a("span",{staticClass:"mord mathdefault"},[t._v("n")]),a("span",{staticClass:"mclose"},[t._v(")")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),a("span",{staticClass:"mbin"},[t._v("+")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),a("span",{staticClass:"mord mathdefault"},[t._v("φ")]),a("span",{staticClass:"mopen"},[t._v("(")]),a("span",{staticClass:"mord mathdefault"},[t._v("n")]),a("span",{staticClass:"mclose"},[t._v(")")])])])]),a("span",{staticClass:"vlist-s"},[t._v("​")])]),a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"0.936em"}},[a("span")])])])]),a("span",{staticClass:"mclose nulldelimiter"})])])])])])])],1),a("ul",[a("li",[a("eq",[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[a("semantics",[a("mrow",[a("mi",[t._v("σ")]),a("mo",{attrs:{stretchy:"false"}},[t._v("(")]),a("mi",[t._v("n")]),a("mo",{attrs:{stretchy:"false"}},[t._v(")")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\sigma(n)")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"1em","vertical-align":"-0.25em"}}),a("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.03588em"}},[t._v("σ")]),a("span",{staticClass:"mopen"},[t._v("(")]),a("span",{staticClass:"mord mathdefault"},[t._v("n")]),a("span",{staticClass:"mclose"},[t._v(")")])])])])]),t._v("：不能被并行执行的的串行时间")],1),t._v(" "),a("li",[a("eq",[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[a("semantics",[a("mrow",[a("mi",[t._v("φ")]),a("mo",{attrs:{stretchy:"false"}},[t._v("(")]),a("mi",[t._v("n")]),a("mo",{attrs:{stretchy:"false"}},[t._v(")")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\varphi(n)")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"1em","vertical-align":"-0.25em"}}),a("span",{staticClass:"mord mathdefault"},[t._v("φ")]),a("span",{staticClass:"mopen"},[t._v("(")]),a("span",{staticClass:"mord mathdefault"},[t._v("n")]),a("span",{staticClass:"mclose"},[t._v(")")])])])])]),t._v("：可以被并行执行的串行时间")],1),t._v(" "),a("li",[a("eq",[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[a("semantics",[a("mrow",[a("mi",[t._v("κ")]),a("mo",{attrs:{stretchy:"false"}},[t._v("(")]),a("mi",[t._v("n")]),a("mo",{attrs:{separator:"true"}},[t._v(",")]),a("mi",[t._v("p")]),a("mo",{attrs:{stretchy:"false"}},[t._v(")")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\kappa(n, p)")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"1em","vertical-align":"-0.25em"}}),a("span",{staticClass:"mord mathdefault"},[t._v("κ")]),a("span",{staticClass:"mopen"},[t._v("(")]),a("span",{staticClass:"mord mathdefault"},[t._v("n")]),a("span",{staticClass:"mpunct"},[t._v(",")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.16666666666666666em"}}),a("span",{staticClass:"mord mathdefault"},[t._v("p")]),a("span",{staticClass:"mclose"},[t._v(")")])])])])]),t._v("：并行执行带来的通信时间")],1)]),t._v(" "),a("p",[t._v("比较显然，公式的意思是：并行算法的时间为："),a("code",[t._v("串行时间+并行部分/p+通行时间")])]),t._v(" "),a("p",[a("strong",[t._v("这个公式一定要记住，后面的推导都是基于这个公式！")])]),t._v(" "),a("hr"),t._v(" "),a("section",[a("eqn",[a("span",{staticClass:"katex-display"},[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[a("semantics",[a("mrow",[a("msub",[a("mi",[t._v("E")]),a("mi",[t._v("p")])],1),a("mo",[t._v("=")]),a("mfrac",[a("msub",[a("mi",[t._v("S")]),a("mi",[t._v("p")])],1),a("mi",[t._v("p")])],1)],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("E_p=\\frac{S_p}{p}")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"0.969438em","vertical-align":"-0.286108em"}}),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.05764em"}},[t._v("E")]),a("span",{staticClass:"msupsub"},[a("span",{staticClass:"vlist-t vlist-t2"},[a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"0.15139200000000003em"}},[a("span",{staticStyle:{top:"-2.5500000000000003em","margin-left":"-0.05764em","margin-right":"0.05em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),a("span",{staticClass:"sizing reset-size6 size3 mtight"},[a("span",{staticClass:"mord mathdefault mtight"},[t._v("p")])])])]),a("span",{staticClass:"vlist-s"},[t._v("​")])]),a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"0.286108em"}},[a("span")])])])])]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),a("span",{staticClass:"mrel"},[t._v("=")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"2.2407700000000004em","vertical-align":"-0.8804400000000001em"}}),a("span",{staticClass:"mord"},[a("span",{staticClass:"mopen nulldelimiter"}),a("span",{staticClass:"mfrac"},[a("span",{staticClass:"vlist-t vlist-t2"},[a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"1.36033em"}},[a("span",{staticStyle:{top:"-2.314em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathdefault"},[t._v("p")])])]),a("span",{staticStyle:{top:"-3.23em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),a("span",{staticClass:"frac-line",staticStyle:{"border-bottom-width":"0.04em"}})]),a("span",{staticStyle:{top:"-3.677em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.05764em"}},[t._v("S")]),a("span",{staticClass:"msupsub"},[a("span",{staticClass:"vlist-t vlist-t2"},[a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"0.15139200000000003em"}},[a("span",{staticStyle:{top:"-2.5500000000000003em","margin-left":"-0.05764em","margin-right":"0.05em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),a("span",{staticClass:"sizing reset-size6 size3 mtight"},[a("span",{staticClass:"mord mathdefault mtight"},[t._v("p")])])])]),a("span",{staticClass:"vlist-s"},[t._v("​")])]),a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"0.286108em"}},[a("span")])])])])])])])]),a("span",{staticClass:"vlist-s"},[t._v("​")])]),a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"0.8804400000000001em"}},[a("span")])])])]),a("span",{staticClass:"mclose nulldelimiter"})])])])])])])],1),a("ul",[a("li",[a("eq",[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[a("semantics",[a("mrow",[a("msub",[a("mi",[t._v("E")]),a("mi",[t._v("p")])],1)],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("E_p")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"0.969438em","vertical-align":"-0.286108em"}}),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.05764em"}},[t._v("E")]),a("span",{staticClass:"msupsub"},[a("span",{staticClass:"vlist-t vlist-t2"},[a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"0.15139200000000003em"}},[a("span",{staticStyle:{top:"-2.5500000000000003em","margin-left":"-0.05764em","margin-right":"0.05em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),a("span",{staticClass:"sizing reset-size6 size3 mtight"},[a("span",{staticClass:"mord mathdefault mtight"},[t._v("p")])])])]),a("span",{staticClass:"vlist-s"},[t._v("​")])]),a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"0.286108em"}},[a("span")])])])])])])])])]),t._v(" or "),a("eq",[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[a("semantics",[a("mrow",[a("mi",[t._v("ε")]),a("mo",{attrs:{stretchy:"false"}},[t._v("(")]),a("mi",[t._v("n")]),a("mo",{attrs:{separator:"true"}},[t._v(",")]),a("mi",[t._v("p")]),a("mo",{attrs:{stretchy:"false"}},[t._v(")")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\varepsilon(n, p)")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"1em","vertical-align":"-0.25em"}}),a("span",{staticClass:"mord mathdefault"},[t._v("ε")]),a("span",{staticClass:"mopen"},[t._v("(")]),a("span",{staticClass:"mord mathdefault"},[t._v("n")]),a("span",{staticClass:"mpunct"},[t._v(",")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.16666666666666666em"}}),a("span",{staticClass:"mord mathdefault"},[t._v("p")]),a("span",{staticClass:"mclose"},[t._v(")")])])])])]),t._v("：效率")],1)]),t._v(" "),a("p",[t._v("线性加速比程序的效率为 100%。")]),t._v(" "),a("p",[t._v("将 "),a("eq",[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[a("semantics",[a("mrow",[a("msub",[a("mi",[t._v("S")]),a("mi",[t._v("p")])],1)],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("S_p")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"0.969438em","vertical-align":"-0.286108em"}}),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.05764em"}},[t._v("S")]),a("span",{staticClass:"msupsub"},[a("span",{staticClass:"vlist-t vlist-t2"},[a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"0.15139200000000003em"}},[a("span",{staticStyle:{top:"-2.5500000000000003em","margin-left":"-0.05764em","margin-right":"0.05em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),a("span",{staticClass:"sizing reset-size6 size3 mtight"},[a("span",{staticClass:"mord mathdefault mtight"},[t._v("p")])])])]),a("span",{staticClass:"vlist-s"},[t._v("​")])]),a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"0.286108em"}},[a("span")])])])])])])])])]),t._v(" 代入即有：")],1),t._v(" "),a("section",[a("eqn",[a("span",{staticClass:"katex-display"},[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[a("semantics",[a("mrow",[a("mi",[t._v("ε")]),a("mo",{attrs:{stretchy:"false"}},[t._v("(")]),a("mi",[t._v("n")]),a("mo",{attrs:{separator:"true"}},[t._v(",")]),a("mi",[t._v("p")]),a("mo",{attrs:{stretchy:"false"}},[t._v(")")]),a("mo",[t._v("≤")]),a("mfrac",[a("mrow",[a("mi",[t._v("σ")]),a("mo",{attrs:{stretchy:"false"}},[t._v("(")]),a("mi",[t._v("n")]),a("mo",{attrs:{stretchy:"false"}},[t._v(")")]),a("mo",[t._v("+")]),a("mi",[t._v("φ")]),a("mo",{attrs:{stretchy:"false"}},[t._v("(")]),a("mi",[t._v("n")]),a("mo",{attrs:{stretchy:"false"}},[t._v(")")])],1),a("mrow",[a("mi",[t._v("p")]),a("mi",[t._v("σ")]),a("mo",{attrs:{stretchy:"false"}},[t._v("(")]),a("mi",[t._v("n")]),a("mo",{attrs:{stretchy:"false"}},[t._v(")")]),a("mo",[t._v("+")]),a("mi",[t._v("φ")]),a("mo",{attrs:{stretchy:"false"}},[t._v("(")]),a("mi",[t._v("n")]),a("mo",{attrs:{stretchy:"false"}},[t._v(")")]),a("mo",[t._v("+")]),a("mi",[t._v("p")]),a("mi",[t._v("κ")]),a("mo",{attrs:{stretchy:"false"}},[t._v("(")]),a("mi",[t._v("n")]),a("mo",{attrs:{separator:"true"}},[t._v(",")]),a("mi",[t._v("p")]),a("mo",{attrs:{stretchy:"false"}},[t._v(")")])],1)],1)],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\varepsilon(n, p) \\leq \\frac{\\sigma(n)+\\varphi(n)}{p\\sigma(n)+\\varphi(n)+p\\kappa(n, p)}")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"1em","vertical-align":"-0.25em"}}),a("span",{staticClass:"mord mathdefault"},[t._v("ε")]),a("span",{staticClass:"mopen"},[t._v("(")]),a("span",{staticClass:"mord mathdefault"},[t._v("n")]),a("span",{staticClass:"mpunct"},[t._v(",")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.16666666666666666em"}}),a("span",{staticClass:"mord mathdefault"},[t._v("p")]),a("span",{staticClass:"mclose"},[t._v(")")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),a("span",{staticClass:"mrel"},[t._v("≤")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"2.363em","vertical-align":"-0.936em"}}),a("span",{staticClass:"mord"},[a("span",{staticClass:"mopen nulldelimiter"}),a("span",{staticClass:"mfrac"},[a("span",{staticClass:"vlist-t vlist-t2"},[a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"1.427em"}},[a("span",{staticStyle:{top:"-2.314em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathdefault"},[t._v("p")]),a("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.03588em"}},[t._v("σ")]),a("span",{staticClass:"mopen"},[t._v("(")]),a("span",{staticClass:"mord mathdefault"},[t._v("n")]),a("span",{staticClass:"mclose"},[t._v(")")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),a("span",{staticClass:"mbin"},[t._v("+")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),a("span",{staticClass:"mord mathdefault"},[t._v("φ")]),a("span",{staticClass:"mopen"},[t._v("(")]),a("span",{staticClass:"mord mathdefault"},[t._v("n")]),a("span",{staticClass:"mclose"},[t._v(")")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),a("span",{staticClass:"mbin"},[t._v("+")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),a("span",{staticClass:"mord mathdefault"},[t._v("p")]),a("span",{staticClass:"mord mathdefault"},[t._v("κ")]),a("span",{staticClass:"mopen"},[t._v("(")]),a("span",{staticClass:"mord mathdefault"},[t._v("n")]),a("span",{staticClass:"mpunct"},[t._v(",")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.16666666666666666em"}}),a("span",{staticClass:"mord mathdefault"},[t._v("p")]),a("span",{staticClass:"mclose"},[t._v(")")])])]),a("span",{staticStyle:{top:"-3.23em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),a("span",{staticClass:"frac-line",staticStyle:{"border-bottom-width":"0.04em"}})]),a("span",{staticStyle:{top:"-3.677em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.03588em"}},[t._v("σ")]),a("span",{staticClass:"mopen"},[t._v("(")]),a("span",{staticClass:"mord mathdefault"},[t._v("n")]),a("span",{staticClass:"mclose"},[t._v(")")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),a("span",{staticClass:"mbin"},[t._v("+")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),a("span",{staticClass:"mord mathdefault"},[t._v("φ")]),a("span",{staticClass:"mopen"},[t._v("(")]),a("span",{staticClass:"mord mathdefault"},[t._v("n")]),a("span",{staticClass:"mclose"},[t._v(")")])])])]),a("span",{staticClass:"vlist-s"},[t._v("​")])]),a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"0.936em"}},[a("span")])])])]),a("span",{staticClass:"mclose nulldelimiter"})])])])])])])],1),a("p",[t._v("可以推出 "),a("eq",[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[a("semantics",[a("mrow",[a("mn",[t._v("0")]),a("mo",[t._v("≤")]),a("mi",[t._v("ε")]),a("mo",{attrs:{stretchy:"false"}},[t._v("(")]),a("mi",[t._v("n")]),a("mo",{attrs:{separator:"true"}},[t._v(",")]),a("mi",[t._v("p")]),a("mo",{attrs:{stretchy:"false"}},[t._v(")")]),a("mo",[t._v("≤")]),a("mn",[t._v("1")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("0 \\leq \\varepsilon(n, p) \\leq 1")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"0.78041em","vertical-align":"-0.13597em"}}),a("span",{staticClass:"mord"},[t._v("0")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),a("span",{staticClass:"mrel"},[t._v("≤")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"1em","vertical-align":"-0.25em"}}),a("span",{staticClass:"mord mathdefault"},[t._v("ε")]),a("span",{staticClass:"mopen"},[t._v("(")]),a("span",{staticClass:"mord mathdefault"},[t._v("n")]),a("span",{staticClass:"mpunct"},[t._v(",")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.16666666666666666em"}}),a("span",{staticClass:"mord mathdefault"},[t._v("p")]),a("span",{staticClass:"mclose"},[t._v(")")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),a("span",{staticClass:"mrel"},[t._v("≤")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"0.64444em","vertical-align":"0em"}}),a("span",{staticClass:"mord"},[t._v("1")])])])])]),t._v("。")],1),t._v(" "),a("h4",{attrs:{id:"amdahl-定律"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#amdahl-定律"}},[t._v("#")]),t._v(" Amdahl 定律")]),t._v(" "),a("p",[t._v("Amdahl 定律和 Gustafson-Barsis 定律都把通信成本放缩掉了。两个求的都是加速比，但是注意条件不一样（一个是 "),a("eq",[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[a("semantics",[a("mrow",[a("mi",[t._v("f")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("f")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"0.8888799999999999em","vertical-align":"-0.19444em"}}),a("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.10764em"}},[t._v("f")])])])])]),t._v(" 一个是 "),a("eq",[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[a("semantics",[a("mrow",[a("mi",[t._v("s")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("s")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"0.43056em","vertical-align":"0em"}}),a("span",{staticClass:"mord mathdefault"},[t._v("s")])])])])]),t._v("）")],1),t._v(" "),a("section",[a("eqn",[a("span",{staticClass:"katex-display"},[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[a("semantics",[a("mrow",[a("mi",[t._v("ψ")]),a("mo",{attrs:{stretchy:"false"}},[t._v("(")]),a("mi",[t._v("n")]),a("mo",{attrs:{separator:"true"}},[t._v(",")]),a("mi",[t._v("p")]),a("mo",{attrs:{stretchy:"false"}},[t._v(")")]),a("mo",[t._v("≤")]),a("mfrac",[a("mrow",[a("mi",[t._v("σ")]),a("mo",{attrs:{stretchy:"false"}},[t._v("(")]),a("mi",[t._v("n")]),a("mo",{attrs:{stretchy:"false"}},[t._v(")")]),a("mo",[t._v("+")]),a("mi",[t._v("φ")]),a("mo",{attrs:{stretchy:"false"}},[t._v("(")]),a("mi",[t._v("n")]),a("mo",{attrs:{stretchy:"false"}},[t._v(")")])],1),a("mrow",[a("mi",[t._v("σ")]),a("mo",{attrs:{stretchy:"false"}},[t._v("(")]),a("mi",[t._v("n")]),a("mo",{attrs:{stretchy:"false"}},[t._v(")")]),a("mo",[t._v("+")]),a("mi",[t._v("φ")]),a("mo",{attrs:{stretchy:"false"}},[t._v("(")]),a("mi",[t._v("n")]),a("mo",{attrs:{stretchy:"false"}},[t._v(")")]),a("mi",{attrs:{mathvariant:"normal"}},[t._v("/")]),a("mi",[t._v("p")]),a("mo",[t._v("+")]),a("mi",[t._v("κ")]),a("mo",{attrs:{stretchy:"false"}},[t._v("(")]),a("mi",[t._v("n")]),a("mo",{attrs:{separator:"true"}},[t._v(",")]),a("mi",[t._v("p")]),a("mo",{attrs:{stretchy:"false"}},[t._v(")")])],1)],1)],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\psi(n, p) \\leq \\frac{\\sigma(n)+\\varphi(n)}{\\sigma(n)+\\varphi(n) / p+\\kappa(n, p)}")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"1em","vertical-align":"-0.25em"}}),a("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.03588em"}},[t._v("ψ")]),a("span",{staticClass:"mopen"},[t._v("(")]),a("span",{staticClass:"mord mathdefault"},[t._v("n")]),a("span",{staticClass:"mpunct"},[t._v(",")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.16666666666666666em"}}),a("span",{staticClass:"mord mathdefault"},[t._v("p")]),a("span",{staticClass:"mclose"},[t._v(")")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),a("span",{staticClass:"mrel"},[t._v("≤")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"2.363em","vertical-align":"-0.936em"}}),a("span",{staticClass:"mord"},[a("span",{staticClass:"mopen nulldelimiter"}),a("span",{staticClass:"mfrac"},[a("span",{staticClass:"vlist-t vlist-t2"},[a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"1.427em"}},[a("span",{staticStyle:{top:"-2.314em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.03588em"}},[t._v("σ")]),a("span",{staticClass:"mopen"},[t._v("(")]),a("span",{staticClass:"mord mathdefault"},[t._v("n")]),a("span",{staticClass:"mclose"},[t._v(")")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),a("span",{staticClass:"mbin"},[t._v("+")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),a("span",{staticClass:"mord mathdefault"},[t._v("φ")]),a("span",{staticClass:"mopen"},[t._v("(")]),a("span",{staticClass:"mord mathdefault"},[t._v("n")]),a("span",{staticClass:"mclose"},[t._v(")")]),a("span",{staticClass:"mord"},[t._v("/")]),a("span",{staticClass:"mord mathdefault"},[t._v("p")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),a("span",{staticClass:"mbin"},[t._v("+")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),a("span",{staticClass:"mord mathdefault"},[t._v("κ")]),a("span",{staticClass:"mopen"},[t._v("(")]),a("span",{staticClass:"mord mathdefault"},[t._v("n")]),a("span",{staticClass:"mpunct"},[t._v(",")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.16666666666666666em"}}),a("span",{staticClass:"mord mathdefault"},[t._v("p")]),a("span",{staticClass:"mclose"},[t._v(")")])])]),a("span",{staticStyle:{top:"-3.23em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),a("span",{staticClass:"frac-line",staticStyle:{"border-bottom-width":"0.04em"}})]),a("span",{staticStyle:{top:"-3.677em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.03588em"}},[t._v("σ")]),a("span",{staticClass:"mopen"},[t._v("(")]),a("span",{staticClass:"mord mathdefault"},[t._v("n")]),a("span",{staticClass:"mclose"},[t._v(")")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),a("span",{staticClass:"mbin"},[t._v("+")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),a("span",{staticClass:"mord mathdefault"},[t._v("φ")]),a("span",{staticClass:"mopen"},[t._v("(")]),a("span",{staticClass:"mord mathdefault"},[t._v("n")]),a("span",{staticClass:"mclose"},[t._v(")")])])])]),a("span",{staticClass:"vlist-s"},[t._v("​")])]),a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"0.936em"}},[a("span")])])])]),a("span",{staticClass:"mclose nulldelimiter"})])])])])])])],1),a("p",[t._v("令 "),a("eq",[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[a("semantics",[a("mrow",[a("mi",[t._v("f")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("f")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"0.8888799999999999em","vertical-align":"-0.19444em"}}),a("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.10764em"}},[t._v("f")])])])])]),t._v(" 为串行部分占比（占改进之前的比），即 "),a("eq",[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[a("semantics",[a("mrow",[a("mi",[t._v("f")]),a("mo",[t._v("=")]),a("mfrac",[a("mrow",[a("mi",[t._v("σ")]),a("mo",{attrs:{stretchy:"false"}},[t._v("(")]),a("mi",[t._v("n")]),a("mo",{attrs:{stretchy:"false"}},[t._v(")")])],1),a("mrow",[a("mi",[t._v("σ")]),a("mo",{attrs:{stretchy:"false"}},[t._v("(")]),a("mi",[t._v("n")]),a("mo",{attrs:{stretchy:"false"}},[t._v(")")]),a("mo",[t._v("+")]),a("mi",[t._v("φ")]),a("mo",{attrs:{stretchy:"false"}},[t._v("(")]),a("mi",[t._v("n")]),a("mo",{attrs:{stretchy:"false"}},[t._v(")")])],1)],1)],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("f=\\frac{\\sigma(n)}{\\sigma(n)+\\varphi(n)}")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"0.8888799999999999em","vertical-align":"-0.19444em"}}),a("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.10764em"}},[t._v("f")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),a("span",{staticClass:"mrel"},[t._v("=")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"1.53em","vertical-align":"-0.52em"}}),a("span",{staticClass:"mord"},[a("span",{staticClass:"mopen nulldelimiter"}),a("span",{staticClass:"mfrac"},[a("span",{staticClass:"vlist-t vlist-t2"},[a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"1.01em"}},[a("span",{staticStyle:{top:"-2.655em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),a("span",{staticClass:"sizing reset-size6 size3 mtight"},[a("span",{staticClass:"mord mtight"},[a("span",{staticClass:"mord mathdefault mtight",staticStyle:{"margin-right":"0.03588em"}},[t._v("σ")]),a("span",{staticClass:"mopen mtight"},[t._v("(")]),a("span",{staticClass:"mord mathdefault mtight"},[t._v("n")]),a("span",{staticClass:"mclose mtight"},[t._v(")")]),a("span",{staticClass:"mbin mtight"},[t._v("+")]),a("span",{staticClass:"mord mathdefault mtight"},[t._v("φ")]),a("span",{staticClass:"mopen mtight"},[t._v("(")]),a("span",{staticClass:"mord mathdefault mtight"},[t._v("n")]),a("span",{staticClass:"mclose mtight"},[t._v(")")])])])]),a("span",{staticStyle:{top:"-3.23em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),a("span",{staticClass:"frac-line",staticStyle:{"border-bottom-width":"0.04em"}})]),a("span",{staticStyle:{top:"-3.485em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),a("span",{staticClass:"sizing reset-size6 size3 mtight"},[a("span",{staticClass:"mord mtight"},[a("span",{staticClass:"mord mathdefault mtight",staticStyle:{"margin-right":"0.03588em"}},[t._v("σ")]),a("span",{staticClass:"mopen mtight"},[t._v("(")]),a("span",{staticClass:"mord mathdefault mtight"},[t._v("n")]),a("span",{staticClass:"mclose mtight"},[t._v(")")])])])])]),a("span",{staticClass:"vlist-s"},[t._v("​")])]),a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"0.52em"}},[a("span")])])])]),a("span",{staticClass:"mclose nulldelimiter"})])])])])]),t._v("，有：")],1),t._v(" "),a("section",[a("eqn",[a("span",{staticClass:"katex-display"},[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[a("semantics",[a("mrow",[a("mi",[t._v("ψ")]),a("mo",[t._v("≤")]),a("mfrac",[a("mn",[t._v("1")]),a("mrow",[a("mi",[t._v("f")]),a("mo",[t._v("+")]),a("mo",{attrs:{stretchy:"false"}},[t._v("(")]),a("mn",[t._v("1")]),a("mo",[t._v("−")]),a("mi",[t._v("f")]),a("mo",{attrs:{stretchy:"false"}},[t._v(")")]),a("mi",{attrs:{mathvariant:"normal"}},[t._v("/")]),a("mi",[t._v("p")])],1)],1)],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\psi \\leq \\frac{1}{f+(1-f)/p}")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"0.8888799999999999em","vertical-align":"-0.19444em"}}),a("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.03588em"}},[t._v("ψ")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),a("span",{staticClass:"mrel"},[t._v("≤")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"2.25744em","vertical-align":"-0.936em"}}),a("span",{staticClass:"mord"},[a("span",{staticClass:"mopen nulldelimiter"}),a("span",{staticClass:"mfrac"},[a("span",{staticClass:"vlist-t vlist-t2"},[a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"1.32144em"}},[a("span",{staticStyle:{top:"-2.314em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.10764em"}},[t._v("f")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),a("span",{staticClass:"mbin"},[t._v("+")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),a("span",{staticClass:"mopen"},[t._v("(")]),a("span",{staticClass:"mord"},[t._v("1")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),a("span",{staticClass:"mbin"},[t._v("−")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),a("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.10764em"}},[t._v("f")]),a("span",{staticClass:"mclose"},[t._v(")")]),a("span",{staticClass:"mord"},[t._v("/")]),a("span",{staticClass:"mord mathdefault"},[t._v("p")])])]),a("span",{staticStyle:{top:"-3.23em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),a("span",{staticClass:"frac-line",staticStyle:{"border-bottom-width":"0.04em"}})]),a("span",{staticStyle:{top:"-3.677em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord"},[t._v("1")])])])]),a("span",{staticClass:"vlist-s"},[t._v("​")])]),a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"0.936em"}},[a("span")])])])]),a("span",{staticClass:"mclose nulldelimiter"})])])])])])])],1),a("p",[a("strong",[t._v("加速比不大于“串行占比+p倍并行占比”的反比")])]),t._v(" "),a("hr"),t._v(" "),a("blockquote",[a("p",[t._v("例题：95% of a program's execution time occurs inside a loop that can be executed in parallel. What is the maximum speedup we should expect from a parallel version of the program executing on 8 CPUs?")])]),t._v(" "),a("p",[t._v("注意题目说的是串行在改进前需要执行 5% 的时间，这就符合 Amdahl 的条件。答案是 5.9。")]),t._v(" "),a("h4",{attrs:{id:"gustafson-barsis-定律"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#gustafson-barsis-定律"}},[t._v("#")]),t._v(" Gustafson-Barsis 定律")]),t._v(" "),a("p",[t._v("令 "),a("eq",[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[a("semantics",[a("mrow",[a("mi",[t._v("s")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("s")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"0.43056em","vertical-align":"0em"}}),a("span",{staticClass:"mord mathdefault"},[t._v("s")])])])])]),t._v(" 为串行部分占比（占改进之后的比），即 "),a("eq",[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[a("semantics",[a("mrow",[a("mi",[t._v("s")]),a("mo",[t._v("=")]),a("mfrac",[a("mrow",[a("mi",[t._v("σ")]),a("mo",{attrs:{stretchy:"false"}},[t._v("(")]),a("mi",[t._v("n")]),a("mo",{attrs:{stretchy:"false"}},[t._v(")")])],1),a("mrow",[a("mi",[t._v("σ")]),a("mo",{attrs:{stretchy:"false"}},[t._v("(")]),a("mi",[t._v("n")]),a("mo",{attrs:{stretchy:"false"}},[t._v(")")]),a("mo",[t._v("+")]),a("mi",[t._v("φ")]),a("mo",{attrs:{stretchy:"false"}},[t._v("(")]),a("mi",[t._v("n")]),a("mo",{attrs:{stretchy:"false"}},[t._v(")")]),a("mi",{attrs:{mathvariant:"normal"}},[t._v("/")]),a("mi",[t._v("p")])],1)],1)],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("s = \\frac{\\sigma(n)}{\\sigma(n)+\\varphi(n)/p}")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"0.43056em","vertical-align":"0em"}}),a("span",{staticClass:"mord mathdefault"},[t._v("s")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),a("span",{staticClass:"mrel"},[t._v("=")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"1.53em","vertical-align":"-0.52em"}}),a("span",{staticClass:"mord"},[a("span",{staticClass:"mopen nulldelimiter"}),a("span",{staticClass:"mfrac"},[a("span",{staticClass:"vlist-t vlist-t2"},[a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"1.01em"}},[a("span",{staticStyle:{top:"-2.655em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),a("span",{staticClass:"sizing reset-size6 size3 mtight"},[a("span",{staticClass:"mord mtight"},[a("span",{staticClass:"mord mathdefault mtight",staticStyle:{"margin-right":"0.03588em"}},[t._v("σ")]),a("span",{staticClass:"mopen mtight"},[t._v("(")]),a("span",{staticClass:"mord mathdefault mtight"},[t._v("n")]),a("span",{staticClass:"mclose mtight"},[t._v(")")]),a("span",{staticClass:"mbin mtight"},[t._v("+")]),a("span",{staticClass:"mord mathdefault mtight"},[t._v("φ")]),a("span",{staticClass:"mopen mtight"},[t._v("(")]),a("span",{staticClass:"mord mathdefault mtight"},[t._v("n")]),a("span",{staticClass:"mclose mtight"},[t._v(")")]),a("span",{staticClass:"mord mtight"},[t._v("/")]),a("span",{staticClass:"mord mathdefault mtight"},[t._v("p")])])])]),a("span",{staticStyle:{top:"-3.23em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),a("span",{staticClass:"frac-line",staticStyle:{"border-bottom-width":"0.04em"}})]),a("span",{staticStyle:{top:"-3.485em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),a("span",{staticClass:"sizing reset-size6 size3 mtight"},[a("span",{staticClass:"mord mtight"},[a("span",{staticClass:"mord mathdefault mtight",staticStyle:{"margin-right":"0.03588em"}},[t._v("σ")]),a("span",{staticClass:"mopen mtight"},[t._v("(")]),a("span",{staticClass:"mord mathdefault mtight"},[t._v("n")]),a("span",{staticClass:"mclose mtight"},[t._v(")")])])])])]),a("span",{staticClass:"vlist-s"},[t._v("​")])]),a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"0.52em"}},[a("span")])])])]),a("span",{staticClass:"mclose nulldelimiter"})])])])])]),t._v("，有：")],1),t._v(" "),a("section",[a("eqn",[a("span",{staticClass:"katex-display"},[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[a("semantics",[a("mrow",[a("mi",[t._v("ψ")]),a("mo",[t._v("≤")]),a("mi",[t._v("p")]),a("mo",[t._v("+")]),a("mo",{attrs:{stretchy:"false"}},[t._v("(")]),a("mn",[t._v("1")]),a("mo",[t._v("−")]),a("mi",[t._v("p")]),a("mo",{attrs:{stretchy:"false"}},[t._v(")")]),a("mi",[t._v("s")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\psi \\leq p + (1-p)s")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"0.8888799999999999em","vertical-align":"-0.19444em"}}),a("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.03588em"}},[t._v("ψ")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),a("span",{staticClass:"mrel"},[t._v("≤")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"0.7777700000000001em","vertical-align":"-0.19444em"}}),a("span",{staticClass:"mord mathdefault"},[t._v("p")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),a("span",{staticClass:"mbin"},[t._v("+")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}})]),a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"1em","vertical-align":"-0.25em"}}),a("span",{staticClass:"mopen"},[t._v("(")]),a("span",{staticClass:"mord"},[t._v("1")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),a("span",{staticClass:"mbin"},[t._v("−")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}})]),a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"1em","vertical-align":"-0.25em"}}),a("span",{staticClass:"mord mathdefault"},[t._v("p")]),a("span",{staticClass:"mclose"},[t._v(")")]),a("span",{staticClass:"mord mathdefault"},[t._v("s")])])])])])])],1),a("p",[t._v("可以看到，如果 "),a("eq",[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[a("semantics",[a("mrow",[a("mi",[t._v("s")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("s")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"0.43056em","vertical-align":"0em"}}),a("span",{staticClass:"mord mathdefault"},[t._v("s")])])])])]),t._v(" 小，"),a("eq",[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[a("semantics",[a("mrow",[a("mi",[t._v("ψ")]),a("mo",[t._v("≈")]),a("mi",[t._v("p")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\psi \\approx p")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"0.8888799999999999em","vertical-align":"-0.19444em"}}),a("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.03588em"}},[t._v("ψ")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),a("span",{staticClass:"mrel"},[t._v("≈")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"0.625em","vertical-align":"-0.19444em"}}),a("span",{staticClass:"mord mathdefault"},[t._v("p")])])])])]),t._v("，并行效率很好。")],1),t._v(" "),a("hr"),t._v(" "),a("blockquote",[a("p",[t._v("例题：An application running on 10 processors spends 3% of its time in serial code. What is the scaled speedup of the application?")])]),t._v(" "),a("p",[t._v("注意题目说的是串行代码在改进后需要执行 3% 的时间，这就符合 Gustafson-Barsis 的条件。答案是 9.73。")]),t._v(" "),a("h4",{attrs:{id:"karp-flatt-metric-指标"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#karp-flatt-metric-指标"}},[t._v("#")]),t._v(" Karp-Flatt Metric 指标")]),t._v(" "),a("p",[t._v("Amdahl 和 Gustafson-Barsis 都忽略了通信成本，会高估放大比。Karp-Flatt 从另一个角度来进行分析。")]),t._v(" "),a("p",[t._v("但是这个公式起手就很怪异。")]),t._v(" "),a("p",[t._v("令"),a("eq",[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[a("semantics",[a("mrow",[a("mi",[t._v("e")]),a("mo",[t._v("=")]),a("mfrac",[a("mrow",[a("mi",[t._v("σ")]),a("mo",{attrs:{stretchy:"false"}},[t._v("(")]),a("mi",[t._v("n")]),a("mo",{attrs:{stretchy:"false"}},[t._v(")")]),a("mo",[t._v("+")]),a("mi",[t._v("κ")]),a("mo",{attrs:{stretchy:"false"}},[t._v("(")]),a("mi",[t._v("n")]),a("mo",{attrs:{separator:"true"}},[t._v(",")]),a("mi",[t._v("p")]),a("mo",{attrs:{stretchy:"false"}},[t._v(")")])],1),a("mrow",[a("mi",[t._v("σ")]),a("mo",{attrs:{stretchy:"false"}},[t._v("(")]),a("mi",[t._v("n")]),a("mo",{attrs:{stretchy:"false"}},[t._v(")")]),a("mo",[t._v("+")]),a("mi",[t._v("φ")]),a("mo",{attrs:{stretchy:"false"}},[t._v("(")]),a("mi",[t._v("n")]),a("mo",{attrs:{stretchy:"false"}},[t._v(")")])],1)],1)],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("e = \\frac{\\sigma(n) + \\kappa(n,p)}{\\sigma(n)+\\varphi(n)}")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"0.43056em","vertical-align":"0em"}}),a("span",{staticClass:"mord mathdefault"},[t._v("e")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),a("span",{staticClass:"mrel"},[t._v("=")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"1.53em","vertical-align":"-0.52em"}}),a("span",{staticClass:"mord"},[a("span",{staticClass:"mopen nulldelimiter"}),a("span",{staticClass:"mfrac"},[a("span",{staticClass:"vlist-t vlist-t2"},[a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"1.01em"}},[a("span",{staticStyle:{top:"-2.655em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),a("span",{staticClass:"sizing reset-size6 size3 mtight"},[a("span",{staticClass:"mord mtight"},[a("span",{staticClass:"mord mathdefault mtight",staticStyle:{"margin-right":"0.03588em"}},[t._v("σ")]),a("span",{staticClass:"mopen mtight"},[t._v("(")]),a("span",{staticClass:"mord mathdefault mtight"},[t._v("n")]),a("span",{staticClass:"mclose mtight"},[t._v(")")]),a("span",{staticClass:"mbin mtight"},[t._v("+")]),a("span",{staticClass:"mord mathdefault mtight"},[t._v("φ")]),a("span",{staticClass:"mopen mtight"},[t._v("(")]),a("span",{staticClass:"mord mathdefault mtight"},[t._v("n")]),a("span",{staticClass:"mclose mtight"},[t._v(")")])])])]),a("span",{staticStyle:{top:"-3.23em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),a("span",{staticClass:"frac-line",staticStyle:{"border-bottom-width":"0.04em"}})]),a("span",{staticStyle:{top:"-3.485em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),a("span",{staticClass:"sizing reset-size6 size3 mtight"},[a("span",{staticClass:"mord mtight"},[a("span",{staticClass:"mord mathdefault mtight",staticStyle:{"margin-right":"0.03588em"}},[t._v("σ")]),a("span",{staticClass:"mopen mtight"},[t._v("(")]),a("span",{staticClass:"mord mathdefault mtight"},[t._v("n")]),a("span",{staticClass:"mclose mtight"},[t._v(")")]),a("span",{staticClass:"mbin mtight"},[t._v("+")]),a("span",{staticClass:"mord mathdefault mtight"},[t._v("κ")]),a("span",{staticClass:"mopen mtight"},[t._v("(")]),a("span",{staticClass:"mord mathdefault mtight"},[t._v("n")]),a("span",{staticClass:"mpunct mtight"},[t._v(",")]),a("span",{staticClass:"mord mathdefault mtight"},[t._v("p")]),a("span",{staticClass:"mclose mtight"},[t._v(")")])])])])]),a("span",{staticClass:"vlist-s"},[t._v("​")])]),a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"0.52em"}},[a("span")])])])]),a("span",{staticClass:"mclose nulldelimiter"})])])])])])],1),t._v(" "),a("p",[a("code",[t._v("串行时间 + 通信时间 / 串行时间 + 可并行的时间")]),t._v("？")]),t._v(" "),a("p",[t._v("能够推出")]),t._v(" "),a("section",[a("eqn",[a("span",{staticClass:"katex-display"},[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[a("semantics",[a("mrow",[a("mi",[t._v("e")]),a("mo",[t._v("=")]),a("mfrac",[a("mrow",[a("mn",[t._v("1")]),a("mi",{attrs:{mathvariant:"normal"}},[t._v("/")]),a("mi",[t._v("ψ")]),a("mo",[t._v("−")]),a("mn",[t._v("1")]),a("mi",{attrs:{mathvariant:"normal"}},[t._v("/")]),a("mi",[t._v("p")])],1),a("mrow",[a("mn",[t._v("1")]),a("mo",[t._v("−")]),a("mn",[t._v("1")]),a("mi",{attrs:{mathvariant:"normal"}},[t._v("/")]),a("mi",[t._v("p")])],1)],1)],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("e = \\frac{1/\\psi - 1/p}{1 - 1/p}")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"0.43056em","vertical-align":"0em"}}),a("span",{staticClass:"mord mathdefault"},[t._v("e")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),a("span",{staticClass:"mrel"},[t._v("=")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"2.363em","vertical-align":"-0.936em"}}),a("span",{staticClass:"mord"},[a("span",{staticClass:"mopen nulldelimiter"}),a("span",{staticClass:"mfrac"},[a("span",{staticClass:"vlist-t vlist-t2"},[a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"1.427em"}},[a("span",{staticStyle:{top:"-2.314em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord"},[t._v("1")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),a("span",{staticClass:"mbin"},[t._v("−")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),a("span",{staticClass:"mord"},[t._v("1")]),a("span",{staticClass:"mord"},[t._v("/")]),a("span",{staticClass:"mord mathdefault"},[t._v("p")])])]),a("span",{staticStyle:{top:"-3.23em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),a("span",{staticClass:"frac-line",staticStyle:{"border-bottom-width":"0.04em"}})]),a("span",{staticStyle:{top:"-3.677em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord"},[t._v("1")]),a("span",{staticClass:"mord"},[t._v("/")]),a("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.03588em"}},[t._v("ψ")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),a("span",{staticClass:"mbin"},[t._v("−")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),a("span",{staticClass:"mord"},[t._v("1")]),a("span",{staticClass:"mord"},[t._v("/")]),a("span",{staticClass:"mord mathdefault"},[t._v("p")])])])]),a("span",{staticClass:"vlist-s"},[t._v("​")])]),a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"0.936em"}},[a("span")])])])]),a("span",{staticClass:"mclose nulldelimiter"})])])])])])])],1),a("hr"),t._v(" "),a("p",[t._v("这个公式很奇怪，结合例题我大概看懂了：")]),t._v(" "),a("p",[t._v("结论 1：注意到 "),a("eq",[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[a("semantics",[a("mrow",[a("mi",[t._v("n")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("n")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"0.43056em","vertical-align":"0em"}}),a("span",{staticClass:"mord mathdefault"},[t._v("n")])])])])]),t._v(" 一定的情况下，"),a("code",[t._v("串行时间")]),t._v("、"),a("code",[t._v("可并行的时间")]),t._v(" 是恒定的，所以 "),a("strong",[a("eq",[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[a("semantics",[a("mrow",[a("mi",[t._v("e")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("e")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"0.43056em","vertical-align":"0em"}}),a("span",{staticClass:"mord mathdefault"},[t._v("e")])])])])]),t._v(" 和 "),a("code",[t._v("通信时间")]),t._v(" 的增长趋势是一样的")],1),t._v("。"),a("br"),t._v("\n即，"),a("strong",[t._v("在不同的 "),a("eq",[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[a("semantics",[a("mrow",[a("mi",[t._v("p")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("p")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"0.625em","vertical-align":"-0.19444em"}}),a("span",{staticClass:"mord mathdefault"},[t._v("p")])])])])]),t._v(" 下，如果 "),a("eq",[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[a("semantics",[a("mrow",[a("mi",[t._v("e")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("e")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"0.43056em","vertical-align":"0em"}}),a("span",{staticClass:"mord mathdefault"},[t._v("e")])])])])]),t._v(" 恒定，说明通信时间恒定；"),a("eq",[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[a("semantics",[a("mrow",[a("mi",[t._v("e")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("e")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"0.43056em","vertical-align":"0em"}}),a("span",{staticClass:"mord mathdefault"},[t._v("e")])])])])]),t._v(" 稳定增长，说明通信时间也稳定增长。")],1)],1),t._v(" "),a("p",[t._v("结论 2：随 "),a("eq",[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[a("semantics",[a("mrow",[a("mi",[t._v("p")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("p")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"0.625em","vertical-align":"-0.19444em"}}),a("span",{staticClass:"mord mathdefault"},[t._v("p")])])])])]),t._v(" 的增大，"),a("eq",[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[a("semantics",[a("mrow",[a("mi",[t._v("e")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("e")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"0.43056em","vertical-align":"0em"}}),a("span",{staticClass:"mord mathdefault"},[t._v("e")])])])])]),t._v(" 不能先增大后减小（只能一直增大/不变或一直减小/不变：一直增大是次线性加速比，而一直减小就是超线性加速比）")],1),t._v(" "),a("hr"),t._v(" "),a("p",[t._v("例 1：")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[a("eq",[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[a("semantics",[a("mrow",[a("mi",[t._v("p")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("p")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"0.625em","vertical-align":"-0.19444em"}}),a("span",{staticClass:"mord mathdefault"},[t._v("p")])])])])])],1),t._v(" "),a("th",[t._v("2")]),t._v(" "),a("th",[t._v("3")]),t._v(" "),a("th",[t._v("4")]),t._v(" "),a("th",[t._v("5")]),t._v(" "),a("th",[t._v("6")]),t._v(" "),a("th",[t._v("7")]),t._v(" "),a("th",[t._v("8")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[a("eq",[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[a("semantics",[a("mrow",[a("mi",[t._v("ψ")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\psi")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"0.8888799999999999em","vertical-align":"-0.19444em"}}),a("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.03588em"}},[t._v("ψ")])])])])])],1),t._v(" "),a("td",[t._v("1.8")]),t._v(" "),a("td",[t._v("2.5")]),t._v(" "),a("td",[t._v("3.1")]),t._v(" "),a("td",[t._v("3.6")]),t._v(" "),a("td",[t._v("4.0")]),t._v(" "),a("td",[t._v("4.4")]),t._v(" "),a("td",[t._v("4.7")])]),t._v(" "),a("tr",[a("td",[t._v("计算可得 "),a("eq",[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[a("semantics",[a("mrow",[a("mi",[t._v("e")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("e")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"0.43056em","vertical-align":"0em"}}),a("span",{staticClass:"mord mathdefault"},[t._v("e")])])])])])],1),t._v(" "),a("td",[t._v("0.1")]),t._v(" "),a("td",[t._v("0.1")]),t._v(" "),a("td",[t._v("0.1")]),t._v(" "),a("td",[t._v("0.1")]),t._v(" "),a("td",[t._v("0.1")]),t._v(" "),a("td",[t._v("0.1")]),t._v(" "),a("td",[t._v("0.1")])])])]),t._v(" "),a("p",[t._v("为什么 8 核的加速比只有 4.7？注意到 "),a("eq",[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[a("semantics",[a("mrow",[a("mi",[t._v("e")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("e")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"0.43056em","vertical-align":"0em"}}),a("span",{staticClass:"mord mathdefault"},[t._v("e")])])])])]),t._v(" 不随 "),a("eq",[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[a("semantics",[a("mrow",[a("mi",[t._v("p")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("p")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"0.625em","vertical-align":"-0.19444em"}}),a("span",{staticClass:"mord mathdefault"},[t._v("p")])])])])]),t._v(" 变化，说明问题不是通信成本，是串行代码耗时太高。")],1),t._v(" "),a("hr"),t._v(" "),a("p",[t._v("例 2：")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[a("eq",[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[a("semantics",[a("mrow",[a("mi",[t._v("p")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("p")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"0.625em","vertical-align":"-0.19444em"}}),a("span",{staticClass:"mord mathdefault"},[t._v("p")])])])])])],1),t._v(" "),a("th",[t._v("2")]),t._v(" "),a("th",[t._v("3")]),t._v(" "),a("th",[t._v("4")]),t._v(" "),a("th",[t._v("5")]),t._v(" "),a("th",[t._v("6")]),t._v(" "),a("th",[t._v("7")]),t._v(" "),a("th",[t._v("8")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[a("eq",[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[a("semantics",[a("mrow",[a("mi",[t._v("ψ")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\psi")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"0.8888799999999999em","vertical-align":"-0.19444em"}}),a("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.03588em"}},[t._v("ψ")])])])])])],1),t._v(" "),a("td",[t._v("1.9")]),t._v(" "),a("td",[t._v("2.6")]),t._v(" "),a("td",[t._v("3.2")]),t._v(" "),a("td",[t._v("3.7")]),t._v(" "),a("td",[t._v("4.1")]),t._v(" "),a("td",[t._v("4.5")]),t._v(" "),a("td",[t._v("4.7")])]),t._v(" "),a("tr",[a("td",[t._v("计算可得 "),a("eq",[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[a("semantics",[a("mrow",[a("mi",[t._v("e")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("e")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"0.43056em","vertical-align":"0em"}}),a("span",{staticClass:"mord mathdefault"},[t._v("e")])])])])])],1),t._v(" "),a("td",[t._v("0.07")]),t._v(" "),a("td",[t._v("0.075")]),t._v(" "),a("td",[t._v("0.08")]),t._v(" "),a("td",[t._v("0.085")]),t._v(" "),a("td",[t._v("0.09")]),t._v(" "),a("td",[t._v("0.095")]),t._v(" "),a("td",[t._v("0.1")])])])]),t._v(" "),a("p",[t._v("为什么 8 核的加速比只有 4.7？注意到 "),a("eq",[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[a("semantics",[a("mrow",[a("mi",[t._v("e")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("e")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"0.43056em","vertical-align":"0em"}}),a("span",{staticClass:"mord mathdefault"},[t._v("e")])])])])]),t._v(" 不随 "),a("eq",[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[a("semantics",[a("mrow",[a("mi",[t._v("p")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("p")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"0.625em","vertical-align":"-0.19444em"}}),a("span",{staticClass:"mord mathdefault"},[t._v("p")])])])])]),t._v(" 变化，说明问题不是通信成本，是串行代码耗时太高。")],1),t._v(" "),a("hr"),t._v(" "),a("p",[t._v("例 3：")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[a("eq",[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[a("semantics",[a("mrow",[a("mi",[t._v("p")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("p")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"0.625em","vertical-align":"-0.19444em"}}),a("span",{staticClass:"mord mathdefault"},[t._v("p")])])])])])],1),t._v(" "),a("th",[t._v("4")]),t._v(" "),a("th",[t._v("8")]),t._v(" "),a("th",[t._v("12")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[a("eq",[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[a("semantics",[a("mrow",[a("mi",[t._v("ψ")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\psi")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"0.8888799999999999em","vertical-align":"-0.19444em"}}),a("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.03588em"}},[t._v("ψ")])])])])])],1),t._v(" "),a("td",[t._v("3.9")]),t._v(" "),a("td",[t._v("6.5")]),t._v(" "),a("td",[t._v("？")])])])]),t._v(" "),a("p",[a("code",[t._v("?")]),t._v(" 处能否为 10？")]),t._v(" "),a("p",[t._v("假设 "),a("code",[t._v("?=10")]),t._v("，算得 "),a("eq",[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[a("semantics",[a("mrow",[a("mi",[t._v("e")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("e")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"0.43056em","vertical-align":"0em"}}),a("span",{staticClass:"mord mathdefault"},[t._v("e")])])])])]),t._v(" 先增大后减小，不可能。")],1),t._v(" "),a("h3",{attrs:{id:"等效率"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#等效率"}},[t._v("#")]),t._v(" 等效率")]),t._v(" "),a("p",[t._v("不会，看 PPT")]),t._v(" "),a("h3",{attrs:{id:"可扩展性"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#可扩展性"}},[t._v("#")]),t._v(" 可扩展性")]),t._v(" "),a("p",[t._v("不会，看 PPT")]),t._v(" "),a("h2",{attrs:{id:"_5-message-passing-programming"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-message-passing-programming"}},[t._v("#")]),t._v(" 5 Message-Passing Programming")]),t._v(" "),a("p",[t._v("MPI 常用函数")]),t._v(" "),a("div",{staticClass:"language-cpp extra-class"},[a("pre",{pre:!0,attrs:{class:"language-cpp"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//First MPI function called by each process")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("MPI_Init")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("argc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("argv"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// First argument is communicator")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Number of processes returned through second argument")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("MPI_Comm_size")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("MPI_COMM_WORLD"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("p"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Process rank (in range 0, 1, …, p-1) returned through second argument")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("MPI_Comm_rank")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("MPI_COMM_WORLD"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Call after all other MPI library calls")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("MPI_Finalize")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("div",{staticClass:"language-cpp extra-class"},[a("pre",{pre:!0,attrs:{class:"language-cpp"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// reduce 操作")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("MPI_Reduce")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("operand"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* addr of 1st reduction element */")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("result"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("       "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* addr of 1st reduction result, only root get result */")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" count"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("          "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* reductions to perform */")]),t._v("\n    MPI_Datatype type"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* type of elements */")]),t._v("\n    MPI_Op "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("operator")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* reduction operator */")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" root"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("           "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* process getting result(s) */")]),t._v("\n    MPI_Comm comm       "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* communicator */")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("MPI_Reduce")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("count"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("global_count"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" MPI_INT"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" MPI_COMM_WORLD"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("div",{staticClass:"language-cpp extra-class"},[a("pre",{pre:!0,attrs:{class:"language-cpp"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Benchmarking the Program")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("double")]),t._v(" elapsed_time"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("MPI_Init")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("argc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("argv"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("MPI_Barrier")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("MPI_COMM_WORLD"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nelapsed_time "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("MPI_Wtime")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("MPI_Reduce")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("…"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nelapsed_time "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("MPI_Wtime")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("h3",{attrs:{id:"附-mpich-中文教程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#附-mpich-中文教程"}},[t._v("#")]),t._v(" 附 MPICH 中文教程")]),t._v(" "),a("p",[t._v("https://scc.ustc.edu.cn/zlsc/cxyy/200910/MPICH/")]),t._v(" "),a("h2",{attrs:{id:"_6-the-sieve-of-eratosthenes"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-the-sieve-of-eratosthenes"}},[t._v("#")]),t._v(" 6 The Sieve of Eratosthenes")]),t._v(" "),a("p",[t._v("因为这部分做了实验，所以不多说算法原理了。")]),t._v(" "),a("div",{staticClass:"language-cpp extra-class"},[a("pre",{pre:!0,attrs:{class:"language-cpp"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("MPI_Bcast")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("buffer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("           "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* Addr of 1st element */")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" count"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("              "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* # elements to broadcast */")]),t._v("\n    MPI_Datatype datatype"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* Type of elements */")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" root"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("               "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* ID of root process */")]),t._v("\n    MPI_Comm comm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("          "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* Communicator */")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("MPI_Bcast")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("k"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" MPI_INT"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" MPI_COMM_WORLD"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("h3",{attrs:{id:"分块算法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#分块算法"}},[t._v("#")]),t._v(" 分块算法")]),t._v(" "),a("p",[t._v("这个问题需要按数据分块。可以使用循环分配，可以按块分配。")]),t._v(" "),a("p",[t._v("使用循环分配，")]),t._v(" "),a("section",[a("eqn",[a("span",{staticClass:"katex-display"},[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[a("semantics",[a("mtable",{attrs:{rowspacing:"0.24999999999999992em",columnalign:"right left",columnspacing:"0em"}},[a("mtr",[a("mtd",[a("mstyle",{attrs:{scriptlevel:"0",displaystyle:"true"}},[a("mrow",[a("mi",[t._v("m")]),a("mi",[t._v("y")]),a("mi",{attrs:{mathvariant:"normal"}},[t._v("_")]),a("mi",[t._v("f")]),a("mi",[t._v("i")]),a("mi",[t._v("r")]),a("mi",[t._v("s")]),a("mi",[t._v("t")]),a("mi",{attrs:{mathvariant:"normal"}},[t._v("_")]),a("mi",[t._v("i")])],1)],1)],1),a("mtd",[a("mstyle",{attrs:{scriptlevel:"0",displaystyle:"true"}},[a("mrow",[a("mrow"),a("mo",[t._v("=")]),a("mi",[t._v("i")]),a("mo",[t._v("∗")]),a("mo",{attrs:{stretchy:"false"}},[t._v("⌊")]),a("mfrac",[a("mi",[t._v("n")]),a("mi",[t._v("p")])],1),a("mo",{attrs:{stretchy:"false"}},[t._v("⌋")]),a("mo",[t._v("+")]),a("mi",[t._v("min")]),a("mo",[t._v("⁡")]),a("mo",{attrs:{stretchy:"false"}},[t._v("(")]),a("mi",[t._v("i")]),a("mo",{attrs:{separator:"true"}},[t._v(",")]),a("mi",[t._v("r")]),a("mo",{attrs:{stretchy:"false"}},[t._v(")")])],1)],1)],1)],1),a("mtr",[a("mtd",[a("mstyle",{attrs:{scriptlevel:"0",displaystyle:"true"}},[a("mrow",[a("mi",[t._v("m")]),a("mi",[t._v("y")]),a("mi",{attrs:{mathvariant:"normal"}},[t._v("_")]),a("mi",[t._v("l")]),a("mi",[t._v("a")]),a("mi",[t._v("s")]),a("mi",[t._v("t")]),a("mi",{attrs:{mathvariant:"normal"}},[t._v("_")]),a("mi",[t._v("i")])],1)],1)],1),a("mtd",[a("mstyle",{attrs:{scriptlevel:"0",displaystyle:"true"}},[a("mrow",[a("mrow"),a("mo",[t._v("=")]),a("mo",{attrs:{stretchy:"false"}},[t._v("(")]),a("mi",[t._v("i")]),a("mo",[t._v("+")]),a("mn",[t._v("1")]),a("mo",{attrs:{stretchy:"false"}},[t._v(")")]),a("mo",[t._v("∗")]),a("mo",{attrs:{stretchy:"false"}},[t._v("⌊")]),a("mfrac",[a("mi",[t._v("n")]),a("mi",[t._v("p")])],1),a("mo",{attrs:{stretchy:"false"}},[t._v("⌋")]),a("mo",[t._v("+")]),a("mi",[t._v("min")]),a("mo",[t._v("⁡")]),a("mo",{attrs:{stretchy:"false"}},[t._v("(")]),a("mi",[t._v("i")]),a("mo",[t._v("+")]),a("mn",[t._v("1")]),a("mo",{attrs:{separator:"true"}},[t._v(",")]),a("mi",[t._v("r")]),a("mo",{attrs:{stretchy:"false"}},[t._v(")")]),a("mo",[t._v("−")]),a("mn",[t._v("1")])],1)],1)],1)],1),a("mtr",[a("mtd",[a("mstyle",{attrs:{scriptlevel:"0",displaystyle:"true"}},[a("mrow",[a("mi",[t._v("c")]),a("mi",[t._v("o")]),a("mi",[t._v("u")]),a("mi",[t._v("n")]),a("mi",[t._v("t")])],1)],1)],1),a("mtd",[a("mstyle",{attrs:{scriptlevel:"0",displaystyle:"true"}},[a("mrow",[a("mrow"),a("mo",[t._v("=")]),a("mi",[t._v("min")]),a("mo",[t._v("⁡")]),a("mo",{attrs:{stretchy:"false"}},[t._v("(")]),a("mo",{attrs:{stretchy:"false"}},[t._v("⌊")]),a("mfrac",[a("mi",[t._v("j")]),a("mrow",[a("mo",{attrs:{stretchy:"false"}},[t._v("⌊")]),a("mi",[t._v("n")]),a("mi",{attrs:{mathvariant:"normal"}},[t._v("/")]),a("mi",[t._v("p")]),a("mo",{attrs:{stretchy:"false"}},[t._v("⌋")]),a("mo",[t._v("+")]),a("mn",[t._v("1")])],1)],1),a("mo",{attrs:{stretchy:"false"}},[t._v("⌋")]),a("mo",{attrs:{separator:"true"}},[t._v(",")]),a("mo",{attrs:{stretchy:"false"}},[t._v("⌊")]),a("mfrac",[a("mrow",[a("mi",[t._v("j")]),a("mo",[t._v("−")]),a("mi",[t._v("r")])],1),a("mrow",[a("mo",{attrs:{stretchy:"false"}},[t._v("⌊")]),a("mi",[t._v("n")]),a("mi",{attrs:{mathvariant:"normal"}},[t._v("/")]),a("mi",[t._v("p")]),a("mo",{attrs:{stretchy:"false"}},[t._v("⌋")])],1)],1),a("mo",{attrs:{stretchy:"false"}},[t._v("⌋")]),a("mo",{attrs:{stretchy:"false"}},[t._v(")")])],1)],1)],1)],1)],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\begin{aligned}\nmy\\_first\\_i &= i * \\lfloor\\frac{n}{p}\\rfloor + \\min(i,r) \\\\\nmy\\_last\\_i &= (i+1)* \\lfloor\\frac{n}{p}\\rfloor + \\min(i+1,r) - 1 \\\\\ncount &= \\min(\\lfloor \\frac{j}{\\lfloor n / p \\rfloor+1}\\rfloor, \\lfloor \\frac{j-r}{\\lfloor n / p \\rfloor}\\rfloor)\n\\end{aligned}")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"7.14852em","vertical-align":"-3.3242599999999998em"}}),a("span",{staticClass:"mord"},[a("span",{staticClass:"mtable"},[a("span",{staticClass:"col-align-r"},[a("span",{staticClass:"vlist-t vlist-t2"},[a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"3.8242600000000007em"}},[a("span",{staticStyle:{top:"-6.0532200000000005em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"3.33652em"}}),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathdefault"},[t._v("m")]),a("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.03588em"}},[t._v("y")]),a("span",{staticClass:"mord",staticStyle:{"margin-right":"0.02778em"}},[t._v("_")]),a("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.10764em"}},[t._v("f")]),a("span",{staticClass:"mord mathdefault"},[t._v("i")]),a("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.02778em"}},[t._v("r")]),a("span",{staticClass:"mord mathdefault"},[t._v("s")]),a("span",{staticClass:"mord mathdefault"},[t._v("t")]),a("span",{staticClass:"mord",staticStyle:{"margin-right":"0.02778em"}},[t._v("_")]),a("span",{staticClass:"mord mathdefault"},[t._v("i")])])]),a("span",{staticStyle:{top:"-3.7652200000000002em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"3.33652em"}}),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathdefault"},[t._v("m")]),a("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.03588em"}},[t._v("y")]),a("span",{staticClass:"mord",staticStyle:{"margin-right":"0.02778em"}},[t._v("_")]),a("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.01968em"}},[t._v("l")]),a("span",{staticClass:"mord mathdefault"},[t._v("a")]),a("span",{staticClass:"mord mathdefault"},[t._v("s")]),a("span",{staticClass:"mord mathdefault"},[t._v("t")]),a("span",{staticClass:"mord",staticStyle:{"margin-right":"0.02778em"}},[t._v("_")]),a("span",{staticClass:"mord mathdefault"},[t._v("i")])])]),a("span",{staticStyle:{top:"-1.2482600000000006em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"3.33652em"}}),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathdefault"},[t._v("c")]),a("span",{staticClass:"mord mathdefault"},[t._v("o")]),a("span",{staticClass:"mord mathdefault"},[t._v("u")]),a("span",{staticClass:"mord mathdefault"},[t._v("n")]),a("span",{staticClass:"mord mathdefault"},[t._v("t")])])])]),a("span",{staticClass:"vlist-s"},[t._v("​")])]),a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"3.3242599999999998em"}},[a("span")])])])]),a("span",{staticClass:"col-align-l"},[a("span",{staticClass:"vlist-t vlist-t2"},[a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"3.8242600000000007em"}},[a("span",{staticStyle:{top:"-6.0532200000000005em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"3.33652em"}}),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord"}),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),a("span",{staticClass:"mrel"},[t._v("=")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),a("span",{staticClass:"mord mathdefault"},[t._v("i")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),a("span",{staticClass:"mbin"},[t._v("∗")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),a("span",{staticClass:"mopen"},[t._v("⌊")]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mopen nulldelimiter"}),a("span",{staticClass:"mfrac"},[a("span",{staticClass:"vlist-t vlist-t2"},[a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"1.10756em"}},[a("span",{staticStyle:{top:"-2.314em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathdefault"},[t._v("p")])])]),a("span",{staticStyle:{top:"-3.23em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),a("span",{staticClass:"frac-line",staticStyle:{"border-bottom-width":"0.04em"}})]),a("span",{staticStyle:{top:"-3.677em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathdefault"},[t._v("n")])])])]),a("span",{staticClass:"vlist-s"},[t._v("​")])]),a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"0.8804400000000001em"}},[a("span")])])])]),a("span",{staticClass:"mclose nulldelimiter"})]),a("span",{staticClass:"mclose"},[t._v("⌋")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),a("span",{staticClass:"mbin"},[t._v("+")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),a("span",{staticClass:"mop"},[t._v("min")]),a("span",{staticClass:"mopen"},[t._v("(")]),a("span",{staticClass:"mord mathdefault"},[t._v("i")]),a("span",{staticClass:"mpunct"},[t._v(",")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.16666666666666666em"}}),a("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.02778em"}},[t._v("r")]),a("span",{staticClass:"mclose"},[t._v(")")])])]),a("span",{staticStyle:{top:"-3.7652200000000002em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"3.33652em"}}),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord"}),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),a("span",{staticClass:"mrel"},[t._v("=")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),a("span",{staticClass:"mopen"},[t._v("(")]),a("span",{staticClass:"mord mathdefault"},[t._v("i")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),a("span",{staticClass:"mbin"},[t._v("+")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),a("span",{staticClass:"mord"},[t._v("1")]),a("span",{staticClass:"mclose"},[t._v(")")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),a("span",{staticClass:"mbin"},[t._v("∗")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),a("span",{staticClass:"mopen"},[t._v("⌊")]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mopen nulldelimiter"}),a("span",{staticClass:"mfrac"},[a("span",{staticClass:"vlist-t vlist-t2"},[a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"1.10756em"}},[a("span",{staticStyle:{top:"-2.314em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathdefault"},[t._v("p")])])]),a("span",{staticStyle:{top:"-3.23em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),a("span",{staticClass:"frac-line",staticStyle:{"border-bottom-width":"0.04em"}})]),a("span",{staticStyle:{top:"-3.677em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathdefault"},[t._v("n")])])])]),a("span",{staticClass:"vlist-s"},[t._v("​")])]),a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"0.8804400000000001em"}},[a("span")])])])]),a("span",{staticClass:"mclose nulldelimiter"})]),a("span",{staticClass:"mclose"},[t._v("⌋")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),a("span",{staticClass:"mbin"},[t._v("+")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),a("span",{staticClass:"mop"},[t._v("min")]),a("span",{staticClass:"mopen"},[t._v("(")]),a("span",{staticClass:"mord mathdefault"},[t._v("i")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),a("span",{staticClass:"mbin"},[t._v("+")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),a("span",{staticClass:"mord"},[t._v("1")]),a("span",{staticClass:"mpunct"},[t._v(",")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.16666666666666666em"}}),a("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.02778em"}},[t._v("r")]),a("span",{staticClass:"mclose"},[t._v(")")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),a("span",{staticClass:"mbin"},[t._v("−")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),a("span",{staticClass:"mord"},[t._v("1")])])]),a("span",{staticStyle:{top:"-1.2482600000000006em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"3.33652em"}}),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord"}),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),a("span",{staticClass:"mrel"},[t._v("=")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),a("span",{staticClass:"mop"},[t._v("min")]),a("span",{staticClass:"mopen"},[t._v("(")]),a("span",{staticClass:"mopen"},[t._v("⌊")]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mopen nulldelimiter"}),a("span",{staticClass:"mfrac"},[a("span",{staticClass:"vlist-t vlist-t2"},[a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"1.3365200000000002em"}},[a("span",{staticStyle:{top:"-2.314em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),a("span",{staticClass:"mord"},[a("span",{staticClass:"mopen"},[t._v("⌊")]),a("span",{staticClass:"mord mathdefault"},[t._v("n")]),a("span",{staticClass:"mord"},[t._v("/")]),a("span",{staticClass:"mord mathdefault"},[t._v("p")]),a("span",{staticClass:"mclose"},[t._v("⌋")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),a("span",{staticClass:"mbin"},[t._v("+")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),a("span",{staticClass:"mord"},[t._v("1")])])]),a("span",{staticStyle:{top:"-3.23em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),a("span",{staticClass:"frac-line",staticStyle:{"border-bottom-width":"0.04em"}})]),a("span",{staticStyle:{top:"-3.677em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.05724em"}},[t._v("j")])])])]),a("span",{staticClass:"vlist-s"},[t._v("​")])]),a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"0.936em"}},[a("span")])])])]),a("span",{staticClass:"mclose nulldelimiter"})]),a("span",{staticClass:"mclose"},[t._v("⌋")]),a("span",{staticClass:"mpunct"},[t._v(",")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.16666666666666666em"}}),a("span",{staticClass:"mopen"},[t._v("⌊")]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mopen nulldelimiter"}),a("span",{staticClass:"mfrac"},[a("span",{staticClass:"vlist-t vlist-t2"},[a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"1.3365200000000002em"}},[a("span",{staticStyle:{top:"-2.314em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),a("span",{staticClass:"mord"},[a("span",{staticClass:"mopen"},[t._v("⌊")]),a("span",{staticClass:"mord mathdefault"},[t._v("n")]),a("span",{staticClass:"mord"},[t._v("/")]),a("span",{staticClass:"mord mathdefault"},[t._v("p")]),a("span",{staticClass:"mclose"},[t._v("⌋")])])]),a("span",{staticStyle:{top:"-3.23em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),a("span",{staticClass:"frac-line",staticStyle:{"border-bottom-width":"0.04em"}})]),a("span",{staticStyle:{top:"-3.677em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.05724em"}},[t._v("j")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),a("span",{staticClass:"mbin"},[t._v("−")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),a("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.02778em"}},[t._v("r")])])])]),a("span",{staticClass:"vlist-s"},[t._v("​")])]),a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"0.936em"}},[a("span")])])])]),a("span",{staticClass:"mclose nulldelimiter"})]),a("span",{staticClass:"mclose"},[t._v("⌋")]),a("span",{staticClass:"mclose"},[t._v(")")])])])]),a("span",{staticClass:"vlist-s"},[t._v("​")])]),a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"3.3242599999999998em"}},[a("span")])])])])])])])])])])])],1),a("p",[t._v("使用按块分配，就是第一章的"),a("a",{attrs:{href:"#%E4%B9%A0%E9%A2%98"}},[t._v("习题")]),t._v("中提到的：")]),t._v(" "),a("section",[a("eqn",[a("span",{staticClass:"katex-display"},[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[a("semantics",[a("mtable",{attrs:{rowspacing:"0.24999999999999992em",columnalign:"right left",columnspacing:"0em"}},[a("mtr",[a("mtd",[a("mstyle",{attrs:{scriptlevel:"0",displaystyle:"true"}},[a("mrow",[a("mi",[t._v("m")]),a("mi",[t._v("y")]),a("mi",{attrs:{mathvariant:"normal"}},[t._v("_")]),a("mi",[t._v("f")]),a("mi",[t._v("i")]),a("mi",[t._v("r")]),a("mi",[t._v("s")]),a("mi",[t._v("t")]),a("mi",{attrs:{mathvariant:"normal"}},[t._v("_")]),a("mi",[t._v("i")])],1)],1)],1),a("mtd",[a("mstyle",{attrs:{scriptlevel:"0",displaystyle:"true"}},[a("mrow",[a("mrow"),a("mo",[t._v("=")]),a("mo",{attrs:{stretchy:"false"}},[t._v("⌊")]),a("mfrac",[a("mrow",[a("mi",[t._v("i")]),a("mo",[t._v("∗")]),a("mi",[t._v("n")])],1),a("mi",[t._v("p")])],1),a("mo",{attrs:{stretchy:"false"}},[t._v("⌋")])],1)],1)],1)],1),a("mtr",[a("mtd",[a("mstyle",{attrs:{scriptlevel:"0",displaystyle:"true"}},[a("mrow",[a("mi",[t._v("m")]),a("mi",[t._v("y")]),a("mi",{attrs:{mathvariant:"normal"}},[t._v("_")]),a("mi",[t._v("l")]),a("mi",[t._v("a")]),a("mi",[t._v("s")]),a("mi",[t._v("t")]),a("mi",{attrs:{mathvariant:"normal"}},[t._v("_")]),a("mi",[t._v("i")])],1)],1)],1),a("mtd",[a("mstyle",{attrs:{scriptlevel:"0",displaystyle:"true"}},[a("mrow",[a("mrow"),a("mo",[t._v("=")]),a("mo",{attrs:{stretchy:"false"}},[t._v("⌊")]),a("mfrac",[a("mrow",[a("mo",{attrs:{stretchy:"false"}},[t._v("(")]),a("mi",[t._v("i")]),a("mo",[t._v("+")]),a("mn",[t._v("1")]),a("mo",{attrs:{stretchy:"false"}},[t._v(")")]),a("mo",[t._v("∗")]),a("mi",[t._v("n")])],1),a("mi",[t._v("p")])],1),a("mo",{attrs:{stretchy:"false"}},[t._v("⌋")]),a("mo",[t._v("−")]),a("mn",[t._v("1")])],1)],1)],1)],1),a("mtr",[a("mtd",[a("mstyle",{attrs:{scriptlevel:"0",displaystyle:"true"}},[a("mrow",[a("mi",[t._v("c")]),a("mi",[t._v("o")]),a("mi",[t._v("u")]),a("mi",[t._v("n")]),a("mi",[t._v("t")])],1)],1)],1),a("mtd",[a("mstyle",{attrs:{scriptlevel:"0",displaystyle:"true"}},[a("mrow",[a("mrow"),a("mo",[t._v("=")]),a("mo",{attrs:{stretchy:"false"}},[t._v("⌊")]),a("mfrac",[a("mrow",[a("mi",[t._v("p")]),a("mo",{attrs:{stretchy:"false"}},[t._v("(")]),a("mi",[t._v("j")]),a("mo",[t._v("+")]),a("mn",[t._v("1")]),a("mo",{attrs:{stretchy:"false"}},[t._v(")")]),a("mo",[t._v("−")]),a("mn",[t._v("1")])],1),a("mi",[t._v("n")])],1),a("mo",{attrs:{stretchy:"false"}},[t._v("⌋")])],1)],1)],1)],1)],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\begin{aligned}\nmy\\_first\\_i &= \\lfloor\\frac{i*n}{p}\\rfloor \\\\\nmy\\_last\\_i &= \\lfloor\\frac{(i+1)*n}{p}\\rfloor - 1 \\\\\ncount &= \\lfloor \\frac{p(j+1)-1}{n}\\rfloor\n\\end{aligned}")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"7.5374em","vertical-align":"-3.518699999999999em"}}),a("span",{staticClass:"mord"},[a("span",{staticClass:"mtable"},[a("span",{staticClass:"col-align-r"},[a("span",{staticClass:"vlist-t vlist-t2"},[a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"4.018700000000001em"}},[a("span",{staticStyle:{top:"-6.10918em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"3.427em"}}),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathdefault"},[t._v("m")]),a("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.03588em"}},[t._v("y")]),a("span",{staticClass:"mord",staticStyle:{"margin-right":"0.02778em"}},[t._v("_")]),a("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.10764em"}},[t._v("f")]),a("span",{staticClass:"mord mathdefault"},[t._v("i")]),a("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.02778em"}},[t._v("r")]),a("span",{staticClass:"mord mathdefault"},[t._v("s")]),a("span",{staticClass:"mord mathdefault"},[t._v("t")]),a("span",{staticClass:"mord",staticStyle:{"margin-right":"0.02778em"}},[t._v("_")]),a("span",{staticClass:"mord mathdefault"},[t._v("i")])])]),a("span",{staticStyle:{top:"-3.5017400000000016em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"3.427em"}}),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathdefault"},[t._v("m")]),a("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.03588em"}},[t._v("y")]),a("span",{staticClass:"mord",staticStyle:{"margin-right":"0.02778em"}},[t._v("_")]),a("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.01968em"}},[t._v("l")]),a("span",{staticClass:"mord mathdefault"},[t._v("a")]),a("span",{staticClass:"mord mathdefault"},[t._v("s")]),a("span",{staticClass:"mord mathdefault"},[t._v("t")]),a("span",{staticClass:"mord",staticStyle:{"margin-right":"0.02778em"}},[t._v("_")]),a("span",{staticClass:"mord mathdefault"},[t._v("i")])])]),a("span",{staticStyle:{top:"-0.8943000000000011em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"3.427em"}}),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathdefault"},[t._v("c")]),a("span",{staticClass:"mord mathdefault"},[t._v("o")]),a("span",{staticClass:"mord mathdefault"},[t._v("u")]),a("span",{staticClass:"mord mathdefault"},[t._v("n")]),a("span",{staticClass:"mord mathdefault"},[t._v("t")])])])]),a("span",{staticClass:"vlist-s"},[t._v("​")])]),a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"3.518699999999999em"}},[a("span")])])])]),a("span",{staticClass:"col-align-l"},[a("span",{staticClass:"vlist-t vlist-t2"},[a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"4.018700000000001em"}},[a("span",{staticStyle:{top:"-6.10918em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"3.427em"}}),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord"}),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),a("span",{staticClass:"mrel"},[t._v("=")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),a("span",{staticClass:"mopen"},[t._v("⌊")]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mopen nulldelimiter"}),a("span",{staticClass:"mfrac"},[a("span",{staticClass:"vlist-t vlist-t2"},[a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"1.3365200000000002em"}},[a("span",{staticStyle:{top:"-2.314em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathdefault"},[t._v("p")])])]),a("span",{staticStyle:{top:"-3.23em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),a("span",{staticClass:"frac-line",staticStyle:{"border-bottom-width":"0.04em"}})]),a("span",{staticStyle:{top:"-3.677em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathdefault"},[t._v("i")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),a("span",{staticClass:"mbin"},[t._v("∗")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),a("span",{staticClass:"mord mathdefault"},[t._v("n")])])])]),a("span",{staticClass:"vlist-s"},[t._v("​")])]),a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"0.8804400000000001em"}},[a("span")])])])]),a("span",{staticClass:"mclose nulldelimiter"})]),a("span",{staticClass:"mclose"},[t._v("⌋")])])]),a("span",{staticStyle:{top:"-3.5017400000000016em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"3.427em"}}),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord"}),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),a("span",{staticClass:"mrel"},[t._v("=")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),a("span",{staticClass:"mopen"},[t._v("⌊")]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mopen nulldelimiter"}),a("span",{staticClass:"mfrac"},[a("span",{staticClass:"vlist-t vlist-t2"},[a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"1.427em"}},[a("span",{staticStyle:{top:"-2.314em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathdefault"},[t._v("p")])])]),a("span",{staticStyle:{top:"-3.23em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),a("span",{staticClass:"frac-line",staticStyle:{"border-bottom-width":"0.04em"}})]),a("span",{staticStyle:{top:"-3.677em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),a("span",{staticClass:"mord"},[a("span",{staticClass:"mopen"},[t._v("(")]),a("span",{staticClass:"mord mathdefault"},[t._v("i")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),a("span",{staticClass:"mbin"},[t._v("+")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),a("span",{staticClass:"mord"},[t._v("1")]),a("span",{staticClass:"mclose"},[t._v(")")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),a("span",{staticClass:"mbin"},[t._v("∗")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),a("span",{staticClass:"mord mathdefault"},[t._v("n")])])])]),a("span",{staticClass:"vlist-s"},[t._v("​")])]),a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"0.8804400000000001em"}},[a("span")])])])]),a("span",{staticClass:"mclose nulldelimiter"})]),a("span",{staticClass:"mclose"},[t._v("⌋")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),a("span",{staticClass:"mbin"},[t._v("−")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),a("span",{staticClass:"mord"},[t._v("1")])])]),a("span",{staticStyle:{top:"-0.8943000000000011em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"3.427em"}}),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord"}),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),a("span",{staticClass:"mrel"},[t._v("=")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),a("span",{staticClass:"mopen"},[t._v("⌊")]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mopen nulldelimiter"}),a("span",{staticClass:"mfrac"},[a("span",{staticClass:"vlist-t vlist-t2"},[a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"1.427em"}},[a("span",{staticStyle:{top:"-2.314em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathdefault"},[t._v("n")])])]),a("span",{staticStyle:{top:"-3.23em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),a("span",{staticClass:"frac-line",staticStyle:{"border-bottom-width":"0.04em"}})]),a("span",{staticStyle:{top:"-3.677em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathdefault"},[t._v("p")]),a("span",{staticClass:"mopen"},[t._v("(")]),a("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.05724em"}},[t._v("j")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),a("span",{staticClass:"mbin"},[t._v("+")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),a("span",{staticClass:"mord"},[t._v("1")]),a("span",{staticClass:"mclose"},[t._v(")")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),a("span",{staticClass:"mbin"},[t._v("−")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),a("span",{staticClass:"mord"},[t._v("1")])])])]),a("span",{staticClass:"vlist-s"},[t._v("​")])]),a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"0.686em"}},[a("span")])])])]),a("span",{staticClass:"mclose nulldelimiter"})]),a("span",{staticClass:"mclose"},[t._v("⌋")])])])]),a("span",{staticClass:"vlist-s"},[t._v("​")])]),a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"3.518699999999999em"}},[a("span")])])])])])])])])])])])],1),a("p",[t._v("两种算法都可以，后面一种表达式更简单，所以选择这一种。")]),t._v(" "),a("h3",{attrs:{id:"算法性能分析"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#算法性能分析"}},[t._v("#")]),t._v(" 算法性能分析")]),t._v(" "),a("p",[a("img",{attrs:{src:"/images/88adda06e90b6e2c1c35fe8d2aad587701b90083324719108b918b9cc6902d4b.png",alt:"时间复杂度"}})]),t._v(" "),a("h2",{attrs:{id:"_7-floyd-s-algorithm"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-floyd-s-algorithm"}},[t._v("#")]),t._v(" 7 Floyd's Algorithm")]),t._v(" "),a("p",[t._v("Floyd 算法伪代码：")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("for k = 0 to n-1\n\tfor i = 0 to n-1\n\t\tfor j = 0 to n-1\n\t\t\ta[i,j] = min (a[i,j], a[i,k] + a[k,j])\n\t\tendfor\n\tendfor\nendfor\n")])])]),a("h3",{attrs:{id:"分块-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#分块-2"}},[t._v("#")]),t._v(" 分块")]),t._v(" "),a("p",[t._v("把矩阵 A 的每个元素视为一个任务，分解成 "),a("eq",[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[a("semantics",[a("mrow",[a("msup",[a("mi",[t._v("n")]),a("mn",[t._v("2")])],1)],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("n^2")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"0.8141079999999999em","vertical-align":"0em"}}),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathdefault"},[t._v("n")]),a("span",{staticClass:"msupsub"},[a("span",{staticClass:"vlist-t"},[a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"0.8141079999999999em"}},[a("span",{staticStyle:{top:"-3.063em","margin-right":"0.05em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),a("span",{staticClass:"sizing reset-size6 size3 mtight"},[a("span",{staticClass:"mord mtight"},[t._v("2")])])])])])])])])])])])]),t._v(" 个任务。")],1),t._v(" "),a("h3",{attrs:{id:"通信-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#通信-2"}},[t._v("#")]),t._v(" 通信")]),t._v(" "),a("p",[a("img",{attrs:{src:"/images/4d969f0f01de0dbe26625734319141343aa94a3d757408bcdac3dab1d47851ae.png",alt:"通信"}})]),t._v(" "),a("h3",{attrs:{id:"聚合和映射"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#聚合和映射"}},[t._v("#")]),t._v(" 聚合和映射")]),t._v(" "),a("p",[a("img",{attrs:{src:"/images/bd034b3575872b50830cff9eb155eda3ef522efb0552aed853a65cf98ee25494.png",alt:"按行或者按列聚合"}})]),t._v(" "),a("p",[t._v("按行或者按列聚合。最后选择按行聚合，在读文件的时候会容易的多。")]),t._v(" "),a("h3",{attrs:{id:"点对点通信"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#点对点通信"}},[t._v("#")]),t._v(" 点对点通信")]),t._v(" "),a("p",[a("img",{attrs:{src:"/images/747c86c5ddb798561512cd64ff6699014e62dec235a4b397dad4b97e6dd7ccd9.png",alt:"点对点通信"}})]),t._v(" "),a("div",{staticClass:"language-cpp extra-class"},[a("pre",{pre:!0,attrs:{class:"language-cpp"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("MPI_Send")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v("         "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("message"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("           count"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    MPI_Datatype  datatype"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("           dest"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("           tag"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    MPI_Comm      comm\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("MPI_Recv")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v("         "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("message"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("           count"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    MPI_Datatype  datatype"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("           source"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("           tag"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    MPI_Comm      comm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    MPI_Status   "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("status\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[t._v("Send 和 Recv 需要约定相同的 tag，以及对方的 id (作为自己的 source/dest)。")]),t._v(" "),a("p",[a("img",{attrs:{src:"/images/3468470bf9dc8be793b76a0e6cc744b6731b8c0d269058acd9c65a240b03f856.png",alt:"send/recv 原理"}})]),t._v(" "),a("ul",[a("li",[a("code",[t._v("MPI_Send")]),t._v(" 函数会一直阻塞直至 message_buffer 空了。")]),t._v(" "),a("li",[a("code",[t._v("MPI_Recv")]),t._v(" 函数会一直阻塞直至收到消息。")])]),t._v(" "),a("p",[t._v("这就很容易造成死锁。")]),t._v(" "),a("h4",{attrs:{id:"死锁"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#死锁"}},[t._v("#")]),t._v(" 死锁")]),t._v(" "),a("div",{staticClass:"language-cpp extra-class"},[a("pre",{pre:!0,attrs:{class:"language-cpp"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("id "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("MPI_Recv")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("b"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("MPI_Send")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n   c "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("a "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" b"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2.0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("id "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("MPI_Recv")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("MPI_Send")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("b"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n   c "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("a "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" b"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2.0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("Process 0 blocks waiting for message from 1, but 1 blocks waiting for a message from 0.\nDeadlock!")]),t._v(" "),a("hr"),t._v(" "),a("div",{staticClass:"language-cpp extra-class"},[a("pre",{pre:!0,attrs:{class:"language-cpp"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("id "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("MPI_Send")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("MPI_COMM_WORLD"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("MPI_Recv")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("b"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" MPI_COMM_WORLD"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("status"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\tc "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("a"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("b"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2.0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("id "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("MPI_Send")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("MPI_COMM_WORLD"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("MPI_Recv")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("b"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" MPI_COMM_WORLD"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("status"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\tc "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("a"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("b"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2.0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("Both processes send before they try to receive, but they still deadlock.  Why?\nThe tags are wrong. Process 0 is trying to receive a tag of 1, but Process 1 is sending a tag of 0.")]),t._v(" "),a("h4",{attrs:{id:"ssend"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ssend"}},[t._v("#")]),t._v(" Ssend")]),t._v(" "),a("p",[t._v("依赖 buffer 的 "),a("code",[t._v("MPI_send")]),t._v(" 是不安全的，因为 MPI 标准允许 "),a("code",[t._v("MPI_Send")]),t._v(" 可以提供/不提供 buffer。")]),t._v(" "),a("p",[t._v("两种问题可能会出问题：")]),t._v(" "),a("ol",[a("li",[t._v("双方都是先发后收，并且发的数据都很大")]),t._v(" "),a("li",[t._v("生产者/消费者问题，且生产者生产的比消费者块")])]),t._v(" "),a("p",[t._v("MPI 标准定义了 "),a("code",[t._v("MPI_Ssend")]),t._v("，保证发送会被阻塞（"),a("code",[t._v("s")]),t._v(" 表 "),a("code",[t._v("synchronous")]),t._v("）。")]),t._v(" "),a("h4",{attrs:{id:"sendrecv"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#sendrecv"}},[t._v("#")]),t._v(" SendRecv")]),t._v(" "),a("p",[t._v("如果需要同时发送接收，可以通过代码逻辑使大家按照某种顺序，避免死锁，但也可以使用 "),a("code",[t._v("MPI_SendRecv")]),t._v(" 同时发送和接收，中间的调度由 MPI 实现。")]),t._v(" "),a("p",[a("img",{attrs:{src:"/images/c72afb5b5bac41c8bfcdb01a5fe8d35fc3fc79f5fa0b40f4643b66fcfa75fc3c.png",alt:"MPI_SendRecv"}})]),t._v(" "),a("h3",{attrs:{id:"并行-floyd-算法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#并行-floyd-算法"}},[t._v("#")]),t._v(" 并行 Floyd 算法")]),t._v(" "),a("p",[a("img",{attrs:{src:"/images/79faaecb53a6c844f6ecccd9db9105a37912b1708a911b5d1c1179d1c0d7a8d7.png",alt:"核心部分"}})]),t._v(" "),a("ul",[a("li",[t._v("计算时间复杂度："),a("eq",[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[a("semantics",[a("mrow",[a("mi",{attrs:{mathvariant:"normal"}},[t._v("Θ")]),a("mo",{attrs:{stretchy:"false"}},[t._v("(")]),a("msup",[a("mi",[t._v("n")]),a("mn",[t._v("3")])],1),a("mi",{attrs:{mathvariant:"normal"}},[t._v("/")]),a("mi",[t._v("p")]),a("mo",{attrs:{stretchy:"false"}},[t._v(")")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\Theta(n^3/p)")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"1.064108em","vertical-align":"-0.25em"}}),a("span",{staticClass:"mord"},[t._v("Θ")]),a("span",{staticClass:"mopen"},[t._v("(")]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathdefault"},[t._v("n")]),a("span",{staticClass:"msupsub"},[a("span",{staticClass:"vlist-t"},[a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"0.8141079999999999em"}},[a("span",{staticStyle:{top:"-3.063em","margin-right":"0.05em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),a("span",{staticClass:"sizing reset-size6 size3 mtight"},[a("span",{staticClass:"mord mtight"},[t._v("3")])])])])])])])]),a("span",{staticClass:"mord"},[t._v("/")]),a("span",{staticClass:"mord mathdefault"},[t._v("p")]),a("span",{staticClass:"mclose"},[t._v(")")])])])])])],1),t._v(" "),a("li",[t._v("通信时间复杂度："),a("eq",[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[a("semantics",[a("mrow",[a("msup",[a("mi",[t._v("n")]),a("mn",[t._v("2")])],1),a("mi",[t._v("log")]),a("mo",[t._v("⁡")]),a("mi",[t._v("p")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("n^2 \\log p")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"1.008548em","vertical-align":"-0.19444em"}}),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathdefault"},[t._v("n")]),a("span",{staticClass:"msupsub"},[a("span",{staticClass:"vlist-t"},[a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"0.8141079999999999em"}},[a("span",{staticStyle:{top:"-3.063em","margin-right":"0.05em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),a("span",{staticClass:"sizing reset-size6 size3 mtight"},[a("span",{staticClass:"mord mtight"},[t._v("2")])])])])])])])]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.16666666666666666em"}}),a("span",{staticClass:"mop"},[t._v("lo"),a("span",{staticStyle:{"margin-right":"0.01389em"}},[t._v("g")])]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.16666666666666666em"}}),a("span",{staticClass:"mord mathdefault"},[t._v("p")])])])])])],1),t._v(" "),a("li",[t._v("执行时间（其中 "),a("eq",[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[a("semantics",[a("mrow",[a("mi",[t._v("β")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\beta")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"0.8888799999999999em","vertical-align":"-0.19444em"}}),a("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.05278em"}},[t._v("β")])])])])]),t._v(" 是显存带宽，其他变量见第三章）：")],1)]),t._v(" "),a("section",[a("eqn",[a("span",{staticClass:"katex-display"},[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[a("semantics",[a("mrow",[a("mi",[t._v("n")]),a("mo",{attrs:{stretchy:"false"}},[t._v("⌈")]),a("mi",[t._v("n")]),a("mi",{attrs:{mathvariant:"normal"}},[t._v("/")]),a("mi",[t._v("p")]),a("mo",{attrs:{stretchy:"false"}},[t._v("⌉")]),a("mi",[t._v("n")]),a("mi",[t._v("χ")]),a("mo",[t._v("+")]),a("mi",[t._v("n")]),a("mo",{attrs:{stretchy:"false"}},[t._v("⌈")]),a("mi",[t._v("log")]),a("mo",[t._v("⁡")]),a("mi",[t._v("p")]),a("mo",{attrs:{stretchy:"false"}},[t._v("⌉")]),a("mo",{attrs:{stretchy:"false"}},[t._v("(")]),a("mi",[t._v("λ")]),a("mo",[t._v("+")]),a("mn",[t._v("4")]),a("mi",[t._v("n")]),a("mi",{attrs:{mathvariant:"normal"}},[t._v("/")]),a("mi",[t._v("β")]),a("mo",{attrs:{stretchy:"false"}},[t._v(")")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("n \\lceil n / p \\rceil n \\chi +\nn \\lceil \\log p \\rceil (\\lambda + 4n / \\beta)")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"1em","vertical-align":"-0.25em"}}),a("span",{staticClass:"mord mathdefault"},[t._v("n")]),a("span",{staticClass:"mopen"},[t._v("⌈")]),a("span",{staticClass:"mord mathdefault"},[t._v("n")]),a("span",{staticClass:"mord"},[t._v("/")]),a("span",{staticClass:"mord mathdefault"},[t._v("p")]),a("span",{staticClass:"mclose"},[t._v("⌉")]),a("span",{staticClass:"mord mathdefault"},[t._v("n")]),a("span",{staticClass:"mord mathdefault"},[t._v("χ")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),a("span",{staticClass:"mbin"},[t._v("+")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}})]),a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"1em","vertical-align":"-0.25em"}}),a("span",{staticClass:"mord mathdefault"},[t._v("n")]),a("span",{staticClass:"mopen"},[t._v("⌈")]),a("span",{staticClass:"mop"},[t._v("lo"),a("span",{staticStyle:{"margin-right":"0.01389em"}},[t._v("g")])]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.16666666666666666em"}}),a("span",{staticClass:"mord mathdefault"},[t._v("p")]),a("span",{staticClass:"mclose"},[t._v("⌉")]),a("span",{staticClass:"mopen"},[t._v("(")]),a("span",{staticClass:"mord mathdefault"},[t._v("λ")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),a("span",{staticClass:"mbin"},[t._v("+")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}})]),a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"1em","vertical-align":"-0.25em"}}),a("span",{staticClass:"mord"},[t._v("4")]),a("span",{staticClass:"mord mathdefault"},[t._v("n")]),a("span",{staticClass:"mord"},[t._v("/")]),a("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.05278em"}},[t._v("β")]),a("span",{staticClass:"mclose"},[t._v(")")])])])])])])],1),a("h2",{attrs:{id:"cuda-部分"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#cuda-部分"}},[t._v("#")]),t._v(" CUDA 部分")]),t._v(" "),a("h3",{attrs:{id:"结构"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#结构"}},[t._v("#")]),t._v(" 结构")]),t._v(" "),a("ul",[a("li",[t._v("Thread -- Register")]),t._v(" "),a("li",[t._v("Warp")]),t._v(" "),a("li",[t._v("Block -- 对应一个 Streming Multiprocessors，Shared Memory")]),t._v(" "),a("li",[t._v("Grid -- 对应一个 Kernel")]),t._v(" "),a("li",[t._v("Device -- Global Memory")])]),t._v(" "),a("h3",{attrs:{id:"代码思路"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#代码思路"}},[t._v("#")]),t._v(" 代码思路")]),t._v(" "),a("p",[t._v("用  Block 处理二维图像：")]),t._v(" "),a("div",{staticClass:"language-cpp extra-class"},[a("pre",{pre:!0,attrs:{class:"language-cpp"}},[a("code",[t._v("__global__ "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("PictureKernel")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("float")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" d_Pin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("float")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" d_Pout"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" height"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" width"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" Row "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" blockIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("y"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("blockDim"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("y "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" threadIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("y"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" Col "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" blockIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("x"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("blockDim"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("x "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" threadIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("x"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Row "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" height"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Col "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" width"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    d_Pout"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Row"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("width"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("Col"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2.0")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("d_Pin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Row"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("width"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("Col"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("main")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  dim3 "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("DimGrid")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("m"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  dim3 "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("DimBlock")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  PictureKernel"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("DimGrid"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("DimBlock"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("d_Pin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" d_Pout"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" m"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h3",{attrs:{id:"block-大小"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#block-大小"}},[t._v("#")]),t._v(" Block 大小")]),t._v(" "),a("p",[t._v("For Matrix Multiplication using multiple blocks, should I use 8X8, 16X16 or 32X32 blocks for Fermi?")]),t._v(" "),a("ul",[a("li",[t._v("For 8X8, we have 64 threads per Block. Since each SM can take up to 1536 threads, which translates to 24 Blocks. However, each SM can only take up to 8 Blocks, only 512 threads will go into each SM!")]),t._v(" "),a("li",[t._v("For 16X16, we have 256 threads per Block. Since each SM can take up to 1536 threads, it can take up to 6 Blocks and achieve full capacity unless other resource considerations overrule.")]),t._v(" "),a("li",[t._v("For 32X32, we would have 1024 threads per Block. Only one block can fit into an SM for Fermi. Using only 2/3 of the thread capacity of an SM.")])]),t._v(" "),a("h3",{attrs:{id:"cgma"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#cgma"}},[t._v("#")]),t._v(" CGMA")]),t._v(" "),a("p",[t._v("CGMA = 从全局内存中取一个数，多少次运算用到了这个数")]),t._v(" "),a("p",[t._v("CGMA 越大越好")]),t._v(" "),a("h3",{attrs:{id:"shared-memory-and-threading"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#shared-memory-and-threading"}},[t._v("#")]),t._v(" Shared Memory And Threading")]),t._v(" "),a("p",[a("img",{attrs:{src:"/images/63f9b6471890380c4f186f2bd8b45e8e7b8d3e765ad9fb38ee2a2049736909bd.png",alt:"Shared Memory And Threading"}})]),t._v(" "),a("h2",{attrs:{id:"openacc-部分"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#openacc-部分"}},[t._v("#")]),t._v(" OpenACC 部分")]),t._v(" "),a("h3",{attrs:{id:"gpu-占用率"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#gpu-占用率"}},[t._v("#")]),t._v(" GPU 占用率")]),t._v(" "),a("blockquote",[a("p",[t._v("GPU Occupancy is:")]),t._v(" "),a("ul",[a("li",[t._v("How much parallelism is running / How much parallelism the hardware could run")]),t._v(" "),a("li",[t._v("100% occupancy is not required for, nor does it guarantee best performance.")]),t._v(" "),a("li",[t._v("Less than 50% occupancy is often a red flag")])])])])}),[],!1,null,null,null);s.default=i.exports}}]);