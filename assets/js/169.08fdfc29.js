(window.webpackJsonp=window.webpackJsonp||[]).push([[169],{582:function(t,s,a){"use strict";a.r(s);var e=a(3),r=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"帮助文档"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#帮助文档"}},[t._v("#")]),t._v(" 帮助文档")]),t._v(" "),a("p",[t._v("长的帮助： "),a("code",[t._v("man <command>")])]),t._v(" "),a("p",[t._v("短的帮助： "),a("code",[t._v("tldr <command>")])]),t._v(" "),a("p",[t._v("有了 "),a("code",[t._v("tldr")]),t._v(" 以后，很多教程都可以删掉了。")]),t._v(" "),a("h2",{attrs:{id:"更换镜像源"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#更换镜像源"}},[t._v("#")]),t._v(" 更换镜像源")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("源")]),t._v(" "),a("th",[t._v("镜像")]),t._v(" "),a("th",[t._v("命令")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("apt(ubuntu20)")]),t._v(" "),a("td",[t._v("腾讯")]),t._v(" "),a("td",[a("code",[t._v("sudo wget -O /etc/apt/sources.list http://mirrors.cloud.tencent.com/repo/ubuntu20_sources.list")])])]),t._v(" "),a("tr",[a("td",[t._v("pip")]),t._v(" "),a("td",[t._v("豆瓣")]),t._v(" "),a("td",[a("code",[t._v("pip3 config set global.index-url http://pypi.doubanio.com/simple && pip3 config set global.trusted-host pypi.doubanio.com")])])]),t._v(" "),a("tr",[a("td",[t._v("npm")]),t._v(" "),a("td",[t._v("淘宝")]),t._v(" "),a("td",[a("code",[t._v("npm config set registry https://registry.npm.taobao.org")])])]),t._v(" "),a("tr",[a("td",[t._v("yarn")]),t._v(" "),a("td",[t._v("淘宝")]),t._v(" "),a("td",[a("code",[t._v("yarn config set registry https://registry.npm.taobao.org")])])]),t._v(" "),a("tr",[a("td",[t._v("docker")]),t._v(" "),a("td",[t._v("阿里云")]),t._v(" "),a("td",[a("code",[t._v("sudo wget -O /etc/docker/daemon.json https://blog.lyh543.cn/mirrors/docker.json")])])]),t._v(" "),a("tr",[a("td",[t._v("maven")]),t._v(" "),a("td",[t._v("阿里云")]),t._v(" "),a("td",[a("code",[t._v("wget -O ~/.m2/settings.xml https://blog.lyh543.cn/mirrors/maven.xml")])])]),t._v(" "),a("tr",[a("td",[t._v("tlmgr")]),t._v(" "),a("td",[t._v("科大")]),t._v(" "),a("td",[a("code",[t._v("tlmgr option repository http://mirrors.ustc.edu.cn/CTAN/systems/texlive/tlnet")])])]),t._v(" "),a("tr",[a("td",[t._v("GitHub")]),t._v(" "),a("td",[t._v("fastgit")]),t._v(" "),a("td",[a("code",[t._v('git config --global url."https://hub.fastgit.org/".insteadOf "https://github.com/"')])])])])]),t._v(" "),a("h2",{attrs:{id:"文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#文件"}},[t._v("#")]),t._v(" 文件")]),t._v(" "),a("h3",{attrs:{id:"当前文件夹"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#当前文件夹"}},[t._v("#")]),t._v(" 当前文件夹")]),t._v(" "),a("p",[a("code",[t._v("pushd")]),t._v(" 和 "),a("code",[t._v("popd")]),t._v(" 起了 "),a("code",[t._v("cd")]),t._v(" 的作用，还能自动将当前目录压栈、出栈。")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("pwd")]),t._v("\n~\n\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("pushd")]),t._v(" /tmp\n/tmp ~\n\n$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("pwd")]),t._v("\n/tmp\n\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("popd")]),t._v("\n~\n\n$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("pwd")]),t._v("\n~\n")])])]),a("p",[a("code",[t._v("pwd")]),t._v(" 查看当前文件夹，"),a("code",[t._v("dirname $0")]),t._v(" 查看运行的脚本所在文件夹。配合 "),a("code",[t._v("$()")]),t._v(" 语法可以直接切换到当前目录：")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("dirname")]),t._v(" $0"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v(")")])]),t._v("\n")])])]),a("h3",{attrs:{id:"查看文件-文件夹-磁盘的大小"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查看文件-文件夹-磁盘的大小"}},[t._v("#")]),t._v(" 查看文件/文件夹/磁盘的大小")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("中文")]),t._v(" "),a("th",[t._v("英文")]),t._v(" "),a("th",[t._v("命令")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("查看磁盘大小")]),t._v(" "),a("td",[a("strong",[t._v("d")]),t._v("isplay "),a("strong",[t._v("f")]),t._v("ilesystem")]),t._v(" "),a("td",[a("code",[t._v("df -h")])])]),t._v(" "),a("tr",[a("td",[t._v("查看目录下的文件大小")]),t._v(" "),a("td",[a("strong",[t._v("l")]),t._v("i"),a("strong",[t._v("s")]),t._v("t")]),t._v(" "),a("td",[a("code",[t._v("ls -hs")])])]),t._v(" "),a("tr",[a("td",[t._v("查看目录下的文件夹的大小")]),t._v(" "),a("td",[a("strong",[t._v("d")]),t._v("isk "),a("strong",[t._v("u")]),t._v("sage")]),t._v(" "),a("td",[a("code",[t._v("du -h --max-depth=1")])])])])]),t._v(" "),a("p",[t._v("以上的 "),a("code",[t._v("-h")]),t._v(" 都是 "),a("code",[t._v("--human-readable")]),t._v("，不使用这个开关，则会使用一个数字表示大小（单位为 "),a("code",[t._v("KB")]),t._v("）；使用开关后，则会使用 "),a("code",[t._v("200K")]),t._v("，"),a("code",[t._v("1.8G")]),t._v(" 的形式。"),a("br"),t._v("\n注意 "),a("code",[t._v("du")]),t._v(" 如不加 "),a("code",[t._v("--max-depth")]),t._v(" 参数，会统计完所有的目录。")]),t._v(" "),a("h2",{attrs:{id:"进程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#进程"}},[t._v("#")]),t._v(" 进程")]),t._v(" "),a("h3",{attrs:{id:"任务管理器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#任务管理器"}},[t._v("#")]),t._v(" 任务管理器")]),t._v(" "),a("p",[t._v("可以使用 "),a("code",[t._v("top")]),t._v(" 或 "),a("code",[t._v("htop")]),t._v("（后者对鼠标、颜色支持更好）。")]),t._v(" "),a("h3",{attrs:{id:"进程后台运行"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#进程后台运行"}},[t._v("#")]),t._v(" 进程后台运行")]),t._v(" "),a("h4",{attrs:{id:"使用-nohup"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用-nohup"}},[t._v("#")]),t._v(" 使用 nohup")]),t._v(" "),a("p",[t._v("使用 "),a("code",[t._v("nohup")]),t._v(" 的话，一行代码就 ok：")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# nohup <command> & &>/dev/null")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("nohup")]),t._v(" ssserver "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&>")]),t._v(" /dev/null\n")])])]),a("p",[t._v("可能会看到 "),a("code",[t._v("ignore input")]),t._v(" 之类的警告，不用管，"),a("code",[t._v("Ctrl+C")]),t._v(" 退出前台即可，此时 "),a("code",[t._v("ssserver")]),t._v(" 正在后台运行。")]),t._v(" "),a("h4",{attrs:{id:"使用-pm2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用-pm2"}},[t._v("#")]),t._v(" 使用 pm2")]),t._v(" "),a("p",[t._v("这个要麻烦一点，要从 "),a("code",[t._v("npm")]),t._v(" 下载，所以还得先下载 "),a("code",[t._v("npm")]),t._v("。")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" pm2 -g\npm2 --name s1 -f start http-server "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 配置 pm2")]),t._v("\n\npm2 save "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 可选命令，作用是保存当前的 pm2 状态")]),t._v("\npm2 startup "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 可选命令，下次开机的时候可以恢复到 save 的状态")]),t._v("\n\npm2 "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ls")]),t._v("   "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 可选命令，列出当前 pm2 的任务")]),t._v("\n")])])]),a("h4",{attrs:{id:"使用-systemd"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用-systemd"}},[t._v("#")]),t._v(" 使用 systemd")]),t._v(" "),a("p",[t._v("也可以配置 systemd。以下是一个模板。")]),t._v(" "),a("div",{staticClass:"language-ini extra-class"},[a("pre",{pre:!0,attrs:{class:"language-ini"}},[a("code",[a("span",{pre:!0,attrs:{class:"token header"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token section-name selector"}},[t._v("Unit")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("Description")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("Frp Server Service")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("After")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("network.target")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token header"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token section-name selector"}},[t._v("Service")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("Type")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("simple")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("User")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("lyh543")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("Restart")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("on-failure")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("RestartSec")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("5s")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("ExecStart")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("sudo /usr/bin/frps -c /etc/frp/frps.ini")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token header"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token section-name selector"}},[t._v("Install")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("WantedBy")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("multi-user.target")]),t._v("\n")])])]),a("p",[t._v("将其保存在 "),a("code",[t._v("/etc/systemd/system/xxx.service")]),t._v(" 后：")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("systemctl "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("enable")]),t._v(" /etc/systemd/system/xxx.service\nsystemctl start xxx\n")])])]),a("p",[t._v("即可。")]),t._v(" "),a("h3",{attrs:{id:"进程开机自启"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#进程开机自启"}},[t._v("#")]),t._v(" 进程开机自启")]),t._v(" "),a("p",[t._v("在 "),a("code",[t._v("sudo /etc/rc.local")]),t._v(" 最后追加命令，然后给权限 "),a("code",[t._v("sudo chmod a+x /etc/rc.local")]),t._v(" 即可。")]),t._v(" "),a("p",[t._v("不过貌似 "),a("code",[t._v("alias")]),t._v(" 语句无效，可能 "),a("code",[t._v("alias")]),t._v(" 是用户级的命令，需要用户登录时执行。")]),t._v(" "),a("p",[t._v("也可以配置 systemd。")]),t._v(" "),a("h2",{attrs:{id:"用户"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#用户"}},[t._v("#")]),t._v(" 用户")]),t._v(" "),a("h3",{attrs:{id:"添加用户并给予-sudo-权限"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#添加用户并给予-sudo-权限"}},[t._v("#")]),t._v(" 添加用户并给予 sudo 权限")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("useradd")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("newuser"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" --disabled-password  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 禁用密码，只允许 ssh 登录")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("usermod")]),t._v(" -aG "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("newuser"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("             "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 将用户加入 sudo 组")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" -u "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("newuser"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("                           "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 上号")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),t._v(" ~/.ssh/authorized_keys "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ssh-rsa xx"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 添加 ssh 公钥")]),t._v("\n")])])]),a("p",[t._v("然后上号 "),a("code",[t._v("sudo")]),t._v(" 检查一下是不是可以了。如果不行，可以试试在 "),a("code",[t._v("/etc/sudoers")]),t._v(" 里面修改 "),a("code",[t._v("%sudo")]),t._v(" 一行：")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("%sudo   "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("ALL")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ALL:ALL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" NOPASSWD:ALL\n")])])]),a("h2",{attrs:{id:"ssh"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ssh"}},[t._v("#")]),t._v(" ssh")]),t._v(" "),a("p",[t._v("在使用 Git 和搭建服务器的时候都会用到 ssh，于是笔记也比较零散。")]),t._v(" "),a("p",[t._v("在这里丢几个链接：")]),t._v(" "),a("ul",[a("li",[a("RouterLink",{attrs:{to:"/_posts/git/#在-Linux-下-git-使用-ssh-密钥"}},[t._v("创建 ssh 密钥并给 Git/服务器使用")])],1),t._v(" "),a("li",[a("RouterLink",{attrs:{to:"/_posts/build-shadowsocks/#ssh-远程登录"}},[t._v("ssh 远程登录服务器")])],1),t._v(" "),a("li",[a("RouterLink",{attrs:{to:"/_posts/change-ssh-port/"}},[t._v("修改 ssh 的端口")])],1),t._v(" "),a("li",[a("RouterLink",{attrs:{to:"/microsoft/windows/setup-ssh-windows/"}},[t._v("Windows 上使用 ssh")])],1)]),t._v(" "),a("h2",{attrs:{id:"log"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#log"}},[t._v("#")]),t._v(" log")]),t._v(" "),a("h3",{attrs:{id:"查看-shell-启动过程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查看-shell-启动过程"}},[t._v("#")]),t._v(" 查看 Shell 启动过程")]),t._v(" "),a("p",[t._v("可以用来追踪环境变量在哪里被修改。")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# bash")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("PS4")])]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'+$BASH_SOURCE> '")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("BASH_XTRACEFD")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("7")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("bash")]),t._v(" -xl "),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("7")]),t._v(">")]),a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("&2")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# zsh")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("zsh")]),t._v(" -xl\n")])])])])}),[],!1,null,null,null);s.default=r.exports}}]);