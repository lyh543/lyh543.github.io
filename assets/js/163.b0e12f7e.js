(window.webpackJsonp=window.webpackJsonp||[]).push([[163],{562:function(s,t,a){"use strict";a.r(t);var e=a(3),r=Object(e.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"前言"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#前言"}},[s._v("#")]),s._v(" 前言")]),s._v(" "),a("p",[s._v("本文就记流水账一般，记录一下，方便以后再配置的时候查阅。这些方法基本都是可以百度到的。")]),s._v(" "),a("blockquote",[a("p",[s._v("2019.12.1 更新：发现周围有些人在问我如何搭建代理，我直接把这篇文章分享给他们，但是发现这篇博客写的太浅薄了，对新手也不够友好。最近也挺忙，要是有空，就再把这篇文章写的更加详实吧。先挖点坑：")])]),s._v(" "),a("ul",[a("li",[s._v("为什么有些网站无法访问")]),s._v(" "),a("li",[s._v("如何访问这些网站（借助一个中介，介绍 Shadowsocks 原理）")]),s._v(" "),a("li",[s._v("服务器是什么？虚拟服务器是什么？如何使用？（介绍 ssh）")])]),s._v(" "),a("p",[s._v("对于萌新，你们可能需要提前准备：")]),s._v(" "),a("ul",[a("li",[s._v("以下三选一（个人推荐 wsl）：\n"),a("ul",[a("li",[s._v("Ubuntu 双系统或虚拟机（如果你看不懂这个选项可以直接跳过）")]),s._v(" "),a("li",[s._v("wsl（百度“WSL(Windows Subsystem for Linux)的安装与使用”）")]),s._v(" "),a("li",[a("RouterLink",{attrs:{to:"/Windows/setup-ssh-windows/"}},[s._v("Windows 的 ssh 客户端")]),s._v("（不推荐，但是如果你电脑的硬盘实在不够用了，可以选择这个选项）")],1)])]),s._v(" "),a("li",[s._v("准备好学习 Linux 命令行的决心")]),s._v(" "),a("li",[s._v("愿意在遇到问题的时候上网搜索，即使可能消耗十几分钟到一整天的时间")])]),s._v(" "),a("p",[s._v("本文正式开始。")]),s._v(" "),a("h2",{attrs:{id:"租服务器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#租服务器"}},[s._v("#")]),s._v(" 租服务器")]),s._v(" "),a("p",[s._v("首先，去租阿里云或腾讯云的虚拟服务器。学生的话，都是一月 10 元即可（找不到入口可以在知乎搜一下相关回答）。")]),s._v(" "),a("p",[s._v("系统推荐使用 Debian 或 Ubuntu。")]),s._v(" "),a("p",[s._v("租了服务器以后，会给你的服务器的 ip 地址（下面为方便叙述，设为 "),a("code",[s._v("39.1.2.3")]),s._v("）和密码。")]),s._v(" "),a("h2",{attrs:{id:"ssh-远程登录服务器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ssh-远程登录服务器"}},[s._v("#")]),s._v(" ssh 远程登录服务器")]),s._v(" "),a("p",[s._v("ssh 是什么，可以见前言。")]),s._v(" "),a("p",[s._v("注意"),a("strong",[s._v("阿里云的服务器要开放防火墙的端口，不然连不上")]),s._v("！！！！！！！！"),a("br"),s._v("\n作者就是被这个坑了一下午还没弄好。上面需要开放 "),a("code",[s._v("22")]),s._v(" 端口，协议选 "),a("code",[s._v("tcp")]),s._v("。")]),s._v(" "),a("p",[s._v("在本地 Ubuntu（或 wsl 或 "),a("RouterLink",{attrs:{to:"/Windows/setup-ssh-windows/"}},[s._v("Windows 的 ssh 客户端")]),s._v("）使用 "),a("code",[s._v("ssh -p22 root@39.1.2.3")]),s._v(" 登录远程服务器。")],1),s._v(" "),a("p",[s._v("要是出现 "),a("code",[s._v("ssh: connect to host 39.1.2.3 port 22: Resource temporarily unavailable")]),s._v("，"),a("br"),s._v("\n再本地尝试 "),a("code",[s._v("ping 39.1.2.3")]),s._v("，要是连不上，说明 ip 被封了，需要删掉服务器，重新建一台服务器。")]),s._v(" "),a("h2",{attrs:{id:"服务器配置-shadowsocks"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#服务器配置-shadowsocks"}},[s._v("#")]),s._v(" 服务器配置 Shadowsocks")]),s._v(" "),a("p",[s._v("成功连上以后，在服务器安装 shadowsocks-libev：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt")]),s._v(" update "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# debian 下是 apt，CentOS 换成 yum install 即可")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" shadowsocks-libev\n")])])]),a("p",[s._v("修改配置文件：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("nano")]),s._v(" /etc/shadowsocks-libev/config.json\n")])])]),a("p",[s._v("修改为以下内容：")]),s._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"server"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"0.0.0.0"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"server_port"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("443")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"local_port"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1080")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"password"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"lyh543"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"timeout"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("600")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"method"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"aes-256-cfb"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"fast_open"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),a("p",[s._v("注意：")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("server")]),s._v(" 不能为 "),a("code",[s._v("127.0.0.1")]),s._v("，不然连不上；")]),s._v(" "),a("li",[a("code",[s._v("server_port")]),s._v(" 建议不要使用默认的 "),a("code",[s._v("8838")]),s._v("，可以修改为 "),a("code",[s._v("0-65535")]),s._v(" 间的其他端口，比如 "),a("code",[s._v("22222")]),s._v("；")]),s._v(" "),a("li",[s._v("如果有："),a("code",[s._v("local_address")]),s._v(" 必须删掉；")]),s._v(" "),a("li",[a("code",[s._v("password")]),s._v(" 改为自己设的密码。")])]),s._v(" "),a("p",[s._v("然后执行 "),a("code",[s._v("ss-server")]),s._v("（CentOS 下是 "),a("code",[s._v("ssserver -c /etc/shadowsocks.json")]),s._v("）。理论上服务器端就配置好了。")]),s._v(" "),a("p",[s._v("在本地下载 Shadowsocks， 并修改 Shadowsocks 配置（具体过程略），就可以进行连接了。（再次提醒，记得开放服务器的对应端口"),a("s",[s._v("不然你一个小时又没了")]),s._v("，这里是 "),a("code",[s._v("443")]),s._v("，协议选 "),a("code",[s._v("tcp")]),s._v("）。")]),s._v(" "),a("p",[s._v("如果连接以后，随便上一个网站，看到服务器上出现 "),a("code",[s._v("INFO connecting www.baidu.com:443 from x.x.x.x")]),s._v("，那么恭喜你，成功啦！")]),s._v(" "),a("h2",{attrs:{id:"服务器上后台运行"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#服务器上后台运行"}},[s._v("#")]),s._v(" 服务器上后台运行")]),s._v(" "),a("p",[s._v("由于服务器一般是不断电一直运行的。因此一般不用考虑开机自启的。但是后台运行比较重要：")]),s._v(" "),a("p",[s._v("使用 "),a("code",[s._v("nohup")]),s._v(" 的话，一行代码就 ok：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# nohup <command> & &>/dev/null")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("nohup")]),s._v(" ssserver "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&>")]),s._v(" /dev/null\n")])])]),a("p",[s._v("（实际山 ssserver 自带了后台运行的方法，但是通用方法它不香吗）")]),s._v(" "),a("p",[s._v("到这里，Shadowsocks 的配置就基本完成了。")]),s._v(" "),a("h2",{attrs:{id:"番外篇-配置-bbr"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#番外篇-配置-bbr"}},[s._v("#")]),s._v(" 番外篇：配置 bbr")]),s._v(" "),a("p",[s._v("搭上梯子以后，发现有时候丢包率有 40% 左右。")]),s._v(" "),a("p",[s._v("Google 了一下，说是可以上 BBR。BBR 是什么，如何开启，可以看下面两篇博客，我就不再复读了。")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://tech.jandou.com/CentOS7-Google-BBR.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("Google BBR是什么？"),a("OutboundLink")],1)]),s._v(" "),a("p",[s._v("注意，BBR 是针对 TCP 发包的，也就是说，设置好以后，对于所有代理软件和服务器上的所有网页等都会生效。")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://www.moerats.com/archives/612/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Ubuntu 18.04/18.10快速开启Google BBR的方法"),a("OutboundLink")],1)]),s._v(" "),a("h2",{attrs:{id:"常见错误及解决方案"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#常见错误及解决方案"}},[s._v("#")]),s._v(" 常见错误及解决方案")]),s._v(" "),a("h3",{attrs:{id:"无法-ssh-登录远程服务器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#无法-ssh-登录远程服务器"}},[s._v("#")]),s._v(" 无法 ssh 登录远程服务器")]),s._v(" "),a("ul",[a("li",[s._v("尝试 ping 你的服务器，输入命令 "),a("code",[s._v("ping x.x.x.x")]),s._v("，如果显示 "),a("code",[s._v("100% 丢失")]),s._v("（或 "),a("code",[s._v("100% packet loss")]),s._v("），说明这个 ip 已经被墙了，需要删掉服务器，重新开一台；")]),s._v(" "),a("li",[s._v("可能没有开放服务器上的 "),a("code",[s._v("22")]),s._v(" 端口（协议为 "),a("code",[s._v("tcp")]),s._v("）？")])]),s._v(" "),a("h3",{attrs:{id:"服务端配置好了-本地连不上-连上以后显示-500-internal-proxy-error"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#服务端配置好了-本地连不上-连上以后显示-500-internal-proxy-error"}},[s._v("#")]),s._v(" 服务端配置好了，本地连不上/连上以后显示 500 Internal Proxy Error")]),s._v(" "),a("ul",[a("li",[s._v("可能是某些信息（如网址、密码、加密方式）没对应上，总之某些信息出锅了，而不是网络故障。")]),s._v(" "),a("li",[s._v("可能 Shadowsocks 使用的端口被屏蔽了，在"),a("a",{attrs:{href:"#%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%85%8D%E7%BD%AE-Shadowsocks"}},[s._v("服务端修改端口")]),s._v("，然后在本地客户端也修改为对应的端口，再尝试链接。")]),s._v(" "),a("li",[s._v("可能是端口被服务端其他进程占用了（可以通过命令 "),a("code",[s._v("lsof -i <端口号>")]),s._v(" 查看）。如果确实，再改一个。")])]),s._v(" "),a("p",[s._v("如果仍然没有搞定，可能需要通过查看 "),a("code",[s._v("nohup.out")]),s._v(" 文件来看 Shadowsocks 的日志的最后二十行：")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("tail -n 20 nohup.out\n")])])]),a("p",[s._v("然后上网百度 / Google。")])])}),[],!1,null,null,null);t.default=r.exports}}]);