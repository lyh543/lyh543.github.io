(window.webpackJsonp=window.webpackJsonp||[]).push([[220],{621:function(e,s,t){"use strict";t.r(s);var a=t(3),r=Object(a.a)({},(function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("p",[e._v("和其他操作系统一样，Windows 的端口占用问题是老生常谈的话题了。不过，由于 Hyper-V 技术的出现，端口占用的原因也不只一种，导致原来的方法可能不奏效。因此记录一下 Windows 端口占用的两种情况以及对应的解决方法。")]),e._v(" "),t("h2",{attrs:{id:"方法一-查询是否被其他应用占用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#方法一-查询是否被其他应用占用"}},[e._v("#")]),e._v(" 方法一：查询是否被其他应用占用")]),e._v(" "),t("p",[e._v("在管理员下的 powershell（2202 年了，也该学一下 powershell 了）：")]),e._v(" "),t("div",{staticClass:"language-powershell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-powershell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 管理员不是必需，但不用管理员可能看不到其他用户的进程？")]),e._v("\nnetstat "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("-")]),e._v("ano "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("|")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("Select-String")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"8080"')]),e._v("\n")])])]),t("p",[t("img",{attrs:{src:"/images/923159eedbc4e88c0b0ea00f3dff42e8fc276a44deff0e34eb31c65763757614.png",alt:"查询结果"}})]),e._v(" "),t("p",[e._v("11284 是 Process ID，可以直接 kill 掉，也可以看看是什么。")]),e._v(" "),t("div",{staticClass:"language-powershell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-powershell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[e._v("ps")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("-")]),e._v("PID 11284\n"),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("kill")]),e._v(" 11284\n")])])]),t("p",[t("img",{attrs:{src:"/images/270900e581c26de91ceb751eb13786d759ed1f074b1880dad7a25b8817c49607.png",alt:"查询结果"}})]),e._v(" "),t("h2",{attrs:{id:"方法二-查询是否被-hyper-v-占用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#方法二-查询是否被-hyper-v-占用"}},[e._v("#")]),e._v(" 方法二：查询是否被 Hyper-V 占用")]),e._v(" "),t("p",[e._v("以前的 Windows 在上面一步基本就能结束了，但现在是 2202 年，Docker 和 WSL 2 大行其道，干开发的应该都用着 Hyper-V。")]),e._v(" "),t("p",[e._v("而 Hyper-V 会保留一些端口，其他应用就不能占用了。")]),e._v(" "),t("p",[e._v("使用下面这行命令查询 Hyper-V 占用的端口：")]),e._v(" "),t("div",{staticClass:"language-powershell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-powershell"}},[t("code",[e._v("netsh interface ipv4 show excludedportrange protocol=tcp\n")])])]),t("p",[t("img",{attrs:{src:"/images/c78255c7d83cf302f4b3e12423dfd909c9905273faab77fb0cebf59c5f4435a6.png",alt:"查询 Hyper-V 占用的端口"}})]),e._v(" "),t("p",[e._v("图上没有 "),t("code",[e._v("*")]),e._v(" 的就是 Hyper-V 占用的端口。而加了 "),t("code",[e._v("*")]),e._v(" 的 "),t("code",[e._v("Administered port exclusions")]),e._v(" 就是我们保留的端口， Hyper-V 不会再占用。")]),e._v(" "),t("p",[e._v("如何保留端口呢？在管理员下的 powershell 使用下面这行命令：")]),e._v(" "),t("div",{staticClass:"language-powershell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-powershell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 保留 7962 开始的 100 个端口（即 7962-8061）")]),e._v("\nnetsh int ipv4 add excludedportrange protocol=tcp startport=7962 numberofports=100\n")])])]),t("p",[t("img",{attrs:{src:"/images/2a17482e2c835c9e3ef8fde3db60c6476f3f10a9dcc75ca76f3e23efe4cb7f3a.png",alt:"7962-8061 已为我们保留"}})]),e._v(" "),t("p",[e._v("如果执行的时候遇到 "),t("code",[e._v("netsh error: The process cannot access the file because it is being used by another process")]),e._v("，可以尝试重启电脑，或者关掉 Hyper-V、重启、保留完端口再打开 Hyper-V、重启。")]),e._v(" "),t("div",{staticClass:"language-powershell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-powershell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 关掉 Hyper-V")]),e._v("\ndism"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("exe "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("/")]),e._v("Online "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("/")]),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("Disable-Feature")]),e._v(":Microsoft"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("-")]),e._v("Hyper"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("-")]),e._v("V\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 开启 Hyper-V")]),e._v("\ndism"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("exe "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("/")]),e._v("Online "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("/")]),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("Enable-Feature")]),e._v(":Microsoft"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("-")]),e._v("Hyper"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("-")]),e._v("V "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("/")]),e._v("All\n")])])]),t("p",[e._v("Reference:")]),e._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"https://blog.csdn.net/m0_47696151/article/details/117785566",target:"_blank",rel:"noopener noreferrer"}},[e._v("Windows 下显示端口占用，却查不到占用进程_m0_47696151的博客-CSDN博客"),t("OutboundLink")],1)]),e._v(" "),t("li",[t("a",{attrs:{href:"https://stackoverflow.com/questions/58216537/what-is-administered-port-exclusions-in-windows-10",target:"_blank",rel:"noopener noreferrer"}},[e._v("What is Administered port exclusions in windows 10? - Stack Overflow"),t("OutboundLink")],1)])])])}),[],!1,null,null,null);s.default=r.exports}}]);