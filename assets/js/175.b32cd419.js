(window.webpackJsonp=window.webpackJsonp||[]).push([[175],{533:function(t,a,s){"use strict";s.r(a);var r=s(3),n=Object(r.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("p",[t._v("最近写的项目用到了 Gravatar 服务，但是 Gravatar 几个服务器都在外国，考虑到项目的用户有相当规模是没有梯子的国内用户，我开始寻找 Gravatar CDN。")]),t._v(" "),a("p",[t._v("网上 Gravatar CDN 参差不齐，有大站建的 CDN，也有网友自建的 CDN，于是简单写了一个 Python 脚本用于测速。")]),t._v(" "),a("p",[t._v("测试内容是两项：图片命中，和图片不命中后跳转到 GitHub 上的图片。各测试十次，取时间平均值，如果出现一次超时等 error 即报错。")]),t._v(" "),a("blockquote",[a("p",[t._v("脚本和测试结果均写于 2021.4.29，部分信息可能已失效。")])]),t._v(" "),a("div",{staticClass:"language-py extra-class"},[a("pre",{pre:!0,attrs:{class:"language-py"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" timeit "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" timeit\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" requests\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" os\n\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("tester")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("base_url"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("str")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" number"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("int")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 成功获取")]),t._v("\n    url1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" base_url "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'fd8b773755459a02294bffc322796b5d?size=300&default=https%3A%2F%2Fraw.githubusercontent.com%2Fuestc-msc%2Fuestcmsc_webapp_backend%2Flyh543%2Fstatic%2Fruanweiwei.jpg'")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 获取失败，跳转到 default")]),t._v("\n    url2 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" base_url "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"2333333?size=300&default=https%3A%2F%2Fraw.githubusercontent.com%2Fuestc-msc%2Fuestcmsc_webapp_backend%2Flyh543%2Fstatic%2Fruanweiwei.jpg"')]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'%.6f'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v(" timeit"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("lambda")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" requests"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("url1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" number"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("number"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" end"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("' '")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("except")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'error   '")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" end"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("' '")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'%.6f'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v(" timeit"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("lambda")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" requests"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("url2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" number"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("number"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("except")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'error   '")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" __name__ "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'__main__'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    mirrors "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https://gr.mirror.hardrain980.com/"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://gravatar.azureedge.com/avatar/"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https://gravatar.w3tt.com/avatar/"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https://dn-qiniu-avatar.qbox.me/avatar/"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https://gravatar.zeruns.tech/avatar/"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https://cdn.v2ex.com/gravatar/"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https://gravatar.loli.net/avatar/"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https://sdn.geekzu.org/avatar/"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        \n        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https://www.gravatar.com/avatar/"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https://cn.gravatar.com/avatar/"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https://en.gravatar.com/avatar/"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https://secure.gravatar.com/avatar/"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" mirror "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" mirrors"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string-interpolation"}},[a("span",{pre:!0,attrs:{class:"token string"}},[t._v("f'%-40s'")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v(" mirror"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" end"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("' '")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        tester"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("mirror"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[t._v("我的测试结果：")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("网站")]),t._v(" "),a("th",[t._v("命中")]),t._v(" "),a("th",[t._v("未命中，重定向")]),t._v(" "),a("th",[t._v("评价")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[a("code",[t._v("https://sdn.geekzu.org/avatar/")])]),t._v(" "),a("td",[t._v("6.261718")]),t._v(" "),a("td",[t._v("6.096203")]),t._v(" "),a("td",[a("strong",[t._v("极客族自建，推荐")])])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("https://gravatar.w3tt.com/avatar/")])]),t._v(" "),a("td",[t._v("6.598301")]),t._v(" "),a("td",[t._v("7.006393")]),t._v(" "),a("td",[a("strong",[t._v("w3tt 自建，推荐")])])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("https://dn-qiniu-avatar.qbox.me/avatar/")])]),t._v(" "),a("td",[t._v("1.828716")]),t._v(" "),a("td",[t._v("不支持")]),t._v(" "),a("td",[a("strong",[t._v("七牛自建，延迟最低，推荐，但不支持参数")])])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("https://cdn.v2ex.com/gravatar/")])]),t._v(" "),a("td",[t._v("error")]),t._v(" "),a("td",[t._v("error")]),t._v(" "),a("td",[t._v("v2ex 自建，可惜人家也在国外")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("https://gravatar.loli.net/avatar/")])]),t._v(" "),a("td",[t._v("10.047769")]),t._v(" "),a("td",[t._v("9.787379")]),t._v(" "),a("td",[t._v("免费个人图床，延迟较高")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("https://gravatar.zeruns.tech/avatar/")])]),t._v(" "),a("td",[t._v("9.166306")]),t._v(" "),a("td",[t._v("7.800450")]),t._v(" "),a("td",[t._v("网友自建")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("https://gr.mirror.hardrain980.com/")])]),t._v(" "),a("td",[t._v("7.885361")]),t._v(" "),a("td",[t._v("8.984500")]),t._v(" "),a("td",[t._v("网友自建")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("http://gravatar.azureedge.com/avatar/")])]),t._v(" "),a("td",[t._v("5.792183")]),t._v(" "),a("td",[t._v("5.848405")]),t._v(" "),a("td",[t._v("本人自建（说不定什么时候就跑路了）")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("https://www.gravatar.com/avatar/")])]),t._v(" "),a("td",[t._v("error")]),t._v(" "),a("td",[t._v("error")]),t._v(" "),a("td",[t._v("官方，没法用")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("https://cn.gravatar.com/avatar/")])]),t._v(" "),a("td",[t._v("error")]),t._v(" "),a("td",[t._v("error")]),t._v(" "),a("td",[t._v("即使 cn 也是在德国的官方")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("https://en.gravatar.com/avatar/")])]),t._v(" "),a("td",[t._v("error")]),t._v(" "),a("td",[t._v("error")]),t._v(" "),a("td",[t._v("官方，没法用")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("https://secure.gravatar.com/avatar/")])]),t._v(" "),a("td",[t._v("error")]),t._v(" "),a("td",[t._v("error")]),t._v(" "),a("td",[t._v("官方，没法用")])])])])])}),[],!1,null,null,null);a.default=n.exports}}]);