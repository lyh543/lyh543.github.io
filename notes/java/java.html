<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Java 学习笔记 | 小灰灰灰灰的博客</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/theme/favicon.png">
    <link rel="alternate" type="application/rss+xml" href="https://blog.lyh543.cn/rss.xml" title="小灰灰灰灰的博客 RSS Feed">
    <link rel="alternate" type="application/atom+xml" href="https://blog.lyh543.cn/feed.atom" title="小灰灰灰灰的博客 Atom Feed">
    <link rel="alternate" type="application/json" href="https://blog.lyh543.cn/feed.json" title="小灰灰灰灰的博客 JSON Feed">
    <meta name="description" content="很多都和 C 语言一样吧，这里记录一下和 C 的区别：

关于引用

没有指针，什么都是引用：数组元素是引用
判断引用的内容是否相等，要用 a.equals(b)；null.equals(a) 会报错，而 a.equals(null) 不会报错。
基本类型参数的传递，是传值；其他都是传引用。

I/O 输入与输出

输出

System. ...">
    
    <link rel="preload" href="/assets/css/0.styles.0eda1ac1.css" as="style"><link rel="preload" href="/assets/js/app.cbaac8cd.js" as="script"><link rel="preload" href="/assets/js/86.4b410550.js" as="script">
    <link rel="stylesheet" href="/assets/css/0.styles.0eda1ac1.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div data-app="true" id="app" class="v-application v-application--is-ltr theme--light"><div class="v-application--wrap"><!----> <main id="main-content" class="v-main" style="padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;"><div class="v-main__wrap"><div><div class="container"><div class="row justify-center"><div class="col-sm-9 col-12"><article itemscope="itemscope" itemtype="https://schema.org/BlogPosting" class="vuepress-blog-theme-content"><div class="v-card v-sheet theme--light"><div class="container"><div itemprop="articleBody" class="markdown-body content__default"><p>很多都和 C 语言一样吧，这里记录一下和 C 的区别：</p> <h2 id="关于引用"><a href="#关于引用" class="header-anchor">#</a> 关于引用</h2> <ul><li>没有指针，什么都是引用：数组元素是引用</li> <li>判断引用的内容是否相等，要用 <code>a.equals(b)</code>；<code>null.equals(a)</code> 会报错，而 <code>a.equals(null)</code> 不会报错。</li> <li>基本类型参数的传递，是传值；其他都是传引用。</li></ul> <h2 id="i-o-输入与输出"><a href="#i-o-输入与输出" class="header-anchor">#</a> I/O 输入与输出</h2> <h3 id="输出"><a href="#输出" class="header-anchor">#</a> 输出</h3> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>      <span class="token comment">// 不带换行</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token comment">// 自带换行</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token punctuation">)</span>     <span class="token comment">// 格式化输出，用法同 C</span>
</code></pre></div><h3 id="输入"><a href="#输入" class="header-anchor">#</a> 输入</h3> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Scanner</span><span class="token punctuation">;</span>

<span class="token class-name">Scanner</span> scanner <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Scanner</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>in<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">String</span> str <span class="token operator">=</span> scanner<span class="token punctuation">.</span><span class="token function">nextLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> age <span class="token operator">=</span> scanner<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="switch-语法和表达式-java-12"><a href="#switch-语法和表达式-java-12" class="header-anchor">#</a> switch 语法和表达式 (Java 12)</h2> <p>Java 11 及之前的 <code>switch</code> 都是类似 C 的语法：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">switch</span> <span class="token punctuation">(</span>fruit<span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token keyword">case</span> <span class="token string">&quot;apple&quot;</span><span class="token operator">:</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Selected apple&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">break</span><span class="token punctuation">;</span>
<span class="token keyword">case</span> <span class="token string">&quot;pear&quot;</span><span class="token operator">:</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Selected pear&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">break</span><span class="token punctuation">;</span>
<span class="token keyword">case</span> <span class="token string">&quot;mango&quot;</span><span class="token operator">:</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Selected mango&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">break</span><span class="token punctuation">;</span>
<span class="token keyword">default</span><span class="token operator">:</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;No fruit selected&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">break</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Java 12 以后，<code>switch</code> 语句支持新语法，这种语法用到了像是 <code>lambda</code> 表达式的 <code>-&gt;</code>，且不需要 <code>break</code>，非常简洁：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">int</span> option <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">switch</span> <span class="token punctuation">(</span>option<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token number">1</span> <span class="token operator">-&gt;</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Selected 1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">2</span> <span class="token operator">-&gt;</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Selected 2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">3</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">// 可以接大括号，做更复杂的事情</span>
        <span class="token comment">// other things...</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Selected 3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">default</span> <span class="token operator">-&gt;</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Not selected&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>在 <code>switch</code> 语句的基础上，又衍生出了 <code>switch</code> 表达式，每个分支都是一个表达式，最后的值就是 <code>switch</code> 表达式的值：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">int</span> option <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token class-name">String</span> str <span class="token operator">=</span> <span class="token keyword">switch</span> <span class="token punctuation">(</span>option<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token number">1</span> <span class="token operator">-&gt;</span> <span class="token string">&quot;Selected 1&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">2</span> <span class="token operator">-&gt;</span> <span class="token string">&quot;Selected 2&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">3</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">// 也可以接大括号，做更复杂的事情</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;User Selected 3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 使用 yield 返回</span>
        <span class="token keyword">yield</span> <span class="token string">&quot;Selected 3&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">default</span> <span class="token operator">-&gt;</span> <span class="token string">&quot;Not selected&quot;</span><span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="try-with-resource-语句"><a href="#try-with-resource-语句" class="header-anchor">#</a> try-with-resource 语句</h2> <p>Java 7 引入了 <code>try-with-resource</code> 语句，类似于 Python 的 <code>with ... as ...</code>。</p> <p>这个语法主要用于一些使用完成以后需要关闭的资源。对于这种资源，如果不及时关闭，可能会出现文件被占用等问题。</p> <p>下面的代码用原始方法实现了向文件写入 <code>hello, world</code> 以后再读取该文件内容。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">final</span> <span class="token class-name">String</span> filename <span class="token operator">=</span> <span class="token string">&quot;test.txt&quot;</span><span class="token punctuation">;</span>

<span class="token class-name">FileWriter</span> fileWriter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileWriter</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">BufferedWriter</span> bufferedWriter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BufferedWriter</span><span class="token punctuation">(</span>fileWriter<span class="token punctuation">)</span><span class="token punctuation">;</span>
bufferedWriter<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">&quot;hello world!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
bufferedWriter<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
fileWriter<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">FileReader</span> fileReader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileReader</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">BufferedReader</span> bufferedReader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BufferedReader</span><span class="token punctuation">(</span>fileReader<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>bufferedReader<span class="token punctuation">.</span><span class="token function">readLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
bufferedReader<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
fileReader<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>如果不关闭 <code>writer</code>，那么 <code>reader</code> 什么都读不到。</p> <p>这样的写法导致每次使用资源以后都需要手动关闭，不仅是麻烦，而且很容易出现忘记关闭的情况。</p> <p><code>try-with-resource</code> 就是解决这个问题，它将资源的使用放在一个语句块 <code>{ }</code> 中，语句块结束以后就会自动调用资源的 <code>close</code> 方法。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">try</span> <span class="token punctuation">(</span><span class="token class-name">FileWriter</span> fileWriter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileWriter</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token class-name">BufferedWriter</span> bufferedWriter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BufferedWriter</span><span class="token punctuation">(</span>fileWriter<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    bufferedWriter<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">&quot;hello world!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">try</span> <span class="token punctuation">(</span><span class="token class-name">FileReader</span> fileReader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileReader</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token class-name">BufferedReader</span> bufferedReader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BufferedReader</span><span class="token punctuation">(</span>fileReader<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>bufferedReader<span class="token punctuation">.</span><span class="token function">readLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>这种写法非常方便，而让一个类支持这种语法也非常方便：让这个类实现 <code>AutoClosable</code> 接口的 <code>close</code> 方法即可：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Analyzer</span> <span class="token keyword">implements</span> <span class="token class-name">AutoCloseable</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">FileReader</span> inputFileReader<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">FileWriter</span> outputFileWriter<span class="token punctuation">,</span> errorFileWriter<span class="token punctuation">;</span>

    <span class="token keyword">protected</span> <span class="token class-name">BufferedReader</span> inputBufferedReader<span class="token punctuation">;</span>
    <span class="token keyword">protected</span> <span class="token class-name">BufferedWriter</span> outputBufferedWriter<span class="token punctuation">,</span> errorBufferedWriter<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">Analyzer</span><span class="token punctuation">(</span><span class="token class-name">String</span> inputFilename<span class="token punctuation">,</span>
                    <span class="token class-name">String</span> outputFilename<span class="token punctuation">,</span>
                    <span class="token class-name">String</span> errorFilename<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        inputFileReader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileReader</span><span class="token punctuation">(</span>inputFilename<span class="token punctuation">)</span><span class="token punctuation">;</span>
        inputBufferedReader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BufferedReader</span><span class="token punctuation">(</span>inputFileReader<span class="token punctuation">)</span><span class="token punctuation">;</span>

        outputFileWriter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileWriter</span><span class="token punctuation">(</span>outputFilename<span class="token punctuation">)</span><span class="token punctuation">;</span>
        outputBufferedWriter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BufferedWriter</span><span class="token punctuation">(</span>outputFileWriter<span class="token punctuation">)</span><span class="token punctuation">;</span>

        errorFileWriter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileWriter</span><span class="token punctuation">(</span>errorFilename<span class="token punctuation">)</span><span class="token punctuation">;</span>
        errorBufferedWriter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BufferedWriter</span><span class="token punctuation">(</span>errorFileWriter<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        inputBufferedReader<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        outputBufferedWriter<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        errorBufferedWriter<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        inputFileReader<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        outputFileWriter<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        errorFileWriter<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="方法的可变参数"><a href="#方法的可变参数" class="header-anchor">#</a> 方法的可变参数</h2> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">setNames</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> names<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 此时 names 是 String[]</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token operator">:</span> names<span class="token punctuation">)</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">printNames</span><span class="token punctuation">(</span><span class="token string">&quot;Alice&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Bob&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 输出 AliceBob</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="oop-面向对象"><a href="#oop-面向对象" class="header-anchor">#</a> OOP 面向对象</h2> <h3 id="extends"><a href="#extends" class="header-anchor">#</a> extends</h3> <p>继承使用 <code>extends</code> 作为关键字：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">Student</span> <span class="token keyword">extends</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span>
</code></pre></div><p>Java 只允许一个 class 继承自一个类，所以没有多继承。但是 Java 也提供了接口。</p> <h3 id="super"><a href="#super" class="header-anchor">#</a> super</h3> <p>超类使用 <code>super</code> 作为关键字。子类引用父类的字段时，<code>name</code> <code>this.name</code> 和 <code>super.name</code> 是等价的。</p> <hr> <p><code>super</code> 还会用于子类方法中调用父类方法的时候。</p> <p>在子类的构造方法中，<code>super()</code> 表示调用父类的构造方法，且这句话必须出现在子类构造方法的第一行（不过，如果只是调用父类的默认构造方法，这行可以省略），否则会报错：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">Student</span> <span class="token keyword">extends</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
    <span class="token keyword">protected</span> <span class="token keyword">int</span> score<span class="token punctuation">;</span>

    <span class="token comment">// java: 对super的调用必须是构造器中的第一个语句</span>
    <span class="token keyword">public</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token keyword">int</span> age<span class="token punctuation">,</span> <span class="token keyword">int</span> score<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>score <span class="token operator">=</span> score<span class="token punctuation">;</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> age<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><hr> <p>在后面<a href="#override">覆写</a>部分，还会有子类方法调用父类方法的情况，调用方式也是 <code>super.methodName();</code>。</p> <h3 id="final"><a href="#final" class="header-anchor">#</a> final</h3> <p>final 可以用于定义类、方法、或变量。定义后的类不能被继承，定义后的方法不能被覆写。而定义后的变量在初始化后不能被修改（类似于 <code>const</code>）。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">final</span> <span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>

<span class="token comment">// java: 无法从最终Person进行继承</span>
<span class="token keyword">class</span> <span class="token class-name">Student</span> <span class="token keyword">extends</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="static"><a href="#static" class="header-anchor">#</a> static</h3> <p>静态字段和静态方法都是属于类的，所有示例共用一套。</p> <p>虽然可以使用 <code>实例变量.静态字段</code> 访问，但是还是推荐使用 <code>类名.静态字段</code> 访问静态字段以及静态方法。</p> <p>静态方法不能访问实例的变量。</p> <p>静态方法经常用于工具类。例如：<code>Arrays.sort()</code> <code>Math.random()</code>。</p> <h3 id="向上转型和向下转型"><a href="#向上转型和向下转型" class="header-anchor">#</a> 向上转型和向下转型</h3> <p>其实就是子类的实例可以赋给父类的引用。</p> <p>向下转型失败会报 <code>ClassCastException</code>：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">Person</span> p1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// upcasting, ok</span>
<span class="token class-name">Person</span> p2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Student</span> s1 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Student</span><span class="token punctuation">)</span> p1<span class="token punctuation">;</span> <span class="token comment">// ok</span>
<span class="token class-name">Student</span> s2 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Student</span><span class="token punctuation">)</span> p2<span class="token punctuation">;</span> <span class="token comment">// runtime error! ClassCastException!</span>
</code></pre></div><p>可以提前使用 <code>instanceof</code> 判断实例的类型：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">Person</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>p <span class="token keyword">instanceof</span> <span class="token class-name">Person</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>p <span class="token keyword">instanceof</span> <span class="token class-name">Student</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// false</span>

<span class="token class-name">Student</span> s <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s <span class="token keyword">instanceof</span> <span class="token class-name">Person</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s <span class="token keyword">instanceof</span> <span class="token class-name">Student</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>

<span class="token class-name">Student</span> n <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>n <span class="token keyword">instanceof</span> <span class="token class-name">Student</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// false</span>
</code></pre></div><p>Java 14 还提供了简写，在 <code>instanceof</code> 后自动完成了转换：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">Object</span> obj <span class="token operator">=</span> <span class="token string">&quot;hello&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>obj <span class="token keyword">instanceof</span> <span class="token class-name">String</span> s<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 可以直接使用变量s:</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="override"><a href="#override" class="header-anchor">#</a> Override</h3> <p>Java 中，子类如果定义了一个与父类方法签名完全相同的方法，被称为覆写（Override）。如果签名不同，就是普通的函数重载（Overload）。</p> <p>可以用 <code>@Override</code> 显式地声明覆写方法，IDE 会对父子类方法的签名进行比对；也可以不写。</p> <p>Java 对多态的支持也是动态的：对一个引用类型调用某方法，是调用引用实例的实际对象的方法，而不是这个引用的类的方法。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">Person</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
p<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 实际调用的是 Student 的 run</span>
</code></pre></div><h3 id="object-methods"><a href="#object-methods" class="header-anchor">#</a> Object methods</h3> <p>所有的 class 最终都继承自 Object。Object 定义了几个重要的方法：</p> <ul><li><code>toString()</code>：把 instance 输出为 String；</li> <li><code>equals()</code>：判断两个 instance 是否逻辑相等；</li> <li><code>hashCode()</code>：计算一个 instance 的哈希值。</li></ul> <p>在需要的时候，可以覆写 Object 的这几个方法。</p> <h3 id="abstract"><a href="#abstract" class="header-anchor">#</a> abstract</h3> <p><code>abstract methods</code>（抽象方法），和 C++ 的 <code>virtual functions</code>（虚函数）是一样的，都是没有定义的函数，只是为子类提供一个签名。</p> <p>包含抽象方法的类叫做抽象类。抽象类不能被实例化。只有在抽象类的子类中把所有抽象方法实现后，才能实例化这个子类。</p> <h3 id="interface-implements-extends"><a href="#interface-implements-extends" class="header-anchor">#</a> interface &amp; implements &amp; extends</h3> <h4 id="用-interface-定义接口"><a href="#用-interface-定义接口" class="header-anchor">#</a> 用 interface 定义接口</h4> <p>如果一个抽象类没有成员，并且所有方法都是抽象方法，这个抽象类就可以被改写为接口 <code>interface</code>。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// 改写前的抽象类</span>
<span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token class-name">String</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 改写后的抽象方法</span>
<span class="token keyword">interface</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
    <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="具体的类使用-implements-实现接口"><a href="#具体的类使用-implements-实现接口" class="header-anchor">#</a> 具体的类使用 implements 实现接口</h4> <p>需要注意的是，子类去继承抽象类，使用的是 <code>extends</code>；而一个具体的类实现接口的时候，使用的是 <code>implements</code>：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">Student</span> <span class="token keyword">implements</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
    <span class="token comment">//...</span>
</code></pre></div><hr> <p>Java 不允许多继承，但允许实现多个接口：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">Student</span> <span class="token keyword">implements</span> <span class="token class-name">Person</span><span class="token punctuation">,</span> <span class="token class-name">Hello</span> <span class="token punctuation">{</span>
    <span class="token comment">// 实现了两个interface</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="子接口使用-extends-扩展父接口"><a href="#子接口使用-extends-扩展父接口" class="header-anchor">#</a> 子接口使用 extends 扩展父接口</h4> <p>而接口又是允许使用 <code>extends</code> 关键字来继承的。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">interface</span> <span class="token class-name">Hello</span> <span class="token punctuation">{</span>
    <span class="token keyword">void</span> <span class="token function">hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">interface</span> <span class="token class-name">Person</span> <span class="token keyword">extends</span> <span class="token class-name">Hello</span> <span class="token punctuation">{</span>
    <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="接口也可以用-default-定义非抽象方法"><a href="#接口也可以用-default-定义非抽象方法" class="header-anchor">#</a> 接口也可以用 default 定义非抽象方法</h4> <p>实现类可以不必覆写 <code>default</code> 方法。<code>default</code> 方法的目的是，当我们需要给接口新增一个方法时，会涉及到修改全部子类。如果新增的是 <code>default</code> 方法，那么子类就不必全部修改，只需要在需要覆写的地方去覆写新增方法。</p> <p><code>default</code> 方法和抽象类的普通方法是有所不同的。因为 <code>interface</code> 没有字段，故 <code>default</code> 方法无法访问字段，而抽象类的普通方法可以访问实例字段。</p> <h4 id="接口也可以有-public-static-final-字段"><a href="#接口也可以有-public-static-final-字段" class="header-anchor">#</a> 接口也可以有 public static final 字段</h4> <p>接口不能有实例字段，但是可以有 <code>public static final</code> 字段，并且可以省略。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
    <span class="token comment">// 编译器会自动加上public statc final:</span>
    <span class="token keyword">int</span> MALE <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> FEMALE <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="package"><a href="#package" class="header-anchor">#</a> package</h3> <p><code>package</code> 其实就是 Java 的名称空间。</p> <p>一个文件就是一个包。用 <code>package</code> 声明一个包。<code>import</code> 引入一个包类。</p> <p>包可以使用域名倒置的形式命名，同时文件的存放位置最好也要和包的顺序相同。</p> <div class="language- extra-class"><pre class="language-text"><code>org.apache
org.apache.commons.log
com.liaoxuefeng.sample
</code></pre></div><h3 id="class-套娃"><a href="#class-套娃" class="header-anchor">#</a> class 套娃</h3> <p>class 套娃的用法会有一点不一样。内部类一定要依附于一个外部类实例。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Outer</span> outer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Outer</span><span class="token punctuation">(</span><span class="token string">&quot;Nested&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 实例化一个Outer</span>
        <span class="token class-name">Outer<span class="token punctuation">.</span>Inner</span> inner <span class="token operator">=</span> outer<span class="token punctuation">.</span><span class="token keyword">new</span> <span class="token class-name">Inner</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 实例化一个Inner</span>
        inner<span class="token punctuation">.</span><span class="token function">hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Outer</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>

    <span class="token class-name">Outer</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">class</span> <span class="token class-name">Inner</span> <span class="token punctuation">{</span>
        <span class="token keyword">void</span> <span class="token function">hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Hello, &quot;</span> <span class="token operator">+</span> <span class="token class-name">Outer</span><span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="javabean-风格的类"><a href="#javabean-风格的类" class="header-anchor">#</a> JavaBean 风格的类</h2> <p>如果读写方法符合以下这种命名规范：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// 读其他字段方法:</span>
<span class="token keyword">public</span> <span class="token class-name">Type</span> <span class="token function">getXyz</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// 读 boolean 方法:</span>
<span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">isChild</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// 写方法:</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setXyz</span><span class="token punctuation">(</span><span class="token class-name">Type</span> value<span class="token punctuation">)</span>
</code></pre></div><p>那么这种 <code>class</code> 被称为 <code>JavaBean</code>。</p> <h2 id="enum-枚举类"><a href="#enum-枚举类" class="header-anchor">#</a> Enum 枚举类</h2> <p>使用普通类的实现方法：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Weekday</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> SUN <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> MON <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> TUE <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> WED <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> THU <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> FRI <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> SAT <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>day <span class="token operator">==</span> <span class="token class-name">Weekday</span><span class="token punctuation">.</span>SAT <span class="token operator">||</span> day <span class="token operator">==</span> <span class="token class-name">Weekday</span><span class="token punctuation">.</span>SUN<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// TODO: work at home</span>
<span class="token punctuation">}</span>
</code></pre></div><p>也可以使用 <code>enum</code> 定义枚举类：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Weekday</span> day <span class="token operator">=</span> <span class="token class-name">Weekday</span><span class="token punctuation">.</span>SUN<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>day <span class="token operator">==</span> <span class="token class-name">Weekday</span><span class="token punctuation">.</span>SAT <span class="token operator">||</span> day <span class="token operator">==</span> <span class="token class-name">Weekday</span><span class="token punctuation">.</span>SUN<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Work at home!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Work at office!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">enum</span> <span class="token class-name">Weekday</span> <span class="token punctuation">{</span>
    SUN<span class="token punctuation">,</span> MON<span class="token punctuation">,</span> TUE<span class="token punctuation">,</span> WED<span class="token punctuation">,</span> THU<span class="token punctuation">,</span> FRI<span class="token punctuation">,</span> SAT<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>enum 定义的类型继承于 <code>java.lang.Enum</code>，该类提供了一些方法：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// name() 返回常量名</span>
<span class="token class-name">String</span> s <span class="token operator">=</span> <span class="token class-name">Weekday</span><span class="token punctuation">.</span>SUN<span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;SUN&quot;</span>
<span class="token comment">// ordinal() 返回定义的常量的顺序，从0开始计数</span>
<span class="token keyword">int</span> n <span class="token operator">=</span> <span class="token class-name">Weekday</span><span class="token punctuation">.</span>MON<span class="token punctuation">.</span><span class="token function">ordinal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 1 </span>
</code></pre></div><h2 id="record-记录类-java-14"><a href="#record-记录类-java-14" class="header-anchor">#</a> Record 记录类 (Java 14)</h2> <p>Java 14 引入的 Record 能够方便的定义每个字段为 <code>final</code> 的 <code>final class</code>。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">record</span> <span class="token class-name">Point</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span> <span class="token keyword">int</span> y<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div><p>等价于：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">class</span> <span class="token class-name">Point</span> <span class="token keyword">extends</span> <span class="token class-name">Record</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">int</span> x<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">int</span> y<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">Point</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span> <span class="token keyword">int</span> y<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>x <span class="token operator">=</span> x<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>y <span class="token operator">=</span> y<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">x</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>x<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">y</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>y<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">&quot;Point[x=%s, y=%s]&quot;</span><span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">equals</span><span class="token punctuation">(</span><span class="token class-name">Object</span> o<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="exception-异常"><a href="#exception-异常" class="header-anchor">#</a> Exception 异常</h2> <p>捕获异常：</p> <p>在方法定义的时候，使用 <code>throws Xxx</code> 表示该方法可能抛出的异常类型。调用方在调用的时候，必须强制捕获这些异常，否则编译器会报错。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token class-name">String</span> charsetName<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">UnsupportedEncodingException</span> <span class="token punctuation">{</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre></div><p>调用方也可以不捕获异常，而是在调用方所在的方法定义处也写一个 <code>throws Xxx</code>，就可以通过编译了。</p> <p>也就是说，如果不想在 Main 里面捕获任何异常的话，可以给 Main 函数定义 <code>throws Exception</code>：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre></div><hr> <p>Exception 提供了 <code>e.printStackTrace()</code> 函数（准确的说是 <code>Throwable</code> 提供的），打印异常调用栈。</p> <h3 id="异常屏蔽"><a href="#异常屏蔽" class="header-anchor">#</a> 异常屏蔽</h3> <p>如果在执行 <code>catch</code> 和 <code>finally</code> 语句时都抛出了异常，会导致 <code>catch</code> 语句的异常不能被抛出。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token string">&quot;abc&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;catched&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;finally&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalArgumentException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>结果如下：</p> <div class="language- extra-class"><pre class="language-text"><code>catched
finally
Exception in thread &quot;main&quot; java.lang.IllegalArgumentException
	at Main.main(Main.java:10)
</code></pre></div><p>也有解决办法，但 IDEA 不推荐在 <code>finally</code> 下抛出错误，就略过了。</p> <h2 id="reflection-反射"><a href="#reflection-反射" class="header-anchor">#</a> Reflection 反射</h2> <p>JVM 加载 class 的原理是：在运行的时候，Java 会为每一个类创建一个 <code>Class</code> 类型的实例，包含了类的很多信息：</p> <div class="language- extra-class"><pre class="language-text"><code>┌───────────────────────────┐
│      Class Instance       │──────&gt; String
├───────────────────────────┤
│name = &quot;java.lang.String&quot;  │
├───────────────────────────┤
│package = &quot;java.lang&quot;      │
├───────────────────────────┤
│super = &quot;java.lang.Object&quot; │
├───────────────────────────┤
│interface = CharSequence...│
├───────────────────────────┤
│field = value[],hash,...   │
├───────────────────────────┤
│method = indexOf()...      │
└───────────────────────────┘
</code></pre></div><p><code>Class</code> 类就是用于存储类的信息的类。所以，我们可以在 JVM 中通过某个类对应的 <code>Class</code> 读取到了这个类的所有信息，这个过程就是<strong>反射</strong>。</p> <h3 id="获取-class"><a href="#获取-class" class="header-anchor">#</a> 获取 Class</h3> <p>三种方法：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// 类.class</span>
<span class="token class-name">Class</span> cls <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">;</span>

<span class="token comment">// 变量.getClass()，返回的是变量的类</span>
<span class="token class-name">Number</span> n <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token class-name">Class</span> cls <span class="token operator">=</span> n<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// class java.lang.Double</span>

<span class="token comment">// Class.forname()</span>
<span class="token class-name">Class</span> cls <span class="token operator">=</span> <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">&quot;java.lang.String&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>可以用 <code>==</code> 精确判断类型：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>cls <span class="token operator">==</span> <span class="token class-name">Number</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// false</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>cls <span class="token operator">==</span> <span class="token class-name">Double</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// true</span>
</code></pre></div><p>匹配子类应当使用 <code>instanceof</code>。</p> <h3 id="创建新的实例-class-newinstance"><a href="#创建新的实例-class-newinstance" class="header-anchor">#</a> 创建新的实例 Class.newInstance()</h3> <p>可以使用 <code>Class.newInstance()</code> 创建类的实例，但是只能调用 public 的无参数构造方法。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">String</span> t <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 等价于 new String()</span>
<span class="token class-name">Double</span> d <span class="token operator">=</span> <span class="token class-name">Double</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 报错，Double 没有无参构造方法</span>
</code></pre></div><h3 id="获取字段-class-getfield-getdelearedfield"><a href="#获取字段-class-getfield-getdelearedfield" class="header-anchor">#</a> 获取字段 Class.getField() getDelearedField()</h3> <ul><li><code>Field Class.getField(name)</code>：只能获取 public 字段，但可以获取父类的字段</li> <li><code>Field Class.getDeclaredField(name)</code>：可以获取 private 字段，但不能获取父类的字段</li></ul> <hr> <p>获取字段的信息：</p> <ul><li><code>String Field.getName()</code>：字段名称</li> <li><code>Class Field.getType()</code>：字段类型</li> <li><code>int Field.getModifier()</code>：字段的修饰符，可以使用 <code>Modifier.isFinal(m)</code> 来获取字段的信息</li></ul> <hr> <p>通过字段获取、设置实例的值：</p> <ul><li><code>Object Field.get(Object instance)</code></li> <li><code>void Field.set(Object instance, Object value)</code></li></ul> <p>如果是对 private 字段进行操作，还需要设置允许访问：</p> <ul><li><code>Field.setAccessible(true);</code></li></ul> <p>如果 JVM 运行期存在 <code>SecurityManager</code>，它会根据规则进行检查，可能会阻止 <code>setAccessible(true)</code>。例如，某个 <code>SecurityManager</code> 可能不允许对 <code>java</code> 和 <code>javax</code> 开头的 package 的类调用 <code>setAccessible(true)</code>，这样可以保证 JVM 核心库的安全。</p> <h3 id="获取方法-class-getmethod-getdeclaredmethod"><a href="#获取方法-class-getmethod-getdeclaredmethod" class="header-anchor">#</a> 获取方法 Class.getMethod() getDeclaredMethod()</h3> <ul><li><code>Method Class.getMethod(name)</code>：只能获取 public 方法，但可以获取父类的方法</li> <li><code>Method Class.getDeclaredMethod(name)</code>：可以获取 private 方法，但不能获取父类的方法</li></ul> <hr> <p>获取方法的信息：</p> <ul><li><code>String Method.getName()</code>：方法名称</li> <li><code>Class Method.getReturnType()</code>：方法返回值类型</li> <li><code>Class[] Method.getParameterType()</code>：方法参数类型</li> <li><code>int Method.getModifier()</code>：字段的修饰符，可以使用 <code>Modifier.isFinal(m)</code> 来获取字段的信息</li></ul> <hr> <p>调用方法：</p> <ul><li><code>Object Method.invoke(Object obj, Object... args)</code></li></ul> <p>调用方法仍遵循多态原则。<br>
如果是静态方法，调用时令 <code>obj = null</code> 即可。</p> <p>如果是调用 private 方法，还需要设置允许访问：</p> <ul><li><code>Method.setAccessible(true);</code></li></ul> <h3 id="获取构造方法-class-getconstructor"><a href="#获取构造方法-class-getconstructor" class="header-anchor">#</a> 获取构造方法 Class.getConstructor</h3> <ul><li><code>Constructor Class.getConstructor(Class... parameterTypes)</code></li></ul> <p>调用构造方法：</p> <ul><li><code>Object Constructor.newInstance(Object... initargs)</code></li></ul> <p>调用 private 构造方法仍需要：</p> <ul><li><code>Field.setAccessible(true);</code></li></ul> <h3 id="获取继承关系"><a href="#获取继承关系" class="header-anchor">#</a> 获取继承关系</h3> <ul><li><code>Class Class.getSuperClass()</code>：获取父类</li> <li><code>Class[] Class.getInterfaces()</code>：获取实现的接口</li></ul> <p>实例判断类型可以使用 <code>instanceof</code>，类的转换关系可以使用：</p> <ul><li><code>Class.isAssignableFrom(Class)</code></li></ul> <h3 id="动态代理"><a href="#动态代理" class="header-anchor">#</a> 动态代理</h3> <p>interface 是不能直接实例化的。要想将其实例化，就要编写一个类实现它的方法，这称为静态代理，也是常见的实现方法。</p> <p>动态代理就是使用 JDK 提供的 <code>Proxy.newProxyInstance()</code> 接口，就可以在在运行时创建一个接口对象（运行期间的变化都被称为动态）。</p> <p>动态代理不知道有什么用，咕了。</p> <h2 id="annotation-注解-咕咕咕"><a href="#annotation-注解-咕咕咕" class="header-anchor">#</a> Annotation 注解（咕咕咕）</h2> <p>注解是放在 Java 源码的类、方法、字段、参数前的一种特殊“注释”：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Resource</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Hello</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Inject</span>
    <span class="token keyword">int</span> n<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@PostConstruct</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">hello</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Param</span> <span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&quot;Hello&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Java 的注解本身对函数的逻辑没有任何影响。</p> <p>底层的库定义好注解以后，被用在我们编写的函数上，在编译/运行阶段，底层的库函数在执行的时候可以读取注解的内容，读取到以后会进行处理。如，在构造函数执行完成后，</p> <h3 id="注解的分类"><a href="#注解的分类" class="header-anchor">#</a> 注解的分类</h3> <p>第一类是由编译器使用的注解，例如：</p> <ul><li><code>@Override</code>：让编译器检查该方法是否正确地实现了覆写；</li> <li><code>@SuppressWarnings</code>：告诉编译器忽略此处代码产生的警告。
这类注解不会被编译进入 <code>.class</code> 文件，它们在编译后就被编译器扔掉了。</li></ul> <p>第二类是由工具处理 <code>.class</code> 文件使用的注解，比如有些工具会在加载 <code>class</code> 的时候，对 <code>class</code> 做动态修改，实现一些特殊的功能。这类注解会被编译进入 <code>.class</code> 文件，但加载结束后并不会存在于内存中。这类注解只被一些底层库使用，一般我们不必自己处理。</p> <p>第三类是在程序运行期能够读取的注解，它们在加载后一直存在于 JVM 中，这也是最常用的注解。例如，一个配置了 <code>@PostConstruct</code> 的方法会在调用构造方法后自动被调用（这是 Java 代码读取该注解实现的功能，JVM 并不会识别该注解）。</p> <h2 id="generic-泛型"><a href="#generic-泛型" class="header-anchor">#</a> Generic 泛型</h2> <p>Generic 即 C++ 的模板 Template。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">T</span><span class="token punctuation">[</span><span class="token punctuation">]</span> array<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> size<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">T</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">remove</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token class-name">T</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>一次编写，就能匹配任意类型 <code>ArrayList&lt;String&gt;</code>、<code>ArrayList&lt;Integer&gt;</code> 等等，又通过编译器保证了类型安全：这就是泛型。</p> <p>另外，不定义泛型的类型时，默认 T 为 Object：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// 编译器警告: Raw use of parameterized class 'ArrayList' </span>
<span class="token class-name">List</span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;Hello&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;World&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">String</span> first <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span> list<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">String</span> second <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span> list<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="泛型的实现-擦拭法"><a href="#泛型的实现-擦拭法" class="header-anchor">#</a> 泛型的实现：擦拭法</h3> <p>Java语言的泛型实现方式是擦拭法（Type Erasure），擦拭法的含义是，编译器负责检查所有的语法检查，而编译的结果中，所有 <code>T</code> 都被替换为了 <code>Object</code></p> <p>擦拭法决定了泛型 <code>&lt;T&gt;</code>：</p> <ul><li>不能是基本类型，例如：<code>int</code>；</li> <li>不能获取带泛型类型的 Class，例如：<code>Pair&lt;String&gt;.class == Pair.class</code>；</li> <li>不能判断带泛型类型的类型，例如：<code>x instanceof Pair&lt;String&gt;</code>；</li> <li>不能实例化T类型，例如：<code>new T()</code>。</li></ul> <p>泛型方法要防止重复定义方法，例如：public boolean equals(T obj)</p> <h3 id="泛型的向上转换、extends-和-super-通配符"><a href="#泛型的向上转换、extends-和-super-通配符" class="header-anchor">#</a> 泛型的向上转换、extends 和 super 通配符</h3> <p>泛型的向上转换，只允许 <code>ArrayList&lt;T&gt;</code> 向上转换为 <code>List&lt;T&gt;</code>，不允许 <code>T</code> 发生向上转换，即不允许 <code>ArrayList&lt;Integer&gt;</code> 向上转换为 <code>ArrayList&lt;Number&gt;</code>。</p> <hr> <p>但是，如果确实有这样的需求，比如我们想让传入一个 <code>ArrayList&lt;Integer&gt;</code> 执行下面的函数。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">Pair</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Number</span><span class="token punctuation">&gt;</span></span> p<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Number</span> first <span class="token operator">=</span> p<span class="token punctuation">.</span><span class="token function">getFirst</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Number</span> last <span class="token operator">=</span> p<span class="token punctuation">.</span><span class="token function">getLast</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> first<span class="token punctuation">.</span><span class="token function">intValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> last<span class="token punctuation">.</span><span class="token function">intValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>向上转换规则说是不能这样转换的，于是又发明了新的语法：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">Pair</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">Number</span><span class="token punctuation">&gt;</span></span> p<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Number</span> first <span class="token operator">=</span> p<span class="token punctuation">.</span><span class="token function">getFirst</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Number</span> last <span class="token operator">=</span> p<span class="token punctuation">.</span><span class="token function">getLast</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> first<span class="token punctuation">.</span><span class="token function">intValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> last<span class="token punctuation">.</span><span class="token function">intValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><code>Pair&lt;? extends Number&gt;</code> 是一个通配符，能够匹配所有 <code>Number</code> 的子类 <code>T</code> 形成的 <code>Pair&lt;T&gt;</code>。</p> <hr> <p>反过来，我们也希望存在一个通配符，能够匹配所有 <code>Number</code> 的父类 <code>T</code> 形成的 <code>Pair&lt;T&gt;</code>。它就是 <code>Pair&lt;? super Number&gt;</code>：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">void</span> <span class="token function">set</span><span class="token punctuation">(</span><span class="token class-name">Pair</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">super</span> <span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> p<span class="token punctuation">,</span> <span class="token class-name">Integer</span> first<span class="token punctuation">,</span> <span class="token class-name">Integer</span> last<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    p<span class="token punctuation">.</span><span class="token function">setFirst</span><span class="token punctuation">(</span>first<span class="token punctuation">)</span><span class="token punctuation">;</span>
    p<span class="token punctuation">.</span><span class="token function">setLast</span><span class="token punctuation">(</span>last<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="lambda"><a href="#lambda" class="header-anchor">#</a> Lambda</h2> <p>Lambda 表达式为 <code>(s1, s2) -&gt; {return s1 &gt; s2;}</code>。</p> <p>单方法接口被称为 <code>FunctionalInterface</code>。需要 <code>FunctionalInterface</code> 作为参数的时候，可以传一个 <code>Lambda</code> 表达式进去。</p> <p>也可以传入静态方法和实例方法，只要参数和返回类型相同（即：方法签名）就行。</p> <h2 id="map-reduce"><a href="#map-reduce" class="header-anchor">#</a> Map Reduce</h2> <p><a href="https://www.liaoxuefeng.com/wiki/1252599548343744/1322402873081889" target="_blank" rel="noopener noreferrer">使用Stream - 廖雪峰的官方网站<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>使用 Stream 可以方便地对大数据进行各类处理，还可以利用多线程加速。</p> <h2 id="maven"><a href="#maven" class="header-anchor">#</a> Maven</h2> <p><a href="https://www.liaoxuefeng.com/wiki/1252599548343744/1255945359327200" target="_blank" rel="noopener noreferrer">Maven 基础 - 廖雪峰<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="xml、json-的解析"><a href="#xml、json-的解析" class="header-anchor">#</a> XML、JSON 的解析</h2> <p><a href="https://www.liaoxuefeng.com/wiki/1252599548343744/1255945389334784" target="_blank" rel="noopener noreferrer">XML 与 JSON<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="json"><a href="#json" class="header-anchor">#</a> JSON</h3> <p>Maven：</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.fasterxml.jackson.core<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>jackson-databind<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.12.3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>解析 JSON 为 Book 类：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">InputStream</span> input <span class="token operator">=</span> <span class="token class-name">Main</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getResourceAsStream</span><span class="token punctuation">(</span><span class="token string">&quot;/book.json&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">ObjectMapper</span> mapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObjectMapper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 反序列化时忽略不存在的JavaBean属性:</span>
mapper<span class="token punctuation">.</span><span class="token function">configure</span><span class="token punctuation">(</span><span class="token class-name">DeserializationFeature</span><span class="token punctuation">.</span>FAIL_ON_UNKNOWN_PROPERTIES<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Book</span> book <span class="token operator">=</span> mapper<span class="token punctuation">.</span><span class="token function">readValue</span><span class="token punctuation">(</span>input<span class="token punctuation">,</span> <span class="token class-name">Book</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>将 Book 类序列化：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">String</span> json <span class="token operator">=</span> mapper<span class="token punctuation">.</span><span class="token function">writeValueAsString</span><span class="token punctuation">(</span>book<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="json-解析日期"><a href="#json-解析日期" class="header-anchor">#</a> JSON 解析日期</h4> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.fasterxml.jackson.datatype<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>jackson-datatype-jsr310<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.12.3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">ObjectMapper</span> mapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObjectMapper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">registerModule</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">JavaTimeModule</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="自定义解析"><a href="#自定义解析" class="header-anchor">#</a> 自定义解析</h4> <p>需要把 <code>BigInteger</code> 和 <code>978-7-111-54742-6</code> 形式的 ISBN 互化。</p> <p>定义一个 ISBN 反序列化器：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">IsbnDeserializer</span> <span class="token keyword">extends</span> <span class="token class-name">JsonDeserializer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">BigInteger</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token class-name">BigInteger</span> <span class="token function">deserialize</span><span class="token punctuation">(</span><span class="token class-name">JsonParser</span> p<span class="token punctuation">,</span> <span class="token class-name">DeserializationContext</span> ctxt<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> <span class="token class-name">JsonProcessingException</span> <span class="token punctuation">{</span>
        <span class="token comment">// 读取原始的JSON字符串内容:</span>
        <span class="token class-name">String</span> s <span class="token operator">=</span> p<span class="token punctuation">.</span><span class="token function">getValueAsString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>s <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">BigInteger</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">&quot;-&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">NumberFormatException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">JsonParseException</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> s<span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>然后，在 <code>Book</code> 类中使用注解标注：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Book</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
    <span class="token comment">// 表示反序列化isbn时使用自定义的IsbnDeserializer:</span>
    <span class="token annotation punctuation">@JsonDeserialize</span><span class="token punctuation">(</span>using <span class="token operator">=</span> <span class="token class-name">IsbnDeserializer</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">BigInteger</span> isbn<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>类似的，自定义序列化时我们需要自定义一个 <code>IsbnSerializer</code>，然后在 <code>Book</code> 类中标注 <code>@JsonSerialize(using = ...)</code> 即可。</p> <h2 id="mvc"><a href="#mvc" class="header-anchor">#</a> MVC</h2> <div class="language- extra-class"><pre class="language-text"><code>                   ┌───────────────────────┐
             ┌────&gt;│Controller: UserServlet│
             │     └───────────────────────┘
             │                 │
┌───────┐    │           ┌─────┴─────┐
│Browser│────┘           │Model: User│
│       │&lt;───┐           └─────┬─────┘
└───────┘    │                 │
             │                 ▼
             │     ┌───────────────────────┐
             └─────│    View: user.jsp     │
                   └───────────────────────┘
</code></pre></div><p>MVC 即模型层、控制层、视图层分离。</p> <ul><li>控制层：实现业务逻辑（后端）</li> <li>模型层：控制层传给视图层的模型和数据（数据）</li> <li>视图层：把数据展示给用户（前端）</li></ul></div> <hr role="separator" aria-orientation="horizontal" class="ma-4 v-divider theme--light"> <div data-v-43fd1027><script src="https://giscus.app/client.js" async="async" service="giscus" data-repo="lyh543/blog-comments" data-repo-id="R_kgDOHIb2Zg" data-category="Announcements" data-category-id="DIC_kwDOHIb2Zs4COh2z" data-mapping="pathname" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="zh-CN" data-loading="lazy" crossorigin="anonymous" data-v-43fd1027></script></div></div></div></article></div> <!----></div></div> <div role="dialog" class="v-dialog__container"><button type="button" role="button" aria-haspopup="true" aria-expanded="false" class="v-btn v-btn--bottom v-btn--is-elevated v-btn--fab v-btn--fixed v-btn--has-bg v-btn--right v-btn--round theme--dark v-size--default primary"><span class="v-btn__content"><i aria-hidden="true" class="v-icon notranslate mdi mdi-information-variant theme--dark"></i></span></button><!----></div></div></div></main> <footer id="footer" class="v-footer v-sheet theme--light v-footer--absolute v-footer--padless v-footer--inset" style="left:0px;right:0px;bottom:0px;"><div class="lighten-1 text-center v-card v-sheet theme--light rounded-0" style="width:100%;"><div class="v-card__text"><a href="https://github.com/lyh543/vuepress-theme-blog-material/" target="_blank" class="mx-4 v-btn v-btn--icon v-btn--round theme--light v-size--default"><span class="v-btn__content"><i aria-hidden="true" class="v-icon notranslate mdi mdi-github theme--light" style="font-size:24px;"></i></span></a><a href="https://blog.lyh543.cn/" target="_blank" class="mx-4 v-btn v-btn--icon v-btn--round theme--light v-size--default"><span class="v-btn__content"><i aria-hidden="true" class="v-icon notranslate mdi mdi-web theme--light" style="font-size:24px;"></i></span></a><a href="mailto:lyh543@outlook.com" target="_blank" class="mx-4 v-btn v-btn--icon v-btn--round theme--light v-size--default"><span class="v-btn__content"><i aria-hidden="true" class="v-icon notranslate mdi mdi-email theme--light" style="font-size:24px;"></i></span></a><a href="https://weibo.com/" target="_blank" class="mx-4 v-btn v-btn--icon v-btn--round theme--light v-size--default"><span class="v-btn__content"><i aria-hidden="true" class="v-icon notranslate mdi mdi-sina-weibo theme--light" style="font-size:24px;"></i></span></a><a href="https://weixin.qq.com/" target="_blank" class="mx-4 v-btn v-btn--icon v-btn--round theme--light v-size--default"><span class="v-btn__content"><i aria-hidden="true" class="v-icon notranslate mdi mdi-wechat theme--light" style="font-size:24px;"></i></span></a><a href="https://qq.com/" target="_blank" class="mx-4 v-btn v-btn--icon v-btn--round theme--light v-size--default"><span class="v-btn__content"><i aria-hidden="true" class="v-icon notranslate mdi mdi-qqchat theme--light" style="font-size:24px;"></i></span></a><a href="https://bilibili.com/" target="_blank" class="mx-4 v-btn v-btn--icon v-btn--round theme--light v-size--default"><span class="v-btn__content"><div class="v-image v-responsive theme--light" style="max-width:24px;"><div class="v-image__image v-image__image--preload v-image__image--cover" style="background-image:;background-position:center center;"></div><div class="v-responsive__content"></div></div></span></a></div> <hr role="separator" aria-orientation="horizontal" class="v-divider theme--light"> <div class="v-card__text"><span class="footer-text">lyh543 © 2019 - 2022</span>
        |
      <a href="https://beian.miit.gov.cn/" target="_blank" class="footer-link">蜀ICP备19034464号</a>
        |
      <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" class="footer-link">署名 - 非商业性 - 相同方式共享 4.0 国际协议</a>
        |
       <span class="footer-text">
        Theme
        <a href="https://github.com/lyh543/vuepress-theme-blog-material/" target="_blank" class="footer-link">
          vuepress-theme-blog-material
        </a></span></div></div></footer></div></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.cbaac8cd.js" defer></script><script src="/assets/js/86.4b410550.js" defer></script>
  </body>
</html>
